%!PS-Adobe-2.0
%%Creator: dvips 5.495 Copyright 1986, 1992 Radical Eye Software
%%Title: parsing.dvi
%%CreationDate: Mon Jun 16 18:45:26 1997
%%Pages: 38
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%EndComments
%DVIPSCommandLine: dvips parsing.dvi -o parsing.ps
%DVIPSSource:  TeX output 1997.06.16:1845
%%BeginProcSet: tex.pro
%!
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul add
.99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage userdict
/eop-hook known{eop-hook}if}N /@start{userdict /start-hook known{start-hook}
if pop /VResolution X /Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255
{IE S 1 string dup 0 3 index put cvn put}for 65781.76 div /vsize X 65781.76
div /hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N
/ruley 0 N /v{/ruley X /rulex X V}B /V{}B /RV statusdict begin /product where{
pop product dup length 7 ge{0 7 getinterval dup(Display)eq exch 0 4
getinterval(NeXT)eq or}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /QV{
gsave transform round exch round exch itransform moveto rulex 0 rlineto 0
ruley neg rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N
/tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{4 M}B
/w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{p 1 w}B /r{
p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p a}B /bos{/SS save
N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 39158280 55380996 1000 300 300
(/cs/u1g/gmh/Latex/Parsing/Monadic-long/parsing.dvi) @start
/Fa 21 120 df<70F8F8F8700505798414>46 D<0006000E000E001C001C003800380070007000
E000E001C001C0038003800380070007000E000E001C001C003800380070007000E000E000C000
0F1D7E9914>I<70F8F8F87000000000000070F8F8F8700510798F14>58
D<FFE000FFF800383C00381E00380E003807003807003807003803803803803803803803803803
80380380380380380380380700380700380E00381E00383C00FFF800FFE00011177F9614>68
D<0FCC1FFC307C603CE01CE01CE01CE00070007E003FE00FF001F8001C001E000E600EE00EE00E
F01CF838FFF0C7E00F177E9614>83 D<1FC0007FF000707800201800001C00001C0007FC001FFC
003C1C00701C00E01C00E01C00E01C00707C003FFF800F8F8011107E8F14>97
D<03F80FFC1C1C380870006000E000E000E000E00060007000380E1C1E0FFC03F00F107E8F14>
99 D<07E00FF01C38301C700CE00EE00EFFFEFFFEE00060007000380E1C1E0FFC03F00F107E8F
14>101 D<007C00FE01CE03840380038003807FFEFFFE03800380038003800380038003800380
03800380038003807FFC7FFC0F177F9614>I<FC0000FC00001C00001C00001C00001C00001C00
001C78001DFE001F86001E07001C07001C07001C07001C07001C07001C07001C07001C07001C07
001C0700FF8FE0FF8FE01317809614>104 D<006000F000F0006000000000000000001FF01FF0
00700070007000700070007000700070007000700070007000700070007000700070007040E0E0
C07F803F000C207E9714>106 D<FC0000FC00001C00001C00001C00001C00001C00001DFF801D
FF801C3C001C78001CF0001DE0001FC0001FC0001FE0001EF0001C70001C38001C38001C1C00FE
3F80FE3F8011177F9614>I<FB8E00FFDF003CF3803CF38038E38038E38038E38038E38038E380
38E38038E38038E38038E38038E380FEFBE0FE79E01310808F14>109 D<FC7800FDFE001F8600
1E07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C0700FF8FE0FF8FE0
1310808F14>I<07C01FF03C78701C701CE00EE00EE00EE00EE00EE00E701C783C3C781FF007C0
0F107E8F14>I<FCF800FDFE001F07001E03001C03801C01C01C01C01C01C01C01C01C01C01C01
C01C03801E03001F0E001DFC001CF8001C00001C00001C00001C00001C00001C0000FF8000FF80
001218808F14>I<FE1F00FE7F800EE3800F81000F00000F00000E00000E00000E00000E00000E
00000E00000E00000E0000FFF000FFF00011107F8F14>114 D<0FD83FF86038C038C038F0007F
803FF007F8001C6006E006F006F81CFFF8CFE00F107E8F14>I<030007000700070007007FFCFF
FC07000700070007000700070007000700070E070E070E070C03FC00F00F157F9414>I<FC3F00
FC3F001C07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C07001C1F00
0FFFE003E7E01310808F14>I<FF7F80FF7F80380E00380E00380E00380E0039CE0039CE0019CC
001B6C001B6C001A6C001A6C001E7C000E78000E780011107F8F14>119
D E /Fb 6 58 df<00C003C0FFC0FFC003C003C003C003C003C003C003C003C003C003C003C003
C003C003C003C003C003C003C07FFE7FFE0F187D9716>49 D<0FF0003FFC00787E00FC1F00FC1F
80FC0F80FC0F80780F80001F80001F00001E00003C0000780000700000E0000180000301800601
800C01801003803FFF007FFF00FFFF00FFFF0011187E9716>I<07F0001FFC00383E007C3E007C
1F007C1F007C1F00383F00003E00003C0000780007F000003C00001E00001F00001F80781F80FC
1F80FC1F80FC1F00F81F00703E003FFC000FF00011187E9716>I<000600000E00001E00003E00
007E0000DE00019E00011E00031E00061E000C1E00181E00301E00601E00C01E00FFFFE0FFFFE0
001E00001E00001E00001E00001E0001FFE001FFE013187F9716>I<3006003FFC003FFC003FF0
003FE0003F800030000030000030000037F000381C00301E00000F00000F00000F80700F80F80F
80F80F80F80F80F80F00601F00383E001FF80007E00011187E9716>I<07E0001FF8003C1C0078
1E00780F00F80F00F80F00F80F80F80F80F80F80F80F80781F80381F801C2F8007CF80000F8000
0F00380F007C1F007C1E00783C003078001FF0000FC00011187E9716>57
D E /Fc 1 122 df<1818181818FFFF18181818181818181818181818181808167D900E>121
D E /Fd 2 122 df<040E0E1C1C1C38383070706060C0C0070F7F8F0A>48
D<0C000C000C000C000C000C00FFC0FFC00C000C000C000C000C000C000C000C000C000C000C00
0C000C000C000C000C000C000C000A1A7E9310>121 D E /Fe 5 107 df<FFFFFF80FFFFFF8019
027D8A20>0 D<00040000000C0000000C0000000C0000000C0000000C0000000C0000000C0000
000C0000000C0000000C0000000C0000000C0000000C0000000C0000000C0000000C0000000C00
00000C0000000C0000000C0000000C0000000C0000000C0000000C0000000C0000FFFFFFE0FFFF
FFE01B1C7D9B21>63 D<003C00E001C00180038003800380038003800380038003800380038003
8003800380030007001C00F0001C00070003000380038003800380038003800380038003800380
038003800380018001C000E0003C0E297D9E15>102 D<F0001C00070003000380038003800380
038003800380038003800380038003800380018001C000E0003C00E001C0018003800380038003
80038003800380038003800380038003800380030007001C00F0000E297D9E15>I<C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C002297B
9E0C>106 D E /Ff 81 126 df<60F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0600000000060F0F060
0419779816>33 D<E038F078F078F078F078F078F078F078E038E03860300D0B7C9816>I<0380
0007E0000FE0001E70001C70001C70001C70001C77E01CE7E01DE7E00FC7000F8E000F0E001E0E
003F1C007F1C00739C00E3F800E1F800E0F1C0E0F1C071F9C07FFFC03F9F801E070013197F9816
>38 D<30787C3C1C1C1C1C3878F0E040060D789816>I<00E001E0038007000E001C001C003800
3800700070007000E000E000E000E000E000E000E000E000E000700070007000380038001C001C
000E000700038001E000E00B217A9C16>I<C000E000700038001C000E000E0007000700038003
80038001C001C001C001C001C001C001C001C001C0038003800380070007000E000E001C003800
7000E000C0000A217B9C16>I<01C00001C00001C00001C00071C700F9CF807FFF001FFC0007F0
0007F0001FFC007FFF00F9CF8071C70001C00001C00001C00001C00011127E9516>I<01C00001
C00001C00001C00001C00001C00001C00001C000FFFF80FFFF80FFFF8001C00001C00001C00001
C00001C00001C00001C00001C00011137E9516>I<387C7E7E3E0E1E1C78F060070B798416>I<FF
FF80FFFF80FFFF8011037E8D16>I<70F8F8F8700505788416>I<00018000038000038000070000
0700000E00000E00001C00001C0000380000380000700000700000E00000E00001C00001C00003
80000380000700000700000E00000E00001C00001C0000380000380000700000700000E00000E0
0000C0000011207E9C16>I<03E0000FF8001FFC001E3C00380E00780F00700700700700E00380
E00380E00380E00380E00380E00380E00380E00380F00780700700700700780F003C1E001E3C00
1FFC000FF80003E00011197E9816>I<01800380038007800F807F80FF80738003800380038003
8003800380038003800380038003800380038003807FF87FFC7FF80E197C9816>I<07E0001FF8
003FFC00783E00E00700F00780F00380600380000380000380000700000700000E00001C000038
0000700000E00001C0000380000F00001E03803803807FFF80FFFF807FFF8011197E9816>I<07
E0001FF8003FFC00781E00780700300700000700000700000E00003E0007FC0007F00007FC0000
1E00000700000300000380000380600380F00380E00700781E003FFC001FF80007E00011197E98
16>I<007C0000FC0000DC0001DC00039C00039C00071C000F1C000E1C001E1C003C1C00381C00
781C00F01C00FFFFE0FFFFE0FFFFE0001C00001C00001C00001C00001C0001FFC001FFC001FFC0
13197F9816>I<3FFE003FFE003FFE003800003800003800003800003800003800003800003BF0
003FFC003FFE003C0F00300700000380000380600380F00380F00380E00700781E003FFC001FF8
0007E00011197E9816>I<00F80003FC0007FE000F07001C0F00380F00780600700000700000E3
F800EFFC00FFFE00F80F00F00700F00380E00380E003807003807003807007803807003C1E001F
FC000FF80003E00011197E9816>I<E00000FFFF80FFFF80FFFF80E00F00E01E00001C00003800
00780000700000E00000E00001C00001C00001C000038000038000038000038000070000070000
070000070000070000070000070000111A7E9916>I<07F0001FFC003FFE007C1F00F00780E003
80E00380E003807007007C1F001FFC0007F0001FFC003C1E00700700F00780E00380E00380E003
80F007807007007C1F003FFE001FFC0007F00011197E9816>I<03E0000FF8001FFC003C1E0070
0E00700700E00700E00780E00380E00380E00780700780780F803FFF801FFB800FE38000070000
0700300700780E00781C007078003FF0001FE0000F800011197E9816>I<70F8F8F87000000000
0000000070F8F8F8700512789116>I<387C7C7C38000000000000000038787C7C3C1C1C3870E0
400618799116>I<000180000780001F80003E0000F80001F00007C0000F80003E0000FC0000F0
0000FC00003E00000F800007C00001F00000F800003E00001F8000078000018011157E9616>I<
7FFF00FFFF80FFFF80000000000000000000000000000000FFFF80FFFF807FFF00110B7E9116>
I<C00000F00000FC00003E00000F800007C00001F00000F800003E00001F80000780001F80003E
0000F80001F00007C0000F80003E0000FC0000F00000C0000011157E9616>I<00E00001F00001
F00001B00001B00003B80003B80003B800031800071C00071C00071C00071C00071C000E0E000E
0E000FFE000FFE001FFF001C07001C07001C07007F1FC0FF1FE07F1FC013197F9816>65
D<7FF800FFFE007FFF001C0F001C07801C03801C03801C03801C07801C07001FFF001FFE001FFE
001C1F001C03801C03C01C01C01C01C01C01C01C01C01C03C01C07807FFF80FFFF007FFC001219
7F9816>I<01F18007FB800FFF801F0F803C0780380380700380700380F00000E00000E00000E0
0000E00000E00000E00000E00000F000007003807003803803803C07001F0F000FFE0007FC0001
F00011197E9816>I<7FF800FFFE007FFF001C0F001C07801C03C01C01C01C01C01C01E01C00E0
1C00E01C00E01C00E01C00E01C00E01C00E01C00E01C01C01C01C01C03C01C07801C0F807FFF00
FFFE007FF8001319809816>I<7FFFC0FFFFC07FFFC01C01C01C01C01C01C01C01C01C00001C00
001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00E01C00E01C00E01C00E01C00
E07FFFE0FFFFE07FFFE013197F9816>I<7F1FC0FFBFE07F1FC01C07001C07001C07001C07001C
07001C07001C07001FFF001FFF001FFF001C07001C07001C07001C07001C07001C07001C07001C
07001C07007F1FC0FFBFE07F1FC013197F9816>72 D<FFFEFFFEFFFE0380038003800380038003
800380038003800380038003800380038003800380038003800380FFFEFFFEFFFE0F197D9816>
I<07FE07FF07FE0038003800380038003800380038003800380038003800380038003800380038
6038F038F0707FF07FE01F8010197D9816>I<FFC000FFC000FFC0001C00001C00001C00001C00
001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00401C00E01C00
E01C00E01C00E0FFFFE0FFFFE0FFFFE013197F9816>76 D<FC07E0FE0FE0FE0FE03A0B803B1B80
3B1B803B1B803B1B803B1B803BBB8039B38039B38039B38039B38039F38038E38038E380380380
380380380380380380380380FE0FE0FE0FE0FE0FE013197F9816>I<7E1FC0FF3FE07F1FC01D07
001D87001D87001D87001DC7001DC7001CC7001CC7001CE7001CE7001CE7001C67001C67001C77
001C77001C37001C37001C37001C17007F1F00FF9F007F0F0013197F9816>I<7FF800FFFE007F
FF001C0F801C03801C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FF8001C
00001C00001C00001C00001C00001C00001C00007F0000FF80007F000012197F9816>80
D<7FE000FFF8007FFC001C1E001C0F001C07001C07001C07001C07001C0F001C1E001FFC001FF8
001FFC001C1C001C0E001C0E001C0E001C0E001C0E201C0E701C0E707F07E0FF87E07F03C01419
7F9816>82 D<07E3001FFF003FFF00781F00F00700E00700E00700E00000F000007800003F8000
1FF00007FC0000FE00000F00000700000380000380600380E00380E00700F80F00FFFE00FFFC00
C7F00011197E9816>I<7FFFE0FFFFE0FFFFE0E0E0E0E0E0E0E0E0E0E0E0E000E00000E00000E0
0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00007FC
000FFE0007FC0013197F9816>I<FE0FE0FF1FE0FE0FE03803801C07001C07001C07001C07000E
0E000E0E000E0E000E0E00060C00071C00071C00071C00071C0003180003B80003B80003B80001
B00001F00001F00000E00013197F9816>86 D<FC07E0FE0FE0FC07E07001C07001C07001C03001
8038038038038038038038E38039F38039F38039B38019B30019B30019B30019B30019B30019B3
001913001B1B000F1E000F1E000E0E0013197F9816>I<FE0FE0FF1FE0FE0FE01C07001C07000E
0E000E0E00071C00071C00071C0003B80003B80001F00001F00000E00000E00000E00000E00000
E00000E00000E00000E00003F80007FC0003F80013197F9816>89 D<7FFF80FFFF80FFFF80E007
00E00F00E01E00E01C00003C0000780000700000F00001E00001C00003C0000780000700000F00
001E03801C03803C0380780380700380FFFF80FFFF80FFFF8011197E9816>I<FFF0FFF0FFF0E0
00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000FFF0FFF0FFF00C20789C16>I<C00000E00000E000007000007000
003800003800001C00001C00000E00000E000007000007000003800003800001C00001C00000E0
0000E000007000007000003800003800001C00001C00000E00000E000007000007000003800003
8000018011207E9C16>I<FFF0FFF0FFF000700070007000700070007000700070007000700070
007000700070007000700070007000700070007000700070007000700070FFF0FFF0FFF00C207F
9C16>I<03000F803FE0FDF8F07840100D067C9816>I<FFFF80FFFF80FFFF8011037E7E16>I<08
1C3C7870E0E0E0E0F0F87830060D789B16>I<1FE0003FF0007FF800783C00300E00000E00000E
0003FE001FFE003E0E00700E00E00E00E00E00E00E00783E007FFFE03FE7E00F83E013127E9116
>I<7E0000FE00007E00000E00000E00000E00000E00000E3E000EFF000FFF800F83C00F00E00E
00E00E00700E00700E00700E00700E00700E00700E00E00F01E00F83C00FFF800EFF00063C0014
19809816>I<03F80FFC1FFE3C1E780C7000E000E000E000E000E000F000700778073E0E1FFC0F
F803F010127D9116>I<003F00007F00003F0000070000070000070000070003C7000FF7001FFF
003C1F00780F00700700E00700E00700E00700E00700E00700E00700700F00700F003C1F001FFF
E00FE7F007C7E014197F9816>I<03E00FF81FFC3C1E780E7007E007FFFFFFFFFFFFE000E00070
0778073C0F1FFE0FFC03F010127D9116>I<001F00007F8000FF8001E78001C30001C00001C000
7FFF00FFFF00FFFF0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C000
01C00001C0003FFE007FFF003FFE0011197F9816>I<03E3C007F7E00FFFE01C1CC0380E00380E
00380E00380E00380E001C1C000FF8001FF0001BE0003800001800001FFC001FFF003FFF807803
C0E000E0E000E0E000E0E000E07001C07C07C03FFF800FFE0003F800131C7F9116>I<7E0000FE
00007E00000E00000E00000E00000E00000E3C000EFE000FFF000F87800F03800E03800E03800E
03800E03800E03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01519809816>I<
018003C003C0018000000000000000007FC07FC07FC001C001C001C001C001C001C001C001C001
C001C001C001C07FFFFFFF7FFF101A7D9916>I<003000780078003000000000000000001FF81F
F81FF8003800380038003800380038003800380038003800380038003800380038003800380038
00386070F0F0FFE07FC03F800D237E9916>I<7E0000FE00007E00000E00000E00000E00000E00
000E7FE00E7FE00E7FE00E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F1E000E0E
000E07000E07807F87F0FFCFF07F87F01419809816>I<FFC000FFC000FFC00001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C00001C000FFFF80FFFF80FFFF8011197E9816>I<F9C380FFEFC0FFFFE03C78E0
3C78E03870E03870E03870E03870E03870E03870E03870E03870E03870E03870E0FE7CF8FE7CF8
FE3C781512809116>I<7E3C00FEFE007FFF000F87800F03800E03800E03800E03800E03800E03
800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01512809116>I<03E0000FF8001F
FC003C1E00780F00700700E00380E00380E00380E00380E00380F00780700700780F003C1E001F
FC000FF80003E00011127E9116>I<7E3E00FEFF007FFF800F83C00F00E00E00E00E00700E0070
0E00700E00700E00700E00700E00E00F01E00F83C00FFF800EFF000E3C000E00000E00000E0000
0E00000E00000E00007FC000FFE0007FC000141B809116>I<07C7000FE7001FF7003C1F00700F
00700F00E00700E00700E00700E00700E00700E00700700F00700F003C3F003FF7001FE70007C7
00000700000700000700000700000700000700003FE0007FF0003FE0141B7E9116>I<FF0FC0FF
3FE0FF7FE007F04007C00007800007800007000007000007000007000007000007000007000007
0000FFFC00FFFC00FFFC0013127F9116>I<0FEC3FFC7FFCF03CE01CE01C70007F801FF007F800
3C600EE00EF00EF81EFFFCFFF8C7E00F127D9116>I<0300000700000700000700000700007FFF
00FFFF00FFFF000700000700000700000700000700000700000700000701000703800703800703
8007870003FE0001FC0000F80011177F9616>I<7E1F80FE3F807E1F800E03800E03800E03800E
03800E03800E03800E03800E03800E03800E03800E03800E0F800FFFF007FBF803E3F015128091
16>I<7F1FC0FF1FE07F1FC01C07001E0F000E0E000E0E000E0E00071C00071C00071C00071C00
03B80003B80003B80001F00001F00000E00013127F9116>I<FF1FE0FFBFE0FF1FE03803803803
8038038038038038E38019F30019F30019B3001DB7001DB7001DB7001DB7000F1E000F1E000F1E
0013127F9116>I<7F1FC07F3FC07F1FC00F1C00073C0003B80003F00001F00000E00001E00001
F00003B800073C00071C000E0E007F1FC0FF3FE07F1FC013127F9116>I<7F1FC0FF9FE07F1FC0
1C07000E07000E0E000E0E00070E00071C00071C00039C00039C0003980001B80001B80000F000
00F00000F00000E00000E00000E00001C00079C0007BC0007F80003F00003C0000131B7F9116>
I<3FFFC07FFFC07FFFC0700780700F00701E00003C0000780001F00003E0000780000F00001E01
C03C01C07801C0FFFFC0FFFFC0FFFFC012127F9116>I<001F80007F8000FF8001E00001C00001
C00001C00001C00001C00001C00001C00001C00001C00003C0007F8000FF0000FF00007F800003
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001E00000FF80007F8000
1F8011207E9C16>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0E00320779C16>I<7C0000FF0000FF800003C00001C00001C00001C00001C00001C00001C000
01C00001C00001C00001E00000FF00007F80007F8000FF0001E00001C00001C00001C00001C000
01C00001C00001C00001C00001C00003C000FF8000FF00007C000011207E9C16>I
E /Fg 45 123 df<0000FE07C00003C38C700007079CF0000F0FBDF0000F0FB9F0000E0778E000
1E007800001E007800001E007800001E00F000003C00F00003FFFFFF8007FFFFFF80003C00F000
003C01E000003C01E000007801E000007801E000007801E000007801E000007803C00000F003C0
0000F003C00000F003C00000F003C00000F007800000F007800001E007800001E007800001E007
000001C00F000071CE0F0000FBDF0E0000FB9F1E0000F31E1C0000E61C3000003C07C000002425
819C1F>11 D<0E1E3F3F3E1E02040408101020C0080E7D850F>44 D<7FF0FFE0FFE0FFE00C047D
8A11>I<387CFCFCF87006067B850F>I<00030002000E001E007E07FC0FFC007C007C00F800F800
F800F801F001F001F001F003E003E003E003E007C007C007C007C0FFFCFFFC101B7B9A19>49
D<003F0000C1C00180E00200F00640F00C20F81820F81820F81820F83041F03081F01103E00E03
C0000780000F00001C0000780001E0000380000600000C00301800603001E07FFFC061FF80C0FF
00C03C00151B7C9A19>I<001FC000E0E00180700300780640780C20780C20780C20780C407007
80F00001E00003C000FF8000FC000007000007800007C00007C01007C07807C07C07C0F80F80F8
0F80600F00601E003078000FE000151B7C9A19>I<0001C00003C00003C00003C00003C0000780
000780000700000F00000F00001E00001E00001C0000380000780000700000E00000E60001CF00
038F00070F000E1E001C1E00381E007F1E00FFFC0080FFC0003F00003C00007800007800007800
00780000F00000600012237D9A19>I<01807001FFE003FFC003FF0003FE0003F0000600000600
000600000600000CFC000F0E000C0F00080F80000F80000F80000F80301F80781F80F81F80F81F
00F83F00F03E00C07C00E0F8007FE0001F8000141B7B9A19>I<000FC0003FE000F87001E1F003
C1F00783E00F81E00F00001F00001E00003E7C003E86003F07007E07807E07807C07C07C07C078
0F80F80F80F80F80F80F00781F00781E00783C003878001FF0000FC000141B7B9A19>I<0CF00C
1BF8181FF8303FFC703E0FE07800C06001C0C00180C00380000700000700000F00001E00001E00
003E00003C00007C00007C0000F80000F80001F80001F00001F00003F00003F00003E00001C000
161B7A9A19>I<003F0000FFC001C1E00300E00700E00600E00F00E00F80E00FC1C00FF3800FFF
000FFC0007FE0003FF000EFF80187F80303F80700F80E00780E00780E00300E00700E00600E00C
007038003FF0001FC000131B7B9A19>I<00000C0000001C0000003C0000003C0000007E000000
7E000000FE000001FE000001FE0000037E0000037E0000067E00000C7E00000C7F0000183F0000
383F0000303F0000603F0000603F0000FFFF0001FFFF0001803F0003003F8003001F8006001F80
0C001F80FFC1FFF8FFC1FFF81D1C7D9B24>65 D<01FFFE01FFFC001F80001F80001F80001F8000
3F00003F00003F00003F00007E00007E00007E00007E0000FC0000FC0000FC0000FC0001F80001
F80001F80001F80003F00003F00003F00003F0007FFF00FFFF00171C7F9B14>73
D<03FFFC03FFFC003F00003F00003F00003F00007E00007E00007E00007E0000FC0000FC0000FC
0000FC0001F80001F80001F80001F80303F00603F00603F00E03F00C07E01C07E01C07E07807E0
F8FFFFF0FFFFF0181C7D9B1D>76 D<03FF80003FF003FF80007FF0003F8000FE000037C000FE00
0037C001BE000037C0033E000067C0037C000067C0067C000067C0067C000067C00C7C0000C7E0
18F80000C3E018F80000C3E030F80000C3E060F8000183E061F0000183E0C1F0000183E181F000
0183E181F0000301F303E0000301F603E0000301F603E0000301FC03E0000601FC07C0000601F8
07C0000601F007C0000600F007C000FFE0E0FFFC00FFE0C0FFFC002C1C7D9B2D>I<03FFFFC003
FFFFF0003F01F8003F00FC003F007C003F007C007E00FC007E00FC007E00FC007E00F800FC01F8
00FC01F000FC03E000FC0FC001FFFF0001F8000001F8000001F8000003F0000003F0000003F000
0003F0000007E0000007E0000007E0000007E00000FFFE0000FFFE00001E1C7D9B21>80
D<03FFFF8003FFFFE0003F03F0003F01F8003F00F8003F00F8007E01F8007E01F8007E01F8007E
01F000FC03E000FC07C000FC0F0000FFFC0001F83C0001F81E0001F81F0001F81F0003F03F0003
F03F0003F03F0003F03F0007E07E0007E07E0607E07E0607E03E0CFFFE3F18FFFE0FF01F1C7D9B
24>82 D<000FC3003FF700F03E01E01E01C00E03C00E03800C07800C07C00007E00007FE0007FF
C007FFE003FFF001FFF8007FF8000FF80000F80000F80000783000783000707000F07000E07801
C07E0380EFFF00C3FC00181C7D9B1B>I<0FFFFFE00FFFFFE01E0FC1E01C0FC0C0380FC0C0300F
C0C0301F80C0601F80C0601F80C0601F80C0003F0000003F0000003F0000003F0000007E000000
7E0000007E0000007E000000FC000000FC000000FC000000FC000001F8000001F8000001F80000
01F80000FFFFE000FFFFC0001B1C799B21>I<7FFCFFFC7FE0FFFCFFFC7FE00FC01F8006000FC0
1FC00C000FC00FC01C000FC00FC018000FC01FC030000FE03FC0300007E03FC0600007E06FC060
0007E06FC0C00007E0CFC1800007E1CFC1800007E18FC3000007E30FE3000007E307E6000007E6
07EE000007EE07EC000007FC07F8000007F807F8000003F807F0000003F007F0000003F007E000
0003E007C0000003C007C0000003C0078000000380078000000380030000002B1C789B30>87
D<00F980038FC00F07C01E03C03E07803C07807C07807C0780F80F00F80F00F80F00F80F10F01E
30F01E30F01E30703E6038EE400F878014127C9119>97 D<3F803F8007800F000F000F000F001E
001E001E001E003DF03F1C3C1E3C1E781E781F781F781FF03EF03EF03EF03CE07CE078E07070E0
31C01F00101D7B9C16>I<00FC0003C3000F07001E0F803E1F003C0F007C04007C0000F80000F8
0000F80000F80000F80000F00200700700780E003C38000FE00011127C9116>I<0003F80003F8
0000780000F00000F00000F00000F00001E00001E00001E00001E000FBC0038FC00F07C01E03C0
3E07803C07807C07807C0780F80F00F80F00F80F00F80F10F01E30F01E30F01E30703E6038EE40
0F8780151D7C9C19>I<00FC03860F061E033E063C067C0C7CF8FF80F800F800F800F800F80278
07380E1C380FE010127C9116>I<0001F800039C00073C000F7C000F7C000F38001E00001E0000
1E00001E00001E0003FFF003FFF0003C00003C00003C0000780000780000780000780000780000
780000F00000F00000F00000F00000F00001E00001E00001E00001E00071C000FBC000FB8000F3
0000E600003C00001625819C11>I<007CC001E3E003C3E00781E00F83C00F03C01F03C01F03C0
3E07803E07803E07803E07803C0F003C0F003C0F001C1F000E3E0007DE00001E00001E00703C00
F83C00F83800F07000E0E0003F8000131A7E9116>I<0FE0000FE00001E00003C00003C00003C0
0003C0000780000780000780000780000F3F000F63800F83C00F03C01E03C01E03C01E03C01E03
C03C07803C07803C07803C0F08780F18780F18781E10781E30F00E60600780151D7D9C19>I<00
E001F001F001E000C000000000000000000000000000000F00338023C063C0C780C78007800F00
0F000F001E001E203C603C603C6038C018800F000C1E7D9D0F>I<0FE0000FE00001E00003C000
03C00003C00003C0000780000780000780000780000F03800F0CC00F11C00F23E01E47C01E87C0
1F83801E00003F80003DE0003CF0003CF04078F0C078F0C078F0C078F180F07100601E00131D7D
9C16>107 D<1FC01FC003C007800780078007800F000F000F000F001E001E001E001E003C003C
003C003C007800780078007A00F600F600F600F60076003C000A1D7C9C0C>I<1E07E0FC003318
718E0063A07A0F0063C07C0F00C7C0780F00C780780F000780780F000780780F000F00F01E000F
00F01E000F00F01E000F00F03C201E01E03C601E01E03C601E01E078401E01E078C03C03C03980
1801801E0023127D9127>I<1E0FC03318E063A0F063C0F0C780F0C780F00780F00780F00F01E0
0F01E00F01E00F03C21E03C61E03C61E07841E078C3C03981801E017127D911B>I<00FE0003C3
800701C01E01E01E01E03C01E07C01F07C01F0F803E0F803E0F803E0F803C0F807C0F00780780F
00781E003C3C000FE00014127C9119>I<0783E00CCC3018F83818F03C31E03C31E03E01E03E01
E03E03C07C03C07C03C07C03C0780780F80780F00781E00781C00FC3800F3E000F00000F00001E
00001E00001E00001E0000FF8000FF8000171A7F9119>I<1E1F0033218063C1C063C3C0C787C0
C787C00783800780000F00000F00000F00000F00001E00001E00001E00001E00003C0000180000
12127D9115>114 D<01F8020604060C0F1C1E1C0C1F801FF00FF803FC003C300E780CF80CF808
F01870301FC010127D9114>I<00C001E001E001E003C003C003C003C0FFF0FFF0078007800F00
0F000F000F001E001E001E001E103C303C303C203C601CC00F800C1A7D9910>I<0F00601180F0
21C0F063C0F043C1E0C3C1E00781E00781E00F03C00F03C00F03C00F03C40E078C1E078C0E078C
0E0F98071B9003E1E016127D911A>I<0F03801187C021CFC063CFC043C7C0C3C1C00780C00780
C00F01800F01800F01800F03000E03000E02000E06000E040007180003F00012127D9116>I<0F
0060E01180F1F021C0F3F063C0F3F043C1E1F0C3C1E0700781E0300781E0300F03C0600F03C060
0F03C0600F03C0C00E0380C00E0380800E0781800F078100070DC60001F0FC001C127D9120>I<
07C38018EC603078E06079E060F3E0C0F3E000F1C000F00001E00001E00001E00031E0207BC060
FBC060FBC0C0F7C08044C300387E0013127D9117>I<0F00C01181E021C1E063C1E043C3C0C3C3
C00783C00783C00F07800F07800F07800F07801E0F001E0F000E0F000E0F00071E0003FE00001E
00001C003C3C007C38007C700078600031C0001F0000131A7D9117>I<01E0C007F0C00FF9800F
FF00180600000C0000180000300000600000C0000380000600800C01801803803FFF0039FE0060
FC00C0780012127E9114>I E /Fh 5 110 df<07800001C00000E00000E00000F0000070000070
00007000003800003800003800003C00001C00001C00001E00000E00001E00003F0000670000C7
000187800303800703800E03801C03C03801C07001C0E001E06000E0131D7E9C18>21
D<60F0F06004047C830C>58 D<60F0F0701010101020204080040C7C830C>I<01F0030C0E0C1C
1E383C301870007000E000E000E000E000E000E0046008601030601F800F127E9112>99
D<381F81F04E20C6184640E81C4680F01C8F00F01C8E00E01C0E00E01C0E00E01C1C01C0381C01
C0381C01C0381C01C0703803807138038071380380E1380380E2700700643003003820127E9124
>109 D E /Fi 37 123 df<0001FC3C00060E67000C0EC7001C0DC6001C01C0003801C0003803
800038038000380380003803800070038007FFFFF800700700007007000070070000E0070000E0
0E0000E00E0000E00E0000E00E0001C00E0001C01C0001C01C0001C01C0001C01C0003801C0003
803800038038000380380003003800070030000700700006006000C6606000E470C000C8618000
703E00002025819C19>11 D<0001FC000703000C03001C07001C03001800003800003800003800
00380000700007FFFC00701C00701C00701C00E03800E03800E03800E03800E07001C07001C070
01C07001C0E201C0E201C0E20380E4038064038038038000030000070000060000C60000E40000
CC00007000001825819C17>I<FFC0FFC0FFC00A037D890F>45 D<3078F06005047C830D>I<060F
0F06000000000000000000003078F06008127C910D>58 D<0FFFFFE01FFFFFF000000000000000
00000000000000000000000000000000000000000000000000FFFFFF807FFFFF001C0C7C8F20>
61 D<0003F020001E0C60003002E000E003C001C001C0038001C0070000C00E0000801E000080
1C0000803C0000803C000000780000007800000078000000F0000000F0000000F0000000F00000
00F0000400F0000400F0000400F0000800700008007000100038002000180040000C0180000706
000001F800001B1E7A9C1E>67 D<01FFFFE0003C00E00038006000380040003800400038004000
70004000700040007020400070200000E0400000E0400000E0C00000FFC00001C0800001C08000
01C0800001C0800003810100038001000380020003800200070004000700040007000C00070018
000E007800FFFFF0001B1C7D9B1C>69 D<0003F020001E0C60003002E000E003C001C001C00380
01C0070000C00E0000801E0000801C0000803C0000803C000000780000007800000078000000F0
000000F0000000F001FFC0F0001E00F0001C00F0001C00F0001C00F0001C007000380070003800
38003800180078000C0090000707100001F800001B1E7A9C20>71 D<01FFCFFE003C01E0003801
C0003801C0003801C0003801C00070038000700380007003800070038000E0070000E0070000E0
070000FFFF0001C00E0001C00E0001C00E0001C00E0003801C0003801C0003801C0003801C0007
0038000700380007003800070038000F007800FFE7FF001F1C7D9B1F>I<01FE0007F8003E0007
80002E000F00002E001700002E001700002E002700004E002E00004E004E00004E004E00004E00
8E00008E011C00008E011C00008E021C00008E021C000107043800010704380001070838000107
1038000207107000020720700002072070000207407000040740E000040780E000040700E0000C
0700E0001C0601E000FF861FFC00251C7D9B25>77 D<01FFFC00003C070000380380003801C000
3801C0003801C0007003C0007003C0007003C00070038000E0078000E0070000E00E0000E03800
01FFE00001C0000001C0000001C000000380000003800000038000000380000007000000070000
0007000000070000000F000000FFE000001A1C7D9B1C>80 D<03CC063C0C3C181C383830387038
7038E070E070E070E070E0E2C0E2C0E261E462643C380F127B9115>97 D<3F00070007000E000E
000E000E001C001C001C001C0039C03E60383038307038703870387038E070E070E070E060E0E0
C0C0C1C0618063003C000D1D7B9C13>I<01F007080C08181C3838300070007000E000E000E000
E000E000E008E010602030C01F000E127B9113>I<001F80000380000380000700000700000700
000700000E00000E00000E00000E0003DC00063C000C3C00181C00383800303800703800703800
E07000E07000E07000E07000E0E200C0E200C0E20061E4006264003C3800111D7B9C15>I<01E0
07100C1018083810701070607F80E000E000E000E000E000E0086010602030C01F000D127B9113
>I<0003C0000670000C70001C60001C00001C0000380000380000380000380000380003FF8000
700000700000700000700000700000E00000E00000E00000E00000E00001C00001C00001C00001
C00001C000038000038000038000030000030000070000C60000E60000CC00007800001425819C
0D>I<00F3018F030F06070E0E0C0E1C0E1C0E381C381C381C381C383830383038187818F00F70
0070007000E000E0C0C0E1C0C3007E00101A7D9113>I<0FC00001C00001C00003800003800003
80000380000700000700000700000700000E78000E8C000F0E000E0E001C0E001C0E001C0E001C
0E00381C00381C00381C00383800703880703880707080707100E03200601C00111D7D9C15>I<
01800380010000000000000000000000000000001C002600470047008E008E000E001C001C001C
0038003800710071007100720072003C00091C7C9B0D>I<0006000E0006000000000000000000
000000000000F00118021802180438043800380038007000700070007000E000E000E000E001C0
01C001C001C003800380C300E700CE0078000F24819B0D>I<0FC00001C00001C0000380000380
000380000380000700000700000700000700000E0F000E11000E23800E43801C83001C80001D00
001E00003F800039C00038E00038E00070E20070E20070E20070E400E06400603800111D7D9C13
>I<1F800380038007000700070007000E000E000E000E001C001C001C001C0038003800380038
007000700070007000E400E400E400E40068003800091D7C9C0B>I<3C1E0780266318C04683A0
E04703C0E08E0380E08E0380E00E0380E00E0380E01C0701C01C0701C01C0701C01C070380380E
0388380E0388380E0708380E0710701C0320300C01C01D127C9122>I<3C3C0026460046870047
07008E07008E07000E07000E07001C0E001C0E001C0E001C1C00381C40381C4038384038388070
1900300E0012127C9117>I<01E007180C0C180C380C300E700E700EE01CE01CE01CE018E038E0
30E06060C031801E000F127B9115>I<07870004D98008E0C008E0C011C0E011C0E001C0E001C0
E00381C00381C00381C00381800703800703000707000706000E8C000E70000E00000E00001C00
001C00001C00001C00003C0000FF8000131A7F9115>I<03C4062C0C3C181C3838303870387038
E070E070E070E070E0E0C0E0C0E061E063C03DC001C001C0038003800380038007803FF00E1A7B
9113>I<3C3C26C2468747078E068E000E000E001C001C001C001C003800380038003800700030
0010127C9112>I<01F006080C080C1C18181C001F001FC00FF007F0007800386030E030C03080
6060C01F000E127D9111>I<00C001C001C001C00380038003800380FFE00700070007000E000E
000E000E001C001C001C001C00384038403840388019000E000B1A7D990E>I<1E030027070047
0700470700870E00870E000E0E000E0E001C1C001C1C001C1C001C1C0038388038388018388018
39001C5900078E0011127C9116>I<1E06270E470E4706870287020E020E021C041C041C041C08
18083808181018200C4007800F127C9113>I<1E01832703874703874703838707018707010E07
010E07011C0E021C0E021C0E021C0E04180C04181C04181C081C1C100C263007C3C018127C911C
>I<070E0019910010E38020E38041C30041C00001C00001C00003800003800003800003800007
0200670200E70400CB04008B080070F00011127D9113>I<038207C20FEC083810080010002000
40008001000200040008081008383067F043E081C00F127D9111>122 D
E /Fj 47 125 df<0003F83FE0000C0CE03000181D807000381B80600038030000007007000000
700700000070070000007007000000700E000007FFFFFFC000E00E01C000E00E038000E00E0380
00E01C038001E01C038001C01C070001C01C070001C01C070001C01C070001C0380E400380380E
400380380E400380380E40038030068003007003000700700000070070000006006000006630E0
0000E470C00000CC61800000703E0000002421819922>14 D<1838783808101020204080050B7D
830C>44 D<FF80FF80FF0009037D880E>I<3078F06005047C830C>I<007C000186000303000603
000C03801C03801C0380380380380380380380700700700700700700700700E00E00E00E00E00E
00E01C00E01C00E01800E0300060600030C0001F000011187C9714>48 D<007C00018600020300
0403800483800883801083801083801083801107001207000C0E00001C00003000006000018000
0200000C00001001002001003C060067FE00C1FC0080F00011187D9714>50
D<003E0000C3000101800201800481C00441C0088380048380070300000600000C0001F0000018
00000C00000C00000E00000E00600E00E01C00E01C0080380040300020E0001F800012187D9714
>I<060F1E0C00000000000000003078F06008107C8F0C>58 D<0000200000600000600000E000
01E00001E000027000027000047000087000087000107000107000207000207000407000807000
FFF00100380100380200380400380400380C00381C0038FF01FF181A7E991D>65
D<03FFF800700E00700600700700E00700E00700E00700E00701C00E01C01C01C03801C07003FF
E003807003803803801C07001C07001C07001C07001C0E00380E00380E00700E00E01C03C0FFFF
00181A7D991B>I<000F8200706200C01603801E07000C0E000C1C000C18000C38000830000870
0000700000E00000E00000E00000E00000E00020E00020E00020E0004060004060008030010010
06000C180003E000171A7A991B>I<03FFFF00700700700300700100E00100E00100E00100E001
01C08001C08001C08001C18003FF000381000381000381000702000700040700040700080E0008
0E00180E00100E00301C00E0FFFFE0181A7D991A>69 D<000FC100302100C01301800F0700060E
00060C0006180006380004300004700000700000E00000E00000E00000E007FEE00070E00070E0
0070E000706000E06000E03000E01801E00C064003F840181A7A991E>71
D<03FF1FF800700380007003800070038000E0070000E0070000E0070000E0070001C00E0001C0
0E0001C00E0001C00E0003FFFC0003801C0003801C0003801C0007003800070038000700380007
0038000E0070000E0070000E0070000E0070001C00E000FFC7FE001D1A7D991D>I<01FF800038
0000380000380000700000700000700000700000E00000E00000E00000E00001C00001C00001C0
0001C0000380000380000380000380000700000700000700000700000E0000FFE000111A7E990F
>I<00FFC0000E00000E00000E00001C00001C00001C00001C0000380000380000380000380000
700000700000700000700000E00000E00000E00000E00061C000E1C000E180008380004700003C
0000121A7C9914>I<03FF8000700000700000700000E00000E00000E00000E00001C00001C000
01C00001C0000380000380000380000380000700000700100700100700200E00200E00600E0040
0E00C01C0380FFFF80141A7D9918>76 D<03F8001FC00078003C000078003C000078005C0000B8
00B80000B800B800009C013800009C013800011C027000011C027000011C047000011C08700002
1C08E000021C10E000021C10E000021C20E000041C41C000041C41C000041C81C000041C81C000
080F038000080F038000080E038000180C038000380C070000FF083FF000221A7D9922>I<03FF
F800701C00700600700700E00700E00700E00700E00701C00E01C00E01C01C01C03803807003FF
800380000380000700000700000700000700000E00000E00000E00000E00001C0000FFC000181A
7D991A>80 D<03FFF000701C00700E00700700E00700E00700E00700E00701C00E01C01C01C038
01C0E003FF800380C00380600380700700700700700700700700700E00E00E00E00E00E10E00E2
1C0062FFC03C181A7D991C>82 D<003F1000609001807001007003002006002006002006002006
000007000007C00003F80001FE00007F00000F8000038000018000018020018020018060030060
0300600600700C00C8180087E000141A7D9916>I<3FFFFC381C0C201C04401C04403804803804
80380480380400700000700000700000700000E00000E00000E00000E00001C00001C00001C000
01C000038000038000038000038000078000FFF800161A79991B>I<03CC0E2E181C381C301C70
1CE038E038E038E038C072C072C07260F261341E180F107C8F14>97 D<7E000E000E000E001C00
1C001C001C00380038003BC03C307830701870187018E038E038E038E038C070C060C0E060C063
801E000D1A7C9912>I<01F006080C181838301070006000E000E000E000E000E008E010602030
C01F000D107C8F12>I<001F80000380000380000380000700000700000700000700000E00000E
0003CE000E2E00181C00381C00301C00701C00E03800E03800E03800E03800C07200C07200C072
0060F2006134001E1800111A7C9914>I<01E006181C08380870087010FFE0E000E000E000E000
E0086010602030C01F000D107C8F12>I<000700001980001B80003B0000300000300000700000
700000700000700007FF0000E00000E00000E00000E00000E00001C00001C00001C00001C00001
C000038000038000038000038000038000070000070000070000660000E40000CC000070000011
2181990C>I<00F300038B800607000E07000C07001C0700380E00380E00380E00380E00301C00
301C00301C00183C0018780007B800003800003800007000607000E0E000C1C0007F000011177E
8F12>I<1F80000380000380000380000700000700000700000700000E00000E00000E7C000F86
001E07001E07001C07001C0700380E00380E00380E00381C00701C80701C80703880703900E019
00600E00111A7E9914>I<030706000000000000384C4E8E9C9C1C3838707272E2E4643808197C
980C>I<000C000E000C00000000000000000000000000E0013002380438043804380070007000
70007000E000E000E000E001C001C001C001C003806380E700CE0078000F2081980C>I<1F8003
800380038007000700070007000E000E000E0E0E131C271C431C801F003C003F8039C038E070E2
70E270E270E4E0646038101A7E9912>I<3F0707070E0E0E0E1C1C1C1C3838383870707070E4E4
E4E46830081A7D990A>I<307C1E00598663009E0783809E0703809C0703809C070380380E0700
380E0700380E0700380E0E00701C0E40701C0E40701C1C40701C1C80E0380C80601807001A107C
8F1F>I<307C005986009E07009E07009C07009C0700380E00380E00380E00381C00701C80701C
80703880703900E01900600E0011107C8F16>I<01F006180C0C180E300E700E600EE00EE00EE0
0CE01CE018E030606030C01F000F107C8F14>I<030F000590C009E0C009C06009C06009C06003
80E00380E00380E00380E00701C00701800703800703000E8E000E78000E00000E00001C00001C
00001C00001C0000FF00001317808F14>I<03C20E2E181C381C301C701CE038E038E038E038C0
70C070C07060F061E01EE000E000E001C001C001C001C01FF00F177C8F12>I<30F059189E389C
189C009C0038003800380038007000700070007000E00060000D107C8F10>I<03E00430083018
7018601C001F801FC00FE000E00060E060E06080C041803E000C107D8F10>I<06000E000E000E
000E001C001C00FFC01C0038003800380038007000700070007000E100E100E100E20064003800
0A177C960D>I<38064C074E0E8E0E9C0E9C0E1C1C381C381C381C7039703970393079389A0F0C
10107C8F15>I<38184C1C4E1C8E0C9C0C9C0C1C08380838083808701070107020304018C00F00
0E107C8F12>I<38064C074E0E8E0E9C0E9C0E1C1C381C381C381C703870387038307838F00F70
0070006060E0E1C0C18047003C0010177C8F13>121 D<038207C40FFC10081010002000400180
030004000808100820187FF043E081C00F107E8F10>I<FFFFFFFFC022017C8927>124
D E /Fk 67 128 df<00FC000182000703000607000E02000E00000E00000E00000E00000E0000
FFFF000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E0700
0E07000E07007F0FE0131A809915>12 D<01C0000003200000061000000E1000000E1000000E10
00000E1000000E2000000E4000000E40000007807F8007001E0007000800078010000B80100013
C0200031C0200060E04000E0F08000E0788000E0390000E01E0080E00E0080700F01003873C300
0F807C00191A7E991E>38 D<00800100020004000C000800180030003000300060006000600060
00E000E000E000E000E000E000E000E000E000E000600060006000600030003000300018000800
0C00040002000100008009267D9B0F>40 D<8000400020001000180008000C0006000600060003
000300030003000380038003800380038003800380038003800380030003000300030006000600
06000C0008001800100020004000800009267E9B0F>I<60F0F07010101020204080040B7D830B>
44 D<FFC0FFC00A0280880D>I<60F0F06004047D830B>I<0004000C0018001800180030003000
3000600060006000C000C000C00180018001800300030003000600060006000C000C000C001800
18001800300030003000600060006000C000C0000E257E9B13>I<078018603030303060186018
E01CE01CE01CE01CE01CE01CE01CE01CE01CE01CE01CE01C6018601870383030186007800E187E
9713>I<03000700FF000700070007000700070007000700070007000700070007000700070007
0007000700070007000700FFF00C187D9713>I<0F80106020304038803CC01CE01C401C003C00
3800380070006000C001800100020004040804100430083FF87FF8FFF80E187E9713>I<0F8010
E02070607870382038007800700070006000C00F8000E000700038003C003CE03CE03CC03C4038
407030E00F800E187E9713>I<00300030007000F000F001700370027004700C70087010703070
20704070C070FFFF00700070007000700070007007FF10187F9713>I<30183FF03FE03FC02000
200020002000200027C03860203000380018001C001C401CE01CE01C80184038403030E00F800E
187E9713>I<01E006100C1818383038300070006000E000E7C0E860F030F018E018E01CE01CE0
1C601C601C701830183030186007C00E187E9713>I<40007FFE7FFC7FFC400880108010802000
4000400080018001800100030003000300030007000700070007000700070002000F197E9813>
I<078018603030201860186018601870103C303E600F8007C019F030F86038401CC00CC00CC00C
C00C6008201018600FC00E187E9713>I<07801860303070306018E018E018E01CE01CE01C601C
603C303C185C0F9C001C00180018003870307060604021801F000E187E9713>I<60F0F0600000
00000000000060F0F06004107D8F0B>I<000C0000000C0000000C0000001E0000001E0000003F
000000270000002700000043800000438000004380000081C0000081C0000081C0000100E00001
00E00001FFE000020070000200700006007800040038000400380008001C0008001C001C001E00
FF00FFC01A1A7F991D>65 D<FFFF000E01C00E00E00E00700E00780E00780E00780E00780E0078
0E00F00E00E00E03C00FFF800E01E00E00700E00780E003C0E003C0E003C0E003C0E003C0E0038
0E00780E00F00E01E0FFFF80161A7E991B>I<003F0201C0C603002E0E001E1C000E1C00063800
06780002700002700002F00000F00000F00000F00000F00000F000007000027000027800023800
041C00041C00080E000803003001C0C0003F00171A7E991C>I<FFFF000E01C00E00E00E00300E
00380E001C0E001C0E000E0E000E0E000F0E000F0E000F0E000F0E000F0E000F0E000F0E000F0E
000E0E000E0E001E0E001C0E00380E00380E00700E01C0FFFF00181A7E991D>I<FFFFF00E0070
0E00300E00100E00180E00080E00080E00080E04000E04000E04000E0C000FFC000E0C000E0400
0E04000E04000E00040E00040E00080E00080E00080E00180E00380E0070FFFFF0161A7E991A>
I<FFFFE00E00E00E00600E00200E00300E00100E00100E00100E04000E04000E04000E0C000FFC
000E0C000E04000E04000E04000E00000E00000E00000E00000E00000E00000E00000E0000FFF0
00141A7E9919>I<003F020001C0C60003002E000E001E001C000E001C00060038000600780002
007000020070000200F0000000F0000000F0000000F0000000F0000000F001FFC070000E007000
0E0078000E0038000E001C000E001C000E000E000E000300160001C06600003F82001A1A7E991E
>I<FFE7FF0E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700F
FFF00E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E0070FF
E7FF181A7E991D>I<FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E00FFE00B1A7F990E>I<1FFC00E000E000E000E0
00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E040E0E0E0E0E041C061
801E000E1A7D9914>I<FFE07F800E001E000E0018000E0010000E0020000E0040000E0080000E
0100000E0200000E0400000E0800000E1C00000E2E00000E4E00000E8700000F0380000E038000
0E01C0000E00E0000E00E0000E0070000E0070000E0038000E001C000E003E00FFE0FF80191A7E
991E>I<FFF0000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00
000E00000E00000E00000E00000E00000E00200E00200E00200E00600E00400E00400E00C00E03
C0FFFFC0131A7E9918>I<FF0003FC0F0003C00F0003C00B8005C00B8005C00B8005C009C009C0
09C009C009C009C008E011C008E011C008E011C0087021C0087021C0083841C0083841C0083841
C0081C81C0081C81C0081C81C0080F01C0080F01C0080F01C0080601C01C0601C0FF861FFC1E1A
7E9923>I<FE01FF0F00380F00100B80100B801009C01008E01008E01008701008701008381008
1C10081C10080E10080E100807100803900803900801D00801D00800F00800700800700800301C
0030FF8010181A7E991D>I<FFFF000E03C00E00E00E00700E00700E00780E00780E00780E0078
0E00700E00700E00E00E03C00FFF000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E00000E0000FFE000151A7E991A>80 D<FFFC00000E0780000E01C0000E00E0000E00F0
000E00F0000E00F0000E00F0000E00F0000E00E0000E01C0000E0780000FFC00000E0600000E03
00000E0180000E01C0000E01C0000E01C0000E01E0000E01E0000E01E0000E01E0800E00F0800E
007100FFE03E00191A7E991C>82 D<0FC21836200E6006C006C002C002C002E00070007E003FE0
1FF807FC003E000E00070003800380038003C002C006E004D81887E0101A7E9915>I<7FFFFF00
701C0700401C0100401C0100C01C0180801C0080801C0080801C0080001C0000001C0000001C00
00001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C0000001C
0000001C0000001C0000001C0000001C000003FFE000191A7F991C>I<FFE1FF0E00380E00100E
00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E00100E
00100E00100E00100E001006002007002003004001804000C180003E00181A7E991D>I<FF801F
C01E000F001C0006000E0004000E000400070008000700080007000800038010000380100003C0
300001C0200001C0200000E0400000E0400000E040000070800000708000003900000039000000
390000001E0000001E0000001E0000000C0000000C00001A1A7F991D>I<FF83FF0FF03C007801
C01C007800801C007800800E007801000E007801000E009C010007009C020007009C020007010E
020007010E020003810E04000382070400038207040001C207080001C403880001C403880000E4
03900000E403900000E801D000007801E000007801E000007000E000007000E000003000C00000
20004000241A7F9927>I<3F8070C070E020700070007007F01C7030707070E070E071E071E0F1
71FB1E3C10107E8F13>97 D<FC00001C00001C00001C00001C00001C00001C00001C00001C0000
1C00001CF8001F0E001E07001C03801C01801C01C01C01C01C01C01C01C01C01C01C01C01C0380
1C03001E07001B0C0010F000121A7F9915>I<07F80C1C381C30087000E000E000E000E000E000
E0007000300438080C1807E00E107F8F11>I<007E00000E00000E00000E00000E00000E00000E
00000E00000E00000E0003CE000C3E00380E00300E00700E00E00E00E00E00E00E00E00E00E00E
00E00E00600E00700E00381E001C2E0007CFC0121A7F9915>I<07C01C3030187018600CE00CFF
FCE000E000E000E0006000300438080C1807E00E107F8F11>I<01F0031807380E100E000E000E
000E000E000E00FFC00E000E000E000E000E000E000E000E000E000E000E000E000E000E007FE0
0D1A80990C>I<0FCE187330307038703870387038303018602FC02000600070003FF03FFC1FFE
600FC003C003C003C0036006381C07E010187F8F13>I<FC00001C00001C00001C00001C00001C
00001C00001C00001C00001C00001CF8001D0C001E0E001E0E001C0E001C0E001C0E001C0E001C
0E001C0E001C0E001C0E001C0E001C0E001C0E00FF9FC0121A7F9915>I<18003C003C00180000
0000000000000000000000FC001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C00FF80091A80990A>I<018003C003C001800000000000000000000000000FC001C001C001C0
01C001C001C001C001C001C001C001C001C001C001C001C001C001C001C041C0E180E3007E000A
2182990C>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C3F80
1C1E001C18001C10001C20001C40001DC0001FE0001CE0001C70001C78001C38001C1C001C1E00
1C1F00FF3FC0121A7F9914>I<FC001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C00FF80091A80990A>I<FC7C1F001D8E
63801E0781C01E0781C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C
0701C01C0701C01C0701C01C0701C0FF9FE7F81D107F8F20>I<FCF8001D0C001E0E001E0E001C
0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E00FF9FC012107F8F
15>I<07E01C38300C700E6006E007E007E007E007E007E0076006700E381C1C3807E010107F8F
13>I<FCF8001F0E001E07001C03801C03801C01C01C01C01C01C01C01C01C01C01C01C01C0380
1C03001E07001F0C001CF0001C00001C00001C00001C00001C00001C0000FF800012177F8F15>
I<03C2000C2600381E00300E00700E00E00E00E00E00E00E00E00E00E00E00E00E00700E00700E
00381E001C2E0007CE00000E00000E00000E00000E00000E00000E00007FC012177F8F14>I<FC
E01D701E701E201C001C001C001C001C001C001C001C001C001C001C00FFC00C107F8F0F>I<1F
2060E04020C020C020F0007F003FC01FE000F080708030C030C020F0408F800C107F8F0F>I<04
00040004000C000C001C003C00FFC01C001C001C001C001C001C001C001C001C201C201C201C20
1C200E4003800B177F960F>I<FC7E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E
001C0E001C0E001C0E001C0E001C1E000C2E0007CFC012107F8F15>I<FF1F803C06001C04001C
04001E0C000E08000E080007100007100007900003A00003A00001C00001C00001C00000800011
107F8F14>I<FF3F9F803C0E0700380E06001C1604001C1704001E170C000E2308000E2388000F
239800074190000741D00003C1E0000380E0000380E0000180C0000100400019107F8F1C>I<FF
3F803C1C001C18000E100007200007600003C00001C00001E00003E00002700004380008380018
1C00381E00FC3FC012107F8F14>I<FF1F803C06001C04001C04001E0C000E08000E0800071000
07100007900003A00003A00001C00001C00001C000008000008000010000010000E10000E20000
E4000078000011177F8F14>I<FFFFC01201808913>123 D<6180F3C0F3C061800A047C9913>
127 D E /Fl 44 122 df<003FE3F801F03F1C03C03E3E07C07C3E0F807C3E0F807C1C0F807C00
0F807C000F807C000F807C000F807C00FFFFFFC0FFFFFFC00F807C000F807C000F807C000F807C
000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F80
7C007FE1FFC07FE1FFC01F1D809C1C>11 D<003FC00001F0300003C0380007C07C000F807C000F
807C000F8038000F8000000F8000000F8000000F800000FFFFFC00FFFFFC000F807C000F807C00
0F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C
000F807C000F807C007FE1FF807FE1FF80191D809C1B>I<003FC1FE0001F03F818003C03E01C0
07C07E03E00F807C03E00F807C03E00F807C01C00F807C00000F807C00000F807C00000F807C00
00FFFFFFFFE0FFFFFFFFE00F807C03E00F807C03E00F807C03E00F807C03E00F807C03E00F807C
03E00F807C03E00F807C03E00F807C03E00F807C03E00F807C03E00F807C03E00F807C03E00F80
7C03E07FE1FF0FFC7FE1FF0FFC261D809C28>14 D<03F8000F1E001C07003C07803803807803C0
7803C07803C0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E0
F803E07803C07803C03803803C07801C07000F1E0003F800131B7E9A18>48
D<00600001E0000FE000FFE000F3E00003E00003E00003E00003E00003E00003E00003E00003E0
0003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E0007FFF
807FFF80111B7D9A18>I<07F8001FFE00383F80780FC0FC07C0FC07E0FC03E0FC03E07803E000
07E00007C00007C0000F80001F00001E0000380000700000E0000180600300600600600800E01F
FFC03FFFC07FFFC0FFFFC0FFFFC0131B7E9A18>I<03F8001FFE003C1F003C0F807C07C07E07C0
7C07C03807C0000F80000F80001E00003C0003F800001E00000F800007C00007C00007E03007E0
7807E0FC07E0FC07E0FC07C0780F80781F001FFE0007F800131B7E9A18>I<0001800003800007
80000F80001F80003F80006F8000CF80008F80018F80030F80060F800C0F80180F80300F80600F
80C00F80FFFFF8FFFFF8000F80000F80000F80000F80000F80000F8001FFF801FFF8151B7F9A18
>I<1801801FFF001FFE001FFC001FF8001FC00018000018000018000018000019F8001E0E0018
0F801007800007C00007E00007E00007E07807E0F807E0F807E0F807C0F007C0600F80381F001F
FE0007F000131B7E9A18>I<007E0003FF000781800F03C01E07C03C07C03C0380780000780000
F80000F8F800FB0E00FA0780FC0380FC03C0F803E0F803E0F803E0F803E07803E07803E07803C0
3C03C03C07801E0F0007FE0003F800131B7E9A18>I<6000007FFFE07FFFE07FFFC07FFF807FFF
80E00300C00600C00C00C0180000300000300000600000E00000E00001E00001C00003C00003C0
0003C00003C00007C00007C00007C00007C00007C00007C000038000131C7D9B18>I<03F8000F
FE001E0F803807803803C07803C07803C07E03C07F83807FC7003FFE001FFC000FFE0007FF801D
FF80387FC0781FE0F007E0F003E0F001E0F001E0F001E07801C07803803E07801FFE0003F80013
1B7E9A18>I<03F8000FFE001E0F003C07807807807803C0F803C0F803C0F803E0F803E0F803E0
F803E07807E03807E03C0BE00E1BE003E3E00003E00003C00003C03807C07C07807C0700780F00
383C001FF8000FE000131B7E9A18>I<78FCFCFCFC7800000000000078FCFCFCFC7806127D910D>
I<00038000000380000007C0000007C0000007C000000FE000000FE000001FF000001BF000001B
F0000031F8000031F8000061FC000060FC0000E0FE0000C07E0000C07E0001803F0001FFFF0003
FFFF8003001F8003001F8006000FC006000FC00E000FE00C0007E0FFC07FFEFFC07FFE1F1C7E9B
24>65 D<001FE02000FFF8E003F80FE007C003E00F8001E01F0000E03E0000E03E0000607E0000
607C000060FC000000FC000000FC000000FC000000FC000000FC000000FC000000FC0000007C00
00607E0000603E0000603E0000C01F0000C00F80018007C0030003F80E0000FFFC00001FE0001B
1C7D9B22>67 D<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC003800FC003800FC18180
0FC181800FC181800FC180000FC380000FFF80000FFF80000FC380000FC180000FC180000FC180
600FC180600FC000E00FC000C00FC000C00FC001C00FC001C00FC003C00FC00F80FFFFFF80FFFF
FF801B1C7E9B1F>69 D<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC003800FC003800F
C001800FC181800FC181800FC180000FC180000FC380000FFF80000FFF80000FC380000FC18000
0FC180000FC180000FC180000FC000000FC000000FC000000FC000000FC000000FC00000FFFF00
00FFFF0000191C7E9B1E>I<FFFC3FFFFFFC3FFF0FC003F00FC003F00FC003F00FC003F00FC003
F00FC003F00FC003F00FC003F00FC003F00FC003F00FFFFFF00FFFFFF00FC003F00FC003F00FC0
03F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F0FF
FC3FFFFFFC3FFF201C7E9B25>72 D<FFFFFFFF07E007E007E007E007E007E007E007E007E007E0
07E007E007E007E007E007E007E007E007E007E007E007E007E007E0FFFFFFFF101C7F9B12>I<
FFFFF800FFFFFE000FC03F800FC00F800FC007C00FC007E00FC007E00FC007E00FC007E00FC007
E00FC007C00FC007C00FC00F800FC03F000FFFFC000FC000000FC000000FC000000FC000000FC0
00000FC000000FC000000FC000000FC000000FC000000FC00000FFFC0000FFFC00001B1C7E9B21
>80 D<FFFFF00000FFFFFE00000FC03F00000FC00F80000FC007C0000FC007E0000FC007E0000F
C007E0000FC007E0000FC007E0000FC007C0000FC00F80000FC03E00000FFFF000000FC07C0000
0FC03E00000FC03F00000FC01F80000FC01F80000FC01F80000FC01F80000FC01F80000FC01F80
000FC01F81800FC01F81800FC00FC180FFFC07C300FFFC01FE00211C7E9B24>82
D<0FF8001C1E003E0F803E07803E07C01C07C00007C0007FC007E7C01F07C03C07C07C07C0F807
C0F807C0F807C0780BC03E13F80FE1F815127F9117>97 D<FF0000FF00001F00001F00001F0000
1F00001F00001F00001F00001F00001F00001F3F801FE1E01F80701F00781F003C1F003C1F003E
1F003E1F003E1F003E1F003E1F003E1F003C1F003C1F00781F80701EC1E01C3F00171D7F9C1B>
I<03FC000E0E001C1F003C1F00781F00780E00F80000F80000F80000F80000F80000F800007800
007801803C01801C03000E0E0003F80011127E9115>I<000FF0000FF00001F00001F00001F000
01F00001F00001F00001F00001F00001F001F9F00F07F01C03F03C01F07801F07801F0F801F0F8
01F0F801F0F801F0F801F0F801F07801F07801F03C01F01C03F00F0FFE03F9FE171D7E9C1B>I<
01FC000F07001C03803C01C07801C07801E0F801E0F801E0FFFFE0F80000F80000F80000780000
7C00603C00601E00C00F038001FC0013127F9116>I<007F0001E38003C7C00787C00F87C00F83
800F80000F80000F80000F80000F8000FFF800FFF8000F80000F80000F80000F80000F80000F80
000F80000F80000F80000F80000F80000F80000F80000F80007FF8007FF800121D809C0F>I<03
F8F00E0F381E0F381C07303C07803C07803C07803C07801C07001E0F000E0E001BF80010000018
00001800001FFF001FFFC00FFFE01FFFF07801F8F00078F00078F000787000707800F01E03C007
FF00151B7F9118>I<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F0000
1F00001F0FC01F31E01F40F01F80F81F80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8
1F00F81F00F81F00F81F00F8FFE7FFFFE7FF181D7F9C1B>I<1E003F003F003F003F001E000000
00000000000000000000FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F
001F00FFE0FFE00B1E7F9D0E>I<FF0000FF00001F00001F00001F00001F00001F00001F00001F
00001F00001F00001F0FF81F0FF81F03801F07001F0C001F18001F70001FF8001FFC001FBC001F
3E001F1F001F0F001F0F801F07C01F03E0FFC7FCFFC7FC161D7F9C19>107
D<FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F00FFE0FFE00B1D7F9C0E>I<FF0FC07E00FF31E18F001F40
F207801F80FC07C01F80FC07C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F
00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C0FFE7FF3FF8FFE7FF3FF8
25127F9128>I<FF0FC0FF31E01F40F01F80F81F80F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F8FFE7FFFFE7FF18127F911B>I<01FC000F07801C01C03C
01E07800F07800F0F800F8F800F8F800F8F800F8F800F8F800F87800F07800F03C01E01E03C00F
078001FC0015127F9118>I<FF3F80FFE1E01F80F01F00781F007C1F003C1F003E1F003E1F003E
1F003E1F003E1F003E1F003C1F007C1F00781F80F01FC1E01F3F001F00001F00001F00001F0000
1F00001F0000FFE000FFE000171A7F911B>I<FE3E00FE47001E8F801E8F801E8F801F07001F00
001F00001F00001F00001F00001F00001F00001F00001F00001F0000FFF000FFF00011127F9114
>114 D<1FD830786018E018E018F000FF807FE07FF01FF807FC007CC01CC01CE01CE018F830CF
C00E127E9113>I<0300030003000300070007000F000F003FFCFFFC1F001F001F001F001F001F
001F001F001F001F0C1F0C1F0C1F0C0F08079803F00E1A7F9913>I<FF07F8FF07F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F01F80F01F80786
FF01F8FF18127F911B>I<FF8FF8FEFF8FF8FE1F03E0301F03E0301F83E0700F83F0600F86F060
07C6F0C007CEF8C007EC79C003EC7D8003F83D8001F83F0001F83F0001F01F0000F01E0000E00E
0000E00E001F127F9122>119 D<FFC7FCFFC7FC1F81800F838007C70003EE0001FC0001F80000
F800007C0000FE0001DF00039F00070F800607C00C03E0FF07FCFF07FC16127F9119>I<FFC1FC
FFC1FC1F00601F80E00F80C00FC0C007C18007C18003E30003E30001F70001F60000FE0000FC00
00FC00007800007800003000003000007000706000F86000F8C000F980007300003E0000161A7F
9119>I E /Fm 33 122 df<60F0F070101020204040040A7D830A>44 D<FF80FF80090280870C>
I<03000700FF000700070007000700070007000700070007000700070007000700070007000700
07007FF00C157E9412>49 D<00300030007000F001F001700270047008701870107020704070C0
70FFFE0070007000700070007003FE0F157F9412>52 D<01F00608080C181C301C70006000E000
E3E0EC30F018F00CE00EE00EE00E600E600E300C3018183007C00F157F9412>54
D<07C0183030186018E00CE00CE00EE00EE00E601E301E186E0F8E000E000C001C701870186030
20C01F800F157F9412>57 D<001000003800003800003800005C00005C00005C00008E00008E00
008E0001070001070003078002038002038007FFC00401C00401C00800E00800E01800E03800F0
FE03FE17177F961A>65 D<00FC100383300E00B01C0070380030300030700010600010E00010E0
0000E00000E00000E00000E00000E000106000107000103000203800201C00400E008003830000
FC0014177E9619>67 D<FFFF001C01C01C00E01C00301C00381C00181C001C1C000C1C000E1C00
0E1C000E1C000E1C000E1C000E1C000E1C000C1C001C1C001C1C00381C00301C00601C01C0FFFF
0017177F961B>I<FC00FE1E00381F001017001013801011C01011C01010E01010701010381010
3810101C10100E10100F101007101003901001D01001D01000F0100070100030380030FE001017
177F961A>78 D<00FC000303000E01C01C00E0380070300030700038600018E0001CE0001CE000
1CE0001CE0001CE0001CE0001C7000387000383000303800701C00E00E01C003030000FC001617
7E961B>I<FFFC001C03801C00C01C00E01C00701C00701C00701C00701C00E01C00C01C03801F
FE001C07801C01C01C00E01C00E01C00E01C00E01C00E01C00E11C00E11C0072FF803C18177F96
1A>82 D<0FC4302C601C400CC004C004C004E00070007F003FE00FF801FC001C000E0006800680
068006C004E008D81087E00F177E9614>I<7FFFF8603818403808403808803804803804803804
003800003800003800003800003800003800003800003800003800003800003800003800003800
00380000380007FFC016177F9619>I<FF80FE1C00381C00101C00101C00101C00101C00101C00
101C00101C00101C00101C00101C00101C00101C00101C00101C00101C00100E00200600200300
40018180007E0017177F961A>I<1FC0386038301038003803F81E3830387038E039E039E07970
FF1F1E100E7F8D12>97 D<07F01838303870106000E000E000E000E000600070083008183007C0
0D0E7F8D10>99 D<0FC0186030307038E018FFF8E000E000E000600070083010183007C00D0E7F
8D10>101 D<03E006700E701C201C001C001C001C001C00FF801C001C001C001C001C001C001C
001C001C001C001C001C00FF800C1780960B>I<0F9E18E33060707070707070306018C02F8020
0060003FE03FF83FFC600EC006C006C006600C38380FE010157F8D12>I<FC00001C00001C0000
1C00001C00001C00001C00001C00001C00001C7C001D8E001E07001C07001C07001C07001C0700
1C07001C07001C07001C07001C07001C0700FF9FE01317809614>I<183C3C1800000000007C1C
1C1C1C1C1C1C1C1C1C1C1CFF081780960A>I<FC001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C00FF80091780960A>108
D<FC7C1F001D8E63801E0781C01C0701C01C0701C01C0701C01C0701C01C0701C01C0701C01C07
01C01C0701C01C0701C01C0701C0FF9FE7F81D0E808D1E>I<FC7C001D8E001E07001C07001C07
001C07001C07001C07001C07001C07001C07001C07001C0700FF9FE0130E808D14>I<07C01830
3018600C600CE00EE00EE00EE00EE00E701C3018183007C00F0E7F8D12>I<FCF8001F0E001C03
001C03801C01801C01C01C01C01C01C01C01C01C01801C03801C07001F0E001CF8001C00001C00
001C00001C00001C0000FF80001214808D14>I<FCF01D381E381C101C001C001C001C001C001C
001C001C001C00FF800D0E808D0E>114 D<1F4060C0C040C040E000FF007F801FC001E0806080
60C060E0C09F000B0E7F8D0E>I<080008000800180018003800FF803800380038003800380038
00380038403840384038401C800F000A147F930E>I<FC3F001C07001C07001C07001C07001C07
001C07001C07001C07001C07001C07001C0F000E170003E7E0130E808D14>I<FE1F3C0E3C0C1C
081C080E100E100720072003C003C003C001800180100E7F8D13>I<FE1F3C0E3C0C1C081C080E
100E100720072003C003C003C00180018001000100E200E200A400780010147F8D13>121
D E /Fn 17 122 df<03F00FE000F0030000F0020000B8020000B80200011C0400011C0400011C
0400010E0400020E0800020E080002070800020708000403900004039000040390000401D00008
01E0000800E0000800E0000800E00018004000FE0040001B177E961A>78
D<7FC1FC1C00601C00401C00401C00403800803800803800803800807001007001007001007001
00E00200E00200E00200E00200E00400E00800E008006030003040001F8000161779961A>85
D<072008E018E0306030C060C060C060C0C180C188C1884388659038E00D0E7C8D12>97
D<03C00C6018E030E030006000600060004000C0004020604021801E000B0E7C8D10>99
D<07001880304060404080FF00C000C000C0008000C040C08043003C000A0E7B8D10>101
D<001C0036002E006C00600060006000C000C007FC00C000C001C0018001800180018001800300
0300030003000300060006006600E400C80070000F1D81960B>I<01C8023806380C180C301830
1830183030603060306010E019C00EC000C000C06180E180C3007C000D147E8D10>I<1F000600
0600060006000C000C000C000C0019C01A601C201830306030603060306060C060C461846188C0
98C0E00E177D9612>I<030706000000000000384C4C4C8C18181830326262243808177D960B>I<
38787800448C8C0047050400460604008C0C0C000C0C0C000C0C0C000C0C0C0018181800181818
8018183080181831003030130030301C00190E7D8D1D>109 D<387044984708460C8C180C180C
180C18183018311861186230263038100E7D8D14>I<078018C0304060606060C060C060C06080
C080C08180C10046003C000B0E7B8D12>I<38F04518463846308C000C000C000C001800180018
001800300030000D0E7D8D0F>114 D<07800C4018E018E038001E001F8007C000C060C0E0C0C1
80C3003E000B0E7D8D0F>I<030003000600060006000600FF800C000C000C0018001800180018
00300031003100310032001C0009147D930C>I<1C1026184618461886100C100C100C10182018
2018401840088007000D0E7D8D10>118 D<1C0826184618461886300C300C300C301860186018
60186008C007C000C000807180730066003C000D147D8D11>121 D E /Fo
16 118 df<FFFFFF000F800F000780030007800300078001000780018007800080078000800780
0080078080800780800007808000078080000781800007FF800007818000078080000780800007
80800007808000078000200780002007800020078000400780004007800040078000C0078000C0
078001800F800F80FFFFFF801B1F7E9E1F>69 D<000FE0200078186000E004E0038002E0070001
E00F0000E01E0000601E0000603C0000603C0000207C00002078000020F8000000F8000000F800
0000F8000000F8000000F8000000F8000000F8007FFCF80003E0780001E07C0001E03C0001E03C
0001E01E0001E01E0001E00F0001E0070001E0038002E000E0046000781820000FE0001E217D9F
24>71 D<FFF8FFF80F800F8007800F0007800F0007800F0007800F0007800F0007800F0007800F
0007800F0007800F0007800F0007800F0007800F0007FFFF0007800F0007800F0007800F000780
0F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007
800F000F800F80FFF8FFF81D1F7E9E22>I<FF80001FF80F80001F800780001F0005C0002F0005
C0002F0005C0002F0004E0004F0004E0004F000470008F000470008F000470008F000438010F00
0438010F000438010F00041C020F00041C020F00041C020F00040E040F00040E040F00040E040F
000407080F000407080F000407080F000403900F000403900F000401E00F000401E00F000401E0
0F000E00C00F001F00C01F80FFE0C1FFF8251F7E9E2A>77 D<1FE000303000781800781C00300E
00000E00000E00000E0000FE00078E001E0E00380E00780E00F00E10F00E10F00E10F01E10781E
103867200F83C014147E9317>97 D<03F0000E1C001C0E00380700380700700700700380F00380
F00380FFFF80F00000F00000F000007000007000003800801800800C010007060001F80011147F
9314>101 D<0E0000FE00000E00000E00000E00000E00000E00000E00000E00000E00000E0000
0E00000E3E000E43000E81800F01C00F01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFE7FC16207F9F19>104
D<1C003E003E003E001C000000000000000000000000000E007E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E00FFC00A1F809E0C>I<00E001F001F001F0
00E0000000000000000000000000007007F000F000700070007000700070007000700070007000
70007000700070007000700070007000700070007000706070F060F0C061803F000C28829E0E>
I<0E0000FE00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0F
F00E03C00E03000E02000E04000E08000E10000E30000E70000EF8000F38000E1C000E1E000E0E
000E07000E07800E03800E03C00E03E0FFCFF815207F9F18>I<0E1F01F000FE618618000E81C8
1C000F00F00E000F00F00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00
E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E
00E00E00FFE7FE7FE023147F9326>109 D<0E3E00FE43000E81800F01C00F01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFE7FC
16147F9319>I<01F800070E001C03803801C03801C07000E07000E0F000F0F000F0F000F0F000
F0F000F0F000F07000E07000E03801C03801C01C0380070E0001F80014147F9317>I<0E78FE8C
0F1E0F1E0F0C0E000E000E000E000E000E000E000E000E000E000E000E000E000E00FFE00F147F
9312>114 D<020002000200060006000E000E003E00FFF80E000E000E000E000E000E000E000E
000E000E000E000E080E080E080E080E080610031001E00D1C7F9B12>116
D<0E01C0FE1FC00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E03C00603C0030DC001F1FC16147F9319>I E
/Fp 15 117 df<0000007F8008000003FFE01800001FC0703800003E0018780000F8000CF00001
F00007F00007C00007F0000F800003F0001F000003E0003E000003E0007E000001E000FC000001
E001F8000001C001F8000001C003F0000001C007F0000001C007E0000001800FE0000001800FC0
000001801FC0000001801FC0000000003F80000000003F80000000003F80000000007F00000000
007F00000000007F00000000007F00000000007E0000000000FE0000000000FE0000000000FE00
00000000FE0000001800FE0000001800FE0000001800FE00000030007E00000030007E00000030
007E00000060007E000000C0003E000000C0003E00000180001F00000300001F00000600000F80
000C000007C00018000003E00030000001F000E0000000FC07800000003FFE0000000007F80000
002D3375B133>67 D<000FFF00000007FF80000FFF0000000FFF8000007F0000000FE00000006F
8000001FC00000006F8000001FC00000006F80000037C00000006F80000067C0000000CF800000
6F80000000CF800000CF80000000CF800000CF80000000CF8000018F800000018F8000031F0000
00018F8000031F0000000187C000061F0000000187C000061F0000000307C0000C3E0000000307
C000183E0000000307C000183E0000000307C000303E0000000607C000307C0000000607C00060
7C0000000607C000C07C0000000607C000C07C0000000C03E00180F80000000C03E00180F80000
000C03E00300F80000000C03E00600F80000001803E00601F00000001803E00C01F00000001803
E00C01F00000001803E01801F00000003003E03003E00000003003E03003E00000003003E06003
E00000003001F06003E00000006001F0C007C00000006001F18007C00000006001F18007C00000
006001F30007C0000000C001F3000F80000000C001F6000F80000000C001FC000F80000000C001
FC000F80000001C001F8001F00000001C000F8001F00000003C000F0001F0000000FE000E0003F
000000FFFE00E00FFFFC0000FFFE00C00FFFFC000041317BB040>77 D<000FFFFFFC00000FFFFF
FF8000007F000FE000007E0003F000007E0001F800007E0001F800007E0000FC0000FC0000FC00
00FC0000FC0000FC0000FC0000FC0000FC0001F80001FC0001F80001FC0001F80001FC0001F800
01FC0003F00003F80003F00003F80003F00003F00003F00007E00007E0000FC00007E0000F8000
07E0001F000007E0007E00000FC001F800000FFFFFE000000FFFFF0000000FC0000000001F8000
0000001F80000000001F80000000001F80000000003F00000000003F00000000003F0000000000
3F00000000007E00000000007E00000000007E00000000007E0000000000FC0000000000FC0000
000000FC0000000000FC0000000001F80000000001F80000000001F80000000003F800000000FF
FFE0000000FFFFE00000002E317BB031>80 D<0007E000001FF1C0003C3BE000F01FE001E00FE0
03E00FC007C007C0078007C00F8007C01F800F801F000F803F000F803F000F807E001F007E001F
007E001F007E001F00FC003E00FC003E00FC003E00FC003E04FC007C0CFC007C0C78007C0C7800
FC187C01FC183C03FC183C077C301E1E3C600FF81FC003E007801E1F799E25>97
D<007C000FFC000FFC0000FC0000F80000F80000F80000F80001F00001F00001F00001F00003E0
0003E00003E00003E00007C00007C00007C00007C7E00F9FF00FB8380FF03C0FC01E1F801F1F80
1F1F001F1F001F3E001F3E001F3E001F3E001F7C003F7C003F7C003F7C003FF8007EF8007EF800
7CF800FCF800F8F800F87801F07801E07803E03807C03C0F001E1E000FFC0003E000183278B121
>I<0001F800000FFE00003F0700007C038000F0078001E00F8003C01F8007C01F800F801F001F
800E001F0000003F0000003F0000007E0000007E0000007E0000007E000000FC000000FC000000
FC000000FC000000FC0000007C0001007C0001807C0003003C0006003E001C001E0078000F81E0
0003FF800000FE0000191F799E21>I<0000001F000003FF000003FF0000003F0000003E000000
3E0000003E0000003E0000007C0000007C0000007C0000007C000000F8000000F8000000F80000
00F8000001F0000001F0000001F00007E1F0001FF3E0003C3BE000F01FE001E00FE003E00FC007
C007C0078007C00F8007C01F800F801F000F803F000F803F000F807E001F007E001F007E001F00
7E001F00FC003E00FC003E00FC003E00FC003E04FC007C0CFC007C0C78007C0C7800FC187C01FC
183C03FC183C077C301E1E3C600FF81FC003E00780203279B125>I<0003F0001FFC007C1E00F0
0F03E00707C0070F80071F80071F00073F000E3E001C7E00787E0FF0FFFF80FFF000FC0000FC00
00F80000F80000F80000F80000F80000F80002F800037800067C000C3C00381E00F00F03C007FF
0001FC00181F789E21>I<000700000F80001F80001F80001F00000E0000000000000000000000
000000000000000000000000000000000000000000000003E00007F0000C7800183C00303C0030
7C00607C00607C0060F800C0F800C0F80001F00001F00001F00003E00003E00003E00007C00007
C0000F80000F81000F83001F03001F03001F06001E06001E0C001E0C000E38000FF00003C00011
307AAF16>105 D<03C007E003F0000FF03FF80FFC001C78787C1C1E001878C03E701F00307D80
1E600F00307F001EC00F00607E001F800F80607E001F000F80607C001F000F00C0F8003E001F00
C0F8003E001F0000F8003E001F0000F8003E001F0001F0007C003E0001F0007C003E0001F0007C
003E0001F0007C007C0003E000F8007C0003E000F8007C0003E000F800F80003E000F800F80807
C001F000F81807C001F001F01807C001F001F01807C001F001F0300F8003E001E0300F8003E001
E0600F8003E001E0C00F8003E000E1800F0003C000FF000E000380003E00351F7A9E3B>109
D<03C00FC0000FF03FE0001C78F0F0001879C0F800307F807800307F007800607E007C00607C00
7C00607C007800C0F800F800C0F800F80000F800F80000F800F80001F001F00001F001F00001F0
01F00001F003E00003E003E00003E003E00003E007C00003E007C04007C007C0C007C00F80C007
C00F80C007C00F81800F800F01800F800F03000F800F06000F80070C000F0007F8000E0001F000
221F7A9E28>I<0001FC00000FFF00001F0780007C03C000F001E001E001F003C000F007C000F8
0F8000F81F8000F81F0000F83F0000F83F0000F87E0001F87E0001F87E0001F87E0001F8FC0003
F0FC0003F0FC0003E0FC0007E0FC0007C07C000FC07C000F807C001F003C003E003E007C001E00
F8000F83E00003FF800000FE00001D1F799E25>I<03C03F000FF0FF801C79C1C0187B81E0307F
03E0307E07E0607C07E0607C07C0607C0380C0F80000C0F8000000F8000000F8000001F0000001
F0000001F0000001F0000003E0000003E0000003E0000003E0000007C0000007C0000007C00000
07C000000F8000000F8000000F8000000F8000000F0000000E0000001B1F7A9E1E>114
D<000FC0003FF000783800F01C01E01C01C03C03C07C03C07C03C07807C00007E00007F80003FF
8003FFC003FFE001FFF0007FF0000FF80001F80000F83800F87C00F0FC00F0FC00F0F800E0F001
E0C003C0600780781F001FFC0007F000161F7A9E1D>I<000E00001E00003E00003E00003E0000
3E00007C00007C00007C00007C0000F80000F80000F800FFFFC0FFFFC001F00001F00001F00003
E00003E00003E00003E00007C00007C00007C00007C0000F80000F80000F80000F80001F00001F
00001F00001F00803E01803E01803E03003E03003E06003E06003E0C001E38000FF00003C00012
2C79AB18>I E /Fq 77 128 df<007E1F0001C1B1800303E3C00703C3C00E03C1800E01C0000E
01C0000E01C0000E01C0000E01C0000E01C000FFFFFC000E01C0000E01C0000E01C0000E01C000
0E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0
000E01C0000E01C0007F87FC001A1D809C18>11 D<007E0001C1800301800703C00E03C00E0180
0E00000E00000E00000E00000E0000FFFFC00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C07F87F8151D809C17>I<007F
C001C1C00303C00703C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFFFC00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01
C00E01C07FCFF8151D809C17>I<003F07E00001C09C18000380F018000701F03C000E01E03C00
0E00E018000E00E000000E00E000000E00E000000E00E000000E00E00000FFFFFFFC000E00E01C
000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E0
1C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C007FC7
FCFF80211D809C23>I<6060F0F0F8F86868080808080808101010102020404080800D0C7F9C15>
34 D<00E000000190000003080000030800000708000007080000070800000708000007100000
07100000072000000740000003C03FE003800F00038006000380040005C0040009C0080010E010
0030E010006070200060702000E0384000E03C4000E01C8000E00F0020E0070020700780403009
C0401830E18007C03E001B1F7E9D20>38 D<60F0F8680808081010204080050C7C9C0C>I<0040
00800100020006000C000C0018001800300030007000600060006000E000E000E000E000E000E0
00E000E000E000E000E000E000600060006000700030003000180018000C000C00060002000100
008000400A2A7D9E10>I<800040002000100018000C000C000600060003000300038001800180
018001C001C001C001C001C001C001C001C001C001C001C001C001800180018003800300030006
0006000C000C00180010002000400080000A2A7E9E10>I<60F0F0701010101020204080040C7C
830C>44 D<FFE0FFE00B0280890E>I<60F0F06004047C830C>I<03C00C301818300C300C700E60
066006E007E007E007E007E007E007E007E007E007E007E007E007E00760066006700E300C300C
18180C3007E0101D7E9B15>48 D<030007003F00C7000700070007000700070007000700070007
0007000700070007000700070007000700070007000700070007000F80FFF80D1C7C9B15>I<07
C01830201C400C400EF00FF80FF807F8077007000F000E000E001C001C00380070006000C00180
030006010C01180110023FFE7FFEFFFE101C7E9B15>I<07E01830201C201C781E780E781E381E
001C001C00180030006007E00030001C001C000E000F000F700FF80FF80FF80FF00E401C201C18
3007E0101D7E9B15>I<000C00000C00001C00003C00003C00005C0000DC00009C00011C00031C
00021C00041C000C1C00081C00101C00301C00201C00401C00C01C00FFFFC0001C00001C00001C
00001C00001C00001C00001C0001FFC0121C7F9B15>I<300C3FF83FF03FC02000200020002000
2000200023E024302818301C200E000E000F000F000F600FF00FF00FF00F800E401E401C203818
7007C0101D7E9B15>I<00F0030C06040C0E181E301E300C700070006000E3E0E430E818F00CF0
0EE006E007E007E007E007E007600760077006300E300C18180C3003E0101D7E9B15>I<400000
7FFF807FFF007FFF0040020080040080040080080000100000100000200000600000400000C000
00C00001C000018000018000038000038000038000038000078000078000078000078000078000
078000030000111D7E9B15>I<03E00C301008200C20066006600660067006780C3E083FB01FE0
07F007F818FC307E601E600FC007C003C003C003C00360026004300C1C1007E0101D7E9B15>I<
03C00C301818300C700C600EE006E006E007E007E007E007E0076007700F300F18170C2707C700
060006000E300C780C78187010203030C00F80101D7E9B15>I<60F0F060000000000000000000
0060F0F06004127C910C>I<60F0F0600000000000000000000060F0F070101010102020408004
1A7C910C>I<0FE03038401CE00EF00EF00EF00E000C001C0030006000C0008001800100010001
000100010001000000000000000000000003000780078003000F1D7E9C14>63
D<000600000006000000060000000F0000000F0000000F00000017800000178000001780000023
C0000023C0000023C0000041E0000041E0000041E0000080F0000080F0000180F8000100780001
FFF80003007C0002003C0002003C0006003E0004001E0004001E000C001F001E001F00FF80FFF0
1C1D7F9C1F>65 D<FFFFC00F00F00F00380F003C0F001C0F001E0F001E0F001E0F001E0F001C0F
003C0F00780F01F00FFFE00F00780F003C0F001E0F000E0F000F0F000F0F000F0F000F0F000F0F
001E0F001E0F003C0F0078FFFFE0181C7E9B1D>I<001F808000E0618001801980070007800E00
03801C0003801C00018038000180780000807800008070000080F0000000F0000000F0000000F0
000000F0000000F0000000F0000000F0000000700000807800008078000080380000801C000100
1C0001000E000200070004000180080000E03000001FC000191E7E9C1E>I<FFFFC0000F00F000
0F003C000F000E000F0007000F0007000F0003800F0003C00F0001C00F0001C00F0001E00F0001
E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001C00F0001C00F0003C00F00
03800F0007800F0007000F000E000F001C000F007000FFFFC0001B1C7E9B20>I<FFFFFC0F003C
0F000C0F00040F00040F00060F00020F00020F02020F02000F02000F02000F06000FFE000F0600
0F02000F02000F02000F02010F00010F00020F00020F00020F00060F00060F000C0F003CFFFFFC
181C7E9B1C>I<FFFFF80F00780F00180F00080F00080F000C0F00040F00040F02040F02000F02
000F02000F06000FFE000F06000F02000F02000F02000F02000F00000F00000F00000F00000F00
000F00000F00000F8000FFF800161C7E9B1B>I<001F808000E0618001801980070007800E0003
801C0003801C00018038000180780000807800008070000080F0000000F0000000F0000000F000
0000F0000000F0000000F000FFF0F0000F80700007807800078078000780380007801C0007801C
0007800E00078007000B800180118000E06080001F80001C1E7E9C21>I<FFF3FFC00F003C000F
003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C00
0F003C000FFFFC000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C
000F003C000F003C000F003C000F003C000F003C00FFF3FFC01A1C7E9B1F>I<FFF00F000F000F
000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F00
0F000F000F000F00FFF00C1C7F9B0F>I<1FFF00F8007800780078007800780078007800780078
00780078007800780078007800780078007800787078F878F878F878F0F040E021C01F00101D7F
9B15>I<FFF8000F80000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00
000F00000F00000F00000F00000F00000F00000F00080F00080F00080F00180F00180F00100F00
300F00700F01F0FFFFF0151C7E9B1A>76 D<FF8000FF800F8000F8000F8000F8000BC00178000B
C00178000BC001780009E002780009E002780008F004780008F004780008F00478000878087800
08780878000878087800083C107800083C107800083C107800081E207800081E207800081E2078
00080F407800080F40780008078078000807807800080780780008030078001C03007800FF8307
FF80211C7E9B26>I<FF007FC00F800E000F8004000BC0040009E0040009E0040008F0040008F8
040008780400083C0400083C0400081E0400080F0400080F0400080784000807C4000803C40008
01E4000801E4000800F40008007C0008007C0008003C0008003C0008001C0008000C001C000C00
FF8004001A1C7E9B1F>I<003F800000E0E0000380380007001C000E000E001C0007003C000780
38000380780003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F00001
E0F00001E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E000700
1C000380380000E0E000003F80001B1E7E9C20>I<FFFF800F00E00F00780F003C0F001C0F001E
0F001E0F001E0F001E0F001E0F001C0F003C0F00780F00E00FFF800F00000F00000F00000F0000
0F00000F00000F00000F00000F00000F00000F00000F0000FFF000171C7E9B1C>I<FFFF00000F
01E0000F0078000F003C000F001C000F001E000F001E000F001E000F001E000F001C000F003C00
0F0078000F01E0000FFF00000F03C0000F00E0000F00F0000F0078000F0078000F0078000F0078
000F0078000F0078000F0078100F0078100F0038100F003C20FFF01C20000007C01C1D7E9B1F>
82 D<07E0801C1980300580700380600180E00180E00080E00080E00080F00000F800007C0000
7FC0003FF8001FFE0007FF0000FF80000F800007C00003C00001C08001C08001C08001C0C00180
C00180E00300D00200CC0C0083F800121E7E9C17>I<7FFFFFC0700F01C0600F00C0400F004040
0F0040C00F0020800F0020800F0020800F0020000F0000000F0000000F0000000F0000000F0000
000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F00
00000F0000000F0000001F800003FFFC001B1C7F9B1E>I<FFF07FC00F000E000F0004000F0004
000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F00
04000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000700080007
800800038010000180100000C020000070C000001F00001A1D7E9B1F>I<FFE00FF01F0003C00F
0001800F0001000F800300078002000780020003C0040003C0040003C0040001E0080001E00800
01F0080000F0100000F0100000F830000078200000782000003C4000003C4000003C4000001E80
00001E8000001F8000000F0000000F00000006000000060000000600001C1D7F9B1F>I<FFE0FF
E0FF1F001F003C1E001E00180F001F00100F001F00100F001F001007801F002007802780200780
27802003C027804003C043C04003C043C04003E043C04001E081E08001E081E08001E081E08000
F100F10000F100F10000F100F100007900FA00007A007A00007A007A00003E007C00003C003C00
003C003C00003C003C00001800180000180018000018001800281D7F9B2B>I<FFF007FC0F8001
E00780008007C0018003C0010003E0020001F0020000F0040000F8040000780800007C1800003C
1000001E2000001F2000000F4000000FC000000780000007800000078000000780000007800000
0780000007800000078000000780000007800000078000007FF8001E1C809B1F>89
D<08081010202040404040808080808080B0B0F8F8787830300D0C7A9C15>92
D<0810204040808080B0F87830050C7D9C0C>96 D<1FC000307000783800781C00301C00001C00
001C0001FC000F1C00381C00701C00601C00E01C40E01C40E01C40603C40304E801F870012127E
9115>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C7C
001D86001E03001C01801C01C01C00C01C00E01C00E01C00E01C00E01C00E01C00E01C00C01C01
C01C01801E030019060010F800131D7F9C17>I<07E00C301878307870306000E000E000E000E0
00E000E00060007004300418080C3007C00E127E9112>I<003F00000700000700000700000700
00070000070000070000070000070000070003E7000C1700180F00300700700700600700E00700
E00700E00700E00700E00700E00700600700700700300700180F000C370007C7E0131D7E9C17>
I<03E00C301818300C700E6006E006FFFEE000E000E000E00060007002300218040C1803E00F12
7F9112>I<00F8018C071E061E0E0C0E000E000E000E000E000E00FFE00E000E000E000E000E00
0E000E000E000E000E000E000E000E000E000E000E007FE00F1D809C0D>I<00038003C4C00C38
C01C3880181800381C00381C00381C00381C001818001C38000C300013C0001000003000001800
001FF8001FFF001FFF803003806001C0C000C0C000C0C000C06001803003001C0E0007F800121C
7F9215>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C
7C001C87001D03001E03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C
03801C03801C03801C0380FF9FF0141D7F9C17>I<18003C003C00180000000000000000000000
00000000FC001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00FF
80091D7F9C0C>I<00C001E001E000C000000000000000000000000000000FE000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E060E0F0C0F1C0
61803E000B25839C0D>I<FC00001C00001C00001C00001C00001C00001C00001C00001C00001C
00001C00001C3FC01C0F001C0C001C08001C10001C20001C40001CE0001DE0001E70001C78001C
38001C3C001C1C001C0E001C0F001C0F80FF9FE0131D7F9C16>I<FC001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C
001C001C00FF80091D7F9C0C>I<FC7E07E0001C838838001D019018001E01E01C001C01C01C00
1C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C
001C01C01C001C01C01C001C01C01C001C01C01C00FF8FF8FF8021127F9124>I<FC7C001C8700
1D03001E03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380
1C03801C0380FF9FF014127F9117>I<03F0000E1C00180600300300700380600180E001C0E001
C0E001C0E001C0E001C0E001C06001807003803003001806000E1C0003F00012127F9115>I<FC
7C001D86001E03001C01801C01C01C00C01C00E01C00E01C00E01C00E01C00E01C00E01C01C01C
01C01C01801E03001D06001CF8001C00001C00001C00001C00001C00001C00001C0000FF800013
1A7F9117>I<03C1000C3300180B00300F00700700700700E00700E00700E00700E00700E00700
E00700600700700700300F00180F000C370007C700000700000700000700000700000700000700
000700003FE0131A7E9116>I<FCE01D301E781E781C301C001C001C001C001C001C001C001C00
1C001C001C001C00FFC00D127F9110>I<1F9030704030C010C010E010F8007F803FE00FF000F8
80388018C018C018E010D0608FC00D127F9110>I<04000400040004000C000C001C003C00FFE0
1C001C001C001C001C001C001C001C001C001C101C101C101C101C100C100E2003C00C1A7F9910
>I<FC1F801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C03801C
03801C03801C07800C07800E1B8003E3F014127F9117>I<FF07E03C03801C01001C01000E0200
0E020007040007040007040003880003880003D80001D00001D00000E00000E00000E000004000
13127F9116>I<FF3FCFE03C0F03801C0701801C0701001C0B01000E0B82000E0B82000E118200
0711C4000711C4000720C40003A0E80003A0E80003C0680001C0700001C0700001803000008020
001B127F911E>I<7F8FF00F03800F030007020003840001C80001D80000F00000700000780000
F800009C00010E00020E000607000403801E07C0FF0FF81512809116>I<FF07E03C03801C0100
1C01000E02000E020007040007040007040003880003880003D80001D00001D00000E00000E000
00E000004000004000008000008000F08000F10000F300006600003C0000131A7F9116>I<7FFC
70386038407040F040E041C003C0038007000F040E041C043C0C380870087038FFF80E127F9112
>I<FFFFFFFFFF802901808B2A>124 D<6060F0F0F0F060600C047C9C15>127
D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 1573 178 a Fq(1)383 436 y Fp(Monadic)25 b(Parser)h(Combinators)687
556 y Fo(Graham)14 b(Hutton)649 610 y Fn(University)g(of)e(Nottingham)733
693 y Fo(Erik)k(Meijer)683 747 y Fn(University)e(of)f(Utr)n(e)n(cht)478
830 y Fm(App)q(ears)e(as)g(tec)o(hnical)e(rep)q(ort)h(NOTTCS-TR-96-4,)335
872 y(Departmen)o(t)e(of)k(Computer)d(Science,)h(Univ)o(ersit)o(y)f(of)i
(Nottingham,)e(1996)p 100 968 1495 2 v 755 1030 a Fl(Abstract)100
1103 y Fk(In)15 b(functional)j(programming,)f(a)e(p)q(opular)j(approac)o(h)e
(to)g(building)i(recursiv)o(e)f(descen)o(t)f Fj(p)n(arsers)h
Fk(is)100 1149 y(to)12 b(mo)q(del)i(parsers)g(as)f(functions,)h(and)g(to)f
(de\014ne)g(higher-order)i(functions)g(\(or)e Fj(c)n(ombinators)s
Fk(\))d(that)100 1194 y(implemen)o(t)i(grammar)e(constructions)i(suc)o(h)f
(as)f(sequencing,)j(c)o(hoice,)d(and)h(rep)q(etition.)h(Suc)o(h)f(parsers)100
1240 y(form)j(an)i(instance)g(of)f(a)g Fj(monad)t Fk(,)e(an)i(algebraic)i
(structure)e(from)g(mathematics)h(that)g(has)f(pro)o(v)o(ed)100
1286 y(useful)f(for)g(addressing)h(a)f(n)o(um)o(b)q(er)g(of)g(computational)i
(problems.)f(The)f(purp)q(ose)g(of)g(this)g(article)h(is)100
1331 y(to)c(pro)o(vide)i(a)e(step-b)o(y-step)i(tutorial)g(on)e(the)h(monadic)
h(approac)o(h)g(to)e(building)k(functional)e(parsers,)100 1377
y(and)d(to)f(explain)j(some)e(of)g(the)f(b)q(ene\014ts)i(that)f(result)h
(from)e(exploiting)k(monads.)d(No)g(prior)g(kno)o(wledge)100
1423 y(of)i(parser)h(com)o(binators)i(or)e(of)f(monads)i(is)f(assumed.)g
(Indeed,)h(this)f(article)h(can)f(also)h(b)q(e)f(view)o(ed)h(as)100
1468 y(a)f(\014rst)g(in)o(tro)q(duction)j(to)d(the)g(use)g(of)g(monads)h(in)g
(programming.)p 100 1541 V eop
%%Page: 2 2
2 1 bop 100 178 a Fq(2)441 b Fi(Gr)n(aham)14 b(Hutton)i(and)f(Erik)g(Meijer)
754 278 y Fl(Con)o(ten)o(ts)100 359 y(1)38 b(In)o(tro)q(duction)1144
b Fq(3)100 413 y Fl(2)38 b(Com)o(binator)13 b(parsers)997 b
Fq(4)162 467 y(2.1)41 b(The)15 b(t)o(yp)q(e)f(of)f(parsers)964
b(4)162 521 y(2.2)41 b(Primitiv)o(e)12 b(parsers)1007 b(4)162
575 y(2.3)41 b(P)o(arser)15 b(com)o(binators)965 b(5)100 629
y Fl(3)38 b(P)o(arsers)14 b(and)h(monads)990 b Fq(8)162 683
y(3.1)41 b(The)15 b(parser)g(monad)981 b(8)162 737 y(3.2)41
b(Monad)14 b(comprehension)g(syn)o(tax)755 b(10)100 791 y Fl(4)38
b(Com)o(binators)13 b(for)i(rep)q(etition)825 b Fq(12)162 845
y(4.1)41 b(Simple)12 b(rep)q(etition)984 b(13)162 899 y(4.2)41
b(Rep)q(etition)14 b(with)g(separators)812 b(14)162 953 y(4.3)41
b(Rep)q(etition)14 b(with)g(meaningful)d(separators)599 b(15)100
1007 y Fl(5)38 b(E\016ciency)15 b(of)h(parsers)970 b Fq(18)162
1061 y(5.1)41 b(Left)14 b(factoring)1048 b(19)162 1115 y(5.2)41
b(Impro)o(ving)12 b(laziness)960 b(19)162 1169 y(5.3)41 b(Limiting)11
b(the)k(n)o(um)o(b)q(er)e(of)g(results)740 b(20)100 1222 y
Fl(6)38 b(Handling)13 b(lexical)i(issues)917 b Fq(22)162 1276
y(6.1)41 b(White-space,)15 b(commen)o(ts,)c(and)j(k)o(eyw)o(ords)594
b(22)162 1330 y(6.2)41 b(A)14 b(parser)h(for)f Fh(\025)p Fq(-expressions)823
b(24)100 1384 y Fl(7)38 b(F)l(actorising)13 b(the)i(parser)g(monad)777
b Fq(24)162 1438 y(7.1)41 b(The)15 b(exception)f(monad)901
b(25)162 1492 y(7.2)41 b(The)15 b(non-determinism)c(monad)768
b(26)162 1546 y(7.3)41 b(The)15 b(state-transformer)f(monad)759
b(27)162 1600 y(7.4)41 b(The)15 b(parameterised)f(state-transformer)g(monad)
491 b(28)162 1654 y(7.5)41 b(The)15 b(parser)g(monad)d(revisited)796
b(29)100 1708 y Fl(8)38 b(Handling)13 b(the)i(o\013side)f(rule)871
b Fq(30)162 1762 y(8.1)41 b(The)15 b(o\013side)f(rule)1013
b(30)162 1816 y(8.2)41 b(Mo)q(difying)13 b(the)h(t)o(yp)q(e)h(of)e(parsers)
759 b(31)162 1870 y(8.3)41 b(The)15 b(parameterised)f(state-reader)h(monad)
590 b(32)162 1924 y(8.4)41 b(The)15 b(new)f(parser)h(com)o(binators)778
b(33)100 1978 y Fl(9)38 b(Ac)o(kno)o(wledgemen)o(t)o(s)992
b Fq(36)100 2032 y Fl(10)14 b(App)q(endix:)g(a)i(parser)f(for)g(data)g
(de\014nition)o(s)573 b Fq(36)100 2086 y Fl(References)1227
b Fq(37)p eop
%%Page: 3 3
3 2 bop 575 178 a Fi(Monadic)16 b(Parser)e(Combinators)461
b Fq(3)691 278 y Fl(1)24 b(In)o(tro)q(duction)100 397 y Fq(In)9
b(functional)f(programming,)d(a)k(p)q(opular)g(approac)o(h)g(to)g(building)f
(recursiv)o(e)j(descen)o(t)g Fi(p)n(arsers)100 451 y Fq(is)i(to)h(mo)q(del)e
(parsers)k(as)e(functions,)f(and)h(to)f(de\014ne)i(higher-order)g(functions)f
(\(or)g Fi(c)n(ombina-)100 505 y(tors)s Fq(\))f(that)g(implemen)o(t)e(gramma)
o(r)g(constructions)j(suc)o(h)g(as)g(sequencing,)f(c)o(hoice,)h(and)f(rep)q
(e-)100 559 y(tition.)c(The)j(basic)f(idea)g(dates)h(bac)o(k)f(to)f(at)h
(least)h(Burge's)f(b)q(o)q(ok)g(on)g(recursiv)o(e)i(programmi)o(ng)100
613 y(tec)o(hniques)i(\(Burge,)f(1975\),)e(and)i(has)g(b)q(een)g(p)q
(opularised)g(in)f(functional)g(programming)d(b)o(y)100 667
y(W)m(adler)15 b(\(1985\),)f(Hutton)i(\(1992\),)e(F)m(okk)o(er)i(\(1995\),)e
(and)i(others.)g(Com)o(binators)e(pro)o(vide)h(a)100 721 y(quic)o(k)10
b(and)g(easy)g(metho)q(d)g(of)g(building)f(functional)g(parsers.)i(Moreo)o(v)
o(er,)g(the)f(metho)q(d)g(has)g(the)100 775 y(adv)n(an)o(tage)f(o)o(v)o(er)i
(functional)e(parser)j(generators)g(suc)o(h)f(as)g(Ratatosk)e(\(Mogensen,)j
(1993\))d(and)100 829 y(Happ)o(y)k(\(Gill)g(&)h(Marlo)o(w,)f(1995\))g(that)h
(one)g(has)h(the)f(full)f(p)q(o)o(w)o(er)i(of)e(a)h(functional)f(language)100
883 y(a)o(v)n(ailable)e(to)j(de\014ne)h(new)f(com)o(binators)f(for)g(sp)q
(ecial)h(applications)f(\(Landin,)g(1966\).)141 974 y(It)f(w)o(as)f(realised)
h(early)f(on)h(\(W)m(adler,)e(1990\))g(that)i(parsers)h(form)d(an)h(instance)
h(of)f(a)g Fi(monad)t Fq(,)100 1028 y(an)16 b(algebraic)h(structure)i(from)c
(mathematics)g(that)i(has)h(pro)o(v)o(ed)f(useful)g(for)g(addressing)g(a)100
1082 y(n)o(um)o(b)q(er)h(of)h(computational)e(problems)h(\(Moggi,)g(1989;)g
(W)m(adler,)g(1990;)g(W)m(adler,)g(1992a;)100 1136 y(W)m(adler,)d(1992b\).)h
(As)h(w)o(ell)g(as)g(b)q(eing)g(in)o(teresting)g(from)e(a)i(mathematical)d(p)
q(oin)o(t)i(of)h(view,)100 1190 y(recognising)c(the)h(monadic)d(nature)j(of)f
(parsers)i(also)d(brings)i(practical)f(b)q(ene\014ts.)i(F)m(or)d(exam-)100
1244 y(ple,)k(using)g(a)g(monadic)f(sequencing)i(com)o(binator)e(for)h
(parsers)i(a)o(v)o(oids)e(the)h(messy)f(manip-)100 1298 y(ulation)e(of)h
(nested)i(tuples)f(of)e(results)j(presen)o(t)g(in)e(earlier)h(w)o(ork.)e
(Moreo)o(v)o(er,)i(using)f Fi(monad)100 1352 y(c)n(ompr)n(ehension)i
Fq(notation)c(mak)o(es)g(parsers)j(more)c(compact)h(and)h(easier)h(to)f
(read.)141 1444 y(T)m(aking)e(the)j(monadic)c(approac)o(h)j(further,)g(the)g
(monad)e(of)h(parsers)i(can)f(b)q(e)g(expressed)i(in)100 1498
y(a)d(mo)q(dular)f(w)o(a)o(y)h(in)g(terms)g(of)g(t)o(w)o(o)g(simpler)g
(monads.)e(The)k(imm)o(ediate)c(b)q(ene\014t)k(is)f(that)f(the)100
1552 y(basic)f(parser)i(com)o(binators)e(no)g(longer)h(need)g(to)g(b)q(e)g
(de\014ned)h(explicitly)m(.)d(Rather,)h(they)i(arise)100 1606
y(automatically)e(as)j(a)h(sp)q(ecial)f(case)i(of)d(lifting)g(monad)g(op)q
(erations)h(from)f(a)h(base)h(monad)e Fh(m)100 1660 y Fq(to)e(a)g(certain)h
(other)g(monad)d(parameterised)j(o)o(v)o(er)f Fh(m)p Fq(.)g(This)g(also)g
(means)g(that,)g(if)f(w)o(e)i(c)o(hange)100 1714 y(the)i(nature)h(of)f
(parsers)h(b)o(y)f(mo)q(difying)d(the)k(base)f(monad)f(\(for)g(example,)g
(limiting)d(parsers)100 1768 y(to)h(pro)q(ducing)i(at)e(most)g(one)h
(result\),)h(then)g(new)f(com)o(binators)f(for)g(the)i(mo)q(di\014ed)d(monad)
h(of)100 1822 y(parsers)j(also)e(arise)h(automatically)d(via)i(the)i(lifting)
d(construction.)141 1913 y(The)k(purp)q(ose)g(of)f(this)g(article)g(is)g(to)g
(pro)o(vide)g(a)g(step-b)o(y-step)i(tutorial)d(on)h(the)h(monadic)100
1967 y(approac)o(h)g(to)g(building)f(functional)g(parsers,)i(and)f(to)g
(explain)f(some)h(of)f(the)i(b)q(ene\014ts)h(that)100 2021
y(result)13 b(from)f(exploiting)g(monads.)f(Muc)o(h)i(of)g(the)h(material)d
(is)i(already)f(kno)o(wn.)g(Our)i(con)o(tri-)100 2075 y(butions)e(are)h(the)g
(organisation)f(of)g(the)h(material)e(in)o(to)h(a)g(tutorial)g(article;)g
(the)h(in)o(tro)q(duction)100 2129 y(of)g(new)h(com)o(binators)e(for)h
(handling)g(lexical)g(issues)h(without)g(a)f(separate)i(lexer;)f(and)f(a)h
(new)100 2183 y(approac)o(h)f(to)h(implemen)o(ting)d(the)j(o\013side)g(rule,)
g(inspired)g(b)o(y)g(the)g(use)h(of)e(monads.)141 2275 y(Some)f(prior)g(exp)q
(osure)i(to)f(functional)f(programmi)o(ng)e(w)o(ould)i(b)q(e)h(helpful)f(in)g
(reading)h(this)100 2329 y(article,)d(but)h(sp)q(ecial)g(features)g(of)g
(Gofer)f(\(Jones,)h(1995b\))f(|)g(our)h(implemen)o(tati)o(on)d(language)100
2383 y(|)i(are)i(explained)f(as)h(they)f(are)h(used.)g(An)o(y)f(other)h(lazy)
f(functional)f(language)g(that)i(supp)q(orts)100 2437 y(\(m)o(ulti-param)o
(eter\))c(constructor)j(classes)g(and)e(the)h(use)h(of)e(monad)e
(comprehension)j(notation)100 2491 y(w)o(ould)19 b(do)g(equally)g(w)o(ell.)g
(No)g(prior)h(kno)o(wledge)g(of)f(parser)i(com)o(binators)d(or)i(monads)e(is)
100 2545 y(assumed.)11 b(Indeed,)i(this)f(article)g(can)g(also)g(b)q(e)h
(view)o(ed)f(as)g(a)g(\014rst)h(in)o(tro)q(duction)f(to)g(the)h(use)g(of)100
2599 y(monads)f(in)h(programmi)o(ng.)d(A)j(library)g(of)g(monadic)e(parser)k
(com)o(binators)d(tak)o(en)h(from)f(this)100 2653 y(article)i(is)f(a)o(v)n
(ailable)f(from)g(the)j(authors,)e(via)g(the)i(W)m(orld-Wide-W)m(eb.)p
eop
%%Page: 4 4
4 3 bop 100 178 a Fq(4)441 b Fi(Gr)n(aham)14 b(Hutton)i(and)f(Erik)g(Meijer)
617 278 y Fl(2)23 b(Com)o(binator)14 b(parsers)100 359 y Fq(W)m(e)9
b(b)q(egin)i(b)o(y)f(reviewing)g(the)h(basic)f(ideas)g(of)g(com)o(binator)e
(parsing)i(\(W)m(adler,)f(1985;)g(Hutton,)100 413 y(1992;)17
b(F)m(okk)o(er,)i(1995\).)f(In)h(particular,)f(w)o(e)i(de\014ne)g(a)f(t)o(yp)
q(e)h(for)e(parsers,)j(three)f(primitiv)o(e)100 467 y(parsers,)15
b(and)e(t)o(w)o(o)h(primitiv)o(e)d(com)o(binators)i(for)g(building)g(larger)h
(parsers.)599 602 y Fg(2.1)24 b(The)17 b(typ)n(e)f(of)h(p)n(arsers)100
683 y Fq(Let)12 b(us)f(start)i(b)o(y)e(thinking)f(of)h(a)g(parser)i(as)e(a)h
(function)f(that)g(tak)o(es)h(a)f(string)h(of)f(c)o(haracters)i(as)100
737 y(input)f(and)h(yields)f(some)g(kind)h(of)f(tree)i(as)f(result,)g(with)f
(the)i(in)o(ten)o(tion)e(that)h(the)g(tree)h(mak)o(es)100 791
y(explicit)f(the)i(gramma)o(tical)c(structure)16 b(of)d(the)h(string:)165
872 y Ff(type)21 b(Parser)g(=)g(String)g(->)g(Tree)100 953
y Fq(In)16 b(general,)g(ho)o(w)o(ev)o(er,)g(a)g(parser)h(migh)o(t)d(not)i
(consume)g(all)f(of)g(its)h(input)g(string,)g(so)g(rather)100
1007 y(than)e(the)g(result)h(of)f(a)g(parser)h(b)q(eing)f(just)g(a)g(tree,)h
(w)o(e)g(also)e(return)i(the)g(unconsumed)f(su\016x)100 1061
y(of)f(the)h(input)g(string.)g(Th)o(us)g(w)o(e)g(mo)q(dify)d(our)j(t)o(yp)q
(e)h(of)e(parsers)i(as)f(follo)o(ws:)165 1142 y Ff(type)21
b(Parser)g(=)g(String)g(->)g(\(Tree,String\))141 1222 y Fq(Similarly)l(,)14
b(a)j(parser)h(migh)o(t)e(fail)f(on)i(its)h(input)f(string.)f(Rather)i(than)f
(just)h(rep)q(orting)f(a)100 1276 y(run-time)h(error)j(if)e(this)h(happ)q
(ens,)g(w)o(e)g(c)o(ho)q(ose)g(to)g(ha)o(v)o(e)f(parsers)i(return)g(a)f(list)
f(of)g(pairs)100 1330 y(rather)13 b(than)g(a)f(single)g(pair,)g(with)g(the)i
(con)o(v)o(en)o(tion)e(that)h(the)g(empt)o(y)f(list)g(denotes)i(failure)e(of)
100 1384 y(a)h(parser,)i(and)e(a)h(singleton)g(list)f(denotes)i(success:)165
1465 y Ff(type)21 b(Parser)g(=)g(String)g(->)g([\(Tree,String\)])141
1546 y Fq(Ha)o(ving)14 b(an)h(explicit)g(represen)o(tation)h(of)f(failure)f
(and)h(returning)g(the)h(unconsumed)f(part)100 1600 y(of)e(the)i(input)g
(string)f(mak)o(es)g(it)g(p)q(ossible)g(to)h(de\014ne)g(com)o(binators)e(for)
h(building)f(up)h(parsers)100 1654 y(piecewise)h(from)e(smaller)g(parsers.)j
(Returning)e(a)g(list)g(of)g(results)i(op)q(ens)f(up)g(the)g(p)q(ossibilit)o
(y)100 1708 y(of)g(returning)i(more)e(than)h(one)h(result)g(if)e(the)i(input)
f(string)g(can)g(b)q(e)h(parsed)g(in)f(more)f(than)100 1762
y(one)f(w)o(a)o(y)m(,)e(whic)o(h)i(ma)o(y)e(b)q(e)i(the)h(case)g(if)e(the)h
(underlying)g(gramma)o(r)d(is)j(am)o(biguous.)141 1816 y(Finally)m(,)e
(di\013eren)o(t)k(parsers)g(will)e(lik)o(ely)f(return)j(di\013eren)o(t)g
(kinds)f(of)f(trees,)i(so)f(it)f(is)h(useful)100 1870 y(to)g(abstract)i(on)f
(the)g(sp)q(eci\014c)h(t)o(yp)q(e)g Ff(Tree)e Fq(of)g(trees,)i(and)e(mak)o(e)
g(the)h(t)o(yp)q(e)g(of)g(result)g(v)n(alues)100 1924 y(in)o(to)d(a)g
(parameter)h(of)f(the)i Ff(Parser)d Fq(t)o(yp)q(e:)165 2005
y Ff(type)21 b(Parser)g(a)g(=)h(String)e(->)i([\(a,String\)])100
2086 y Fq(This)15 b(is)g(the)h(t)o(yp)q(e)g(of)f(parsers)i(w)o(e)f(will)e
(use)i(in)f(the)i(remainder)d(of)h(this)h(article.)f(One)h(could)100
2140 y(go)d(further)i(\(as)f(in)g(\(Hutton,)g(1992\),)f(for)g(example\))g
(and)h(abstract)h(up)q(on)f(the)h(t)o(yp)q(e)f Ff(String)100
2194 y Fq(of)f(tok)o(ens,)h(but)g(w)o(e)g(do)g(not)f(ha)o(v)o(e)h(need)h(for)
f(this)g(generalisation)f(here.)620 2329 y Fg(2.2)23 b(Primitive)17
b(p)n(arsers)100 2410 y Fq(The)e(three)h(primitiv)o(e)c(parsers)k(de\014ned)g
(in)e(this)h(section)g(are)g(the)h(building)d(blo)q(c)o(ks)h(of)g(com-)100
2464 y(binator)h(parsing.)h(The)g(\014rst)h(parser)h(is)e Ff(result)k(v)p
Fq(,)c(whic)o(h)g(succeeds)j(without)c(consuming)100 2518 y(an)o(y)e(of)g
(the)i(input)f(string,)f(and)h(returns)h(the)g(single)e(result)i
Ff(v)p Fq(:)165 2599 y Ff(result)42 b(::)22 b(a)f(->)h(Parser)e(a)165
2653 y(result)h(v)g(=)h(\\inp)f(->)g([\(v,inp\)])p eop
%%Page: 5 5
5 4 bop 575 178 a Fi(Monadic)16 b(Parser)e(Combinators)461
b Fq(5)100 278 y(An)13 b(expression)h(of)e(the)i(form)d Ff(\\x)22
b(->)f(e)13 b Fq(is)g(called)g(a)f Fh(\025)p Fq(-abstraction,)h(and)g
(denotes)h(the)g(func-)100 332 y(tion)k(that)h(tak)o(es)h(an)f(argumen)o(t)f
Ff(x)h Fq(and)g(returns)h(the)g(v)n(alue)f(of)f(the)i(expression)g
Ff(e)p Fq(.)f(Th)o(us)100 386 y Ff(result)h(v)e Fq(is)g(the)h(function)f
(that)h(tak)o(es)f(an)g(input)h(string)f Ff(inp)g Fq(and)g(returns)i(the)e
(single-)100 440 y(ton)d(list)g Ff([\(v,inp\)])p Fq(.)e(This)i(function)g
(could)g(equally)f(w)o(ell)h(b)q(e)h(de\014ned)g(b)o(y)g Ff(result)k(v)i(inp)
100 494 y(=)f([\(v,inp\)])p Fq(,)16 b(but)i(w)o(e)h(prefer)g(the)g(ab)q(o)o
(v)o(e)f(de\014nition)g(\(in)g(whic)o(h)g(the)h(argumen)o(t)e
Ff(inp)g Fq(is)100 548 y(sh)o(un)o(ted)f(to)g(the)g(b)q(o)q(dy)g(of)f(the)i
(de\014nition\))e(b)q(ecause)j(it)d(corresp)q(onds)j(more)d(closely)h(to)f
(the)100 602 y(t)o(yp)q(e)c Ff(result)20 b(::)h(a)h(->)f(Parser)g(a)p
Fq(,)10 b(whic)o(h)g(asserts)i(that)e Ff(result)g Fq(is)g(a)g(function)g
(that)h(tak)o(es)100 656 y(a)i(single)h(argumen)o(t)f(and)g(returns)j(a)d
(parser.)141 710 y(Dually)m(,)f(the)i(parser)h Ff(zero)e Fq(alw)o(a)o(ys)g
(fails,)f(regardless)j(of)e(the)i(input)f(string:)165 784 y
Ff(zero)21 b(::)g(Parser)g(a)165 837 y(zero)43 b(=)21 b(\\inp)g(->)h([])141
911 y Fq(Our)13 b(\014nal)f(primitiv)o(e)e(is)j Ff(item)p Fq(,)e(whic)o(h)h
(successfully)i(consumes)e(the)i(\014rst)f(c)o(haracter)h(if)d(the)100
965 y(input)i(string)h(is)g(non-empt)o(y)m(,)e(and)h(fails)g(otherwise:)165
1039 y Ff(item)21 b(::)g(Parser)g(Char)165 1093 y(item)43 b(=)21
b(\\inp)g(->)h(case)f(inp)g(of)579 1147 y([])109 b(->)21 b([])579
1201 y(\(x:xs\))g(->)g([\(x,xs\)])597 1328 y Fg(2.3)i(Parser)17
b(c)n(ombinators)100 1406 y Fq(The)10 b(primitiv)o(e)e(parsers)k(de\014ned)f
(ab)q(o)o(v)o(e)f(are)g(not)g(v)o(ery)g(useful)h(in)e(themselv)o(es.)h(In)g
(this)g(section)100 1460 y(w)o(e)15 b(consider)g(ho)o(w)g(they)g(can)g(b)q(e)
g(glued)g(together)h(to)e(form)f(more)h(useful)h(parsers.)h(W)m(e)e(tak)o(e)
100 1514 y(our)j(lead)g(from)f(the)i(BNF)g(notation)f(for)g(sp)q(ecifying)g
(grammars,)d(in)j(whic)o(h)g(larger)h(gram-)100 1568 y(mars)11
b(are)j(built)e(up)g(piecewise)i(from)d(smaller)h(gramma)o(rs)f(using)h(a)h
Fi(se)n(quencing)k Fq(op)q(erator)d(|)100 1622 y(denoted)h(b)o(y)g(juxtap)q
(osition)f(|)g(and)g(a)h Fi(choic)n(e)j Fq(op)q(erator)d(|)g(denoted)g(b)o(y)
g(a)g(v)o(ertical)f(bar)h Fe(j)p Fq(.)100 1676 y(W)m(e)g(de\014ne)h(corresp)q
(onding)h(op)q(erators)g(for)e(com)o(bining)e(parsers,)k(suc)o(h)f(that)g
(the)g(structure)100 1730 y(of)d(our)h(parsers)h(closely)f(follo)o(ws)e(the)j
(structure)h(of)d(the)i(underlying)e(grammars.)141 1784 y(In)g(earlier)h
(\(non-monadic\))d(accoun)o(ts)j(of)e(com)o(binator)g(parsing)h(\(W)m(adler,)
f(1985;)f(Hutton,)100 1838 y(1992;)h(F)m(okk)o(er,)h(1995\),)g(sequencing)i
(of)e(parsers)i(w)o(as)f(usually)f(captured)i(b)o(y)f(a)f(com)o(binator)165
1912 y Ff(seq)130 b(::)22 b(Parser)e(a)i(->)f(Parser)g(b)g(->)h(Parser)e
(\(a,b\))165 1966 y(p)i(`seq`)e(q)i(=)g(\\inp)e(->)i([\(\(v,w\),inp''\))d(|)i
(\(v,inp'\))42 b(<-)22 b(p)f(inp)928 2020 y(,)g(\(w,inp''\))f(<-)i(q)f(inp'])
100 2093 y Fq(that)15 b(applies)g(one)g(parser)i(after)e(another,)g(with)g
(the)h(results)g(from)e(the)i(t)o(w)o(o)e(parsers)j(b)q(eing)100
2147 y(com)o(bined)9 b(as)h(pairs.)f(The)i(in\014x)f(notation)f
Ff(p)22 b(`seq`)e(q)10 b Fq(is)g(syn)o(tactic)h(sugar)f(for)g
Ff(seq)21 b(p)h(q)p Fq(;)9 b(an)o(y)100 2201 y(function)15
b(of)f(t)o(w)o(o)h(argumen)o(ts)g(can)g(used)i(as)e(an)g(in\014x)g(op)q
(erator)h(in)f(this)g(w)o(a)o(y)m(,)f(b)o(y)h(enclosing)100
2255 y(its)i(name)e(in)i(bac)o(kquotes.)g(A)o(t)g(\014rst)g(sigh)o(t,)g(the)g
Ff(seq)f Fq(com)o(binator)f(migh)o(t)g(seem)i(a)f(natural)100
2309 y(comp)q(osition)11 b(primitiv)o(e.)f(In)i(practice,)i(ho)o(w)o(ev)o
(er,)f(using)f Ff(seq)g Fq(leads)h(to)g(parsers)h(with)e(nested)100
2363 y(tuples)i(as)g(results,)h(whic)o(h)e(are)i(messy)e(to)h(manipulate.)141
2417 y(The)g(problem)e(of)h(nested)i(tuples)f(can)f(b)q(e)h(a)o(v)o(oided)f
(b)o(y)g(adopting)f(a)h Fi(monadic)k Fq(sequencing)100 2471
y(com)o(binator)11 b(\(commonly)g(kno)o(wn)i(as)g Ff(bind)p
Fq(\))g(whic)o(h)h(in)o(tegrates)g(the)g(sequencing)h(of)d(parsers)100
2525 y(with)h(the)i(pro)q(cessing)g(of)e(their)h(result)h(v)n(alues:)165
2599 y Ff(bind)130 b(::)21 b(Parser)g(a)g(->)h(\(a)f(->)h(Parser)e(b\))i(->)f
(Parser)f(b)165 2653 y(p)i(`bind`)e(f)i(=)f(\\inp)g(->)h(concat)e([f)i(v)f
(inp')g(|)h(\(v,inp'\))e(<-)h(p)h(inp])p eop
%%Page: 6 6
6 5 bop 100 178 a Fq(6)441 b Fi(Gr)n(aham)14 b(Hutton)i(and)f(Erik)g(Meijer)
100 278 y Fq(The)h(de\014nition)g(for)g Ff(bind)g Fq(can)h(b)q(e)g(in)o
(terpreted)h(as)e(follo)o(ws.)e(First)j(of)f(all,)f(the)i(parser)g
Ff(p)f Fq(is)100 332 y(applied)e(to)h(the)h(input)e(string,)h(yielding)f(a)g
(list)h(of)f(\(v)n(alue,string\))h(pairs.)f(No)o(w)h(since)h
Ff(f)e Fq(is)h(a)100 386 y(function)h(that)h(tak)o(es)g(a)f(v)n(alue)g(and)h
(returns)h(a)e(parser,)h(it)g(can)g(b)q(e)g(applied)f(to)g(eac)o(h)i(v)n
(alue)100 440 y(\(and)11 b(unconsumed)g(input)g(string\))g(in)g(turn.)g(This)
g(results)h(in)f(a)g(list)g(of)f(lists)h(of)g(\(v)n(alue,string\))100
494 y(pairs,)i(that)h(can)g(then)h(b)q(e)f(\015attened)h(to)f(a)f(single)h
(list)f(using)h Ff(concat)p Fq(.)141 548 y(The)g Ff(bind)f
Fq(com)o(binator)f(a)o(v)o(oids)h(the)i(problem)d(of)i(nested)h(tuples)g(of)e
(results)i(b)q(ecause)g(the)100 602 y(results)g(of)f(the)h(\014rst)g(parser)h
(are)e(made)g(directly)g(a)o(v)n(ailable)f(for)h(pro)q(cessing)h(b)o(y)f(the)
h(second,)100 656 y(rather)20 b(than)f(b)q(eing)h(paired)f(up)g(with)g(the)h
(other)g(results)h(to)e(b)q(e)h(pro)q(cessed)i(later)d(on.)g(A)100
710 y(t)o(ypical)13 b(parser)i(built)e(using)g Ff(bind)g Fq(has)i(the)f
(follo)o(wing)d(structure)165 795 y Ff(p1)21 b(`bind`)g(\\x1)g(->)165
849 y(p2)g(`bind`)g(\\x2)g(->)165 903 y(...)165 957 y(pn)g(`bind`)g(\\xn)g
(->)165 1011 y(result)g(\(f)g(x1)g(x2)h(...)f(xn\))100 1095
y Fq(and)15 b(can)g(b)q(e)h(read)f(op)q(erationally)f(as)i(follo)o(ws:)d
(apply)h(parser)i Ff(p1)f Fq(and)g(call)f(its)i(result)g(v)n(alue)100
1149 y Ff(x1)p Fq(;)d(then)i(apply)e(parser)j Ff(p2)d Fq(and)h(call)g(its)g
(result)h(v)n(alue)f Ff(x2)p Fq(;)f Fh(:)7 b(:)g(:)n Fq(;)14
b(then)h(apply)e(the)i(parser)g Ff(pn)100 1203 y Fq(and)g(call)f(its)i
(result)g(v)n(alue)f Ff(xn)p Fq(;)f(and)h(\014nally)m(,)e(com)o(bine)h(all)g
(the)i(results)h(in)o(to)e(a)g(single)g(v)n(alue)100 1257 y(b)o(y)e(applying)
g(the)h(function)g Ff(f)p Fq(.)f(F)m(or)h(example,)e(the)i
Ff(seq)f Fq(com)o(binator)f(can)i(b)q(e)h(de\014ned)g(b)o(y)165
1342 y Ff(p)22 b(`seq`)e(q)i(=)g(p)f(`bind`)g(\\x)g(->)427
1396 y(q)g(`bind`)g(\\y)g(->)427 1450 y(result)f(\(x,y\))100
1534 y Fq(\(On)14 b(the)g(other)h(hand,)e Ff(bind)g Fq(cannot)h(b)q(e)h
(de\014ned)g(in)e(terms)h(of)f Ff(seq)p Fq(.\))141 1589 y(Using)k(the)h
Ff(bind)f Fq(com)o(binator,)e(w)o(e)i(are)h(no)o(w)f(able)g(to)g(de\014ne)h
(some)f(simple)e(but)j(useful)100 1643 y(parsers.)12 b(Recall)f(that)g(the)h
Ff(item)f Fq(parser)h(consumes)f(a)h(single)f(c)o(haracter)h(unconditionally)
m(.)d(In)100 1697 y(practice,)15 b(w)o(e)g(are)g(normally)d(only)i(in)o
(terested)i(in)e(consuming)f(certain)j(sp)q(eci\014c)g(c)o(haracters.)100
1751 y(F)m(or)e(this)h(reason,)g(w)o(e)g(use)h Ff(item)d Fq(to)i(de\014ne)h
(a)e(com)o(binator)f Ff(sat)i Fq(that)f(tak)o(es)i(a)e(predicate)i(\(a)100
1805 y(Bo)q(olean)c(v)n(alued)g(function\),)g(and)h(yields)g(a)f(parser)i
(that)f(consumes)f(a)h(single)f(c)o(haracter)i(if)e(it)100
1859 y(satis\014es)j(the)f(predicate,)h(and)e(fails)g(otherwise:)165
1943 y Ff(sat)43 b(::)21 b(\(Char)g(->)g(Bool\))g(->)h(Parser)e(Char)165
1997 y(sat)h(p)h(=)f(item)g(`bind`)g(\\x)g(->)339 2051 y(if)h(p)f(x)h(then)f
(result)f(x)i(else)f(zero)100 2136 y Fq(Note)16 b(that)f(if)g
Ff(item)f Fq(fails)g(\(that)i(is,)f(if)g(the)h(input)f(string)g(is)h(empt)o
(y\),)e(then)i(so)f(do)q(es)i Ff(sat)k(p)p Fq(,)100 2190 y(since)14
b(it)g(can)g(readily)g(b)q(e)g(observ)o(ed)h(that)g Ff(zero)20
b(`bind`)h(f)h(=)f(zero)13 b Fq(for)h(all)f(functions)h Ff(f)g
Fq(of)100 2244 y(the)j(appropriate)f(t)o(yp)q(e.)h(Indeed,)g(this)f(equation)
g(is)h(not)f(sp)q(eci\014c)i(to)e(parsers:)i(it)e(holds)g(for)100
2298 y(an)c(arbitrary)h Fi(monad)i(with)e(a)h(zer)n(o)e Fq(\(W)m(adler,)g
(1992a;)f(W)m(adler,)h(1992b\).)f(Monads)i(and)g(their)100
2352 y(connection)h(to)g(parsers)h(will)e(b)q(e)h(discussed)i(in)d(the)i
(next)f(section.)141 2406 y(Using)g Ff(sat)p Fq(,)g(w)o(e)h(can)f(de\014ne)i
(parsers)g(for)e(sp)q(eci\014c)i(c)o(haracters,)g(single)e(digits,)f(lo)o(w)o
(er-case)100 2460 y(letters,)h(and)g(upp)q(er-case)i(letters:)165
2545 y Ff(char)43 b(::)21 b(Char)g(->)g(Parser)g(Char)165 2599
y(char)g(x)h(=)f(sat)g(\(\\y)g(->)h(x)f(==)h(y\))p eop
%%Page: 7 7
7 6 bop 575 178 a Fi(Monadic)16 b(Parser)e(Combinators)461
b Fq(7)165 278 y Ff(digit)21 b(::)g(Parser)g(Char)165 332 y(digit)43
b(=)21 b(sat)g(\(\\x)g(->)h('0')f(<=)g(x)h(&&)f(x)h(<=)f('9'\))165
440 y(lower)g(::)g(Parser)g(Char)165 494 y(lower)43 b(=)21
b(sat)g(\(\\x)g(->)h('a')f(<=)g(x)h(&&)f(x)h(<=)f('z'\))165
602 y(upper)g(::)g(Parser)g(Char)165 656 y(upper)43 b(=)21
b(sat)g(\(\\x)g(->)h('A')f(<=)g(x)h(&&)f(x)h(<=)f('Z'\))100
737 y Fq(F)m(or)12 b(example,)g(applying)g(the)i(parser)g Ff(upper)e
Fq(to)h(the)h(input)f(string)h Ff("Hello")d Fq(succeeds)16
b(with)100 791 y(the)f(single)f(successful)i(result)f Ff([\('H',"ello"\)])p
Fq(,)c(since)k(the)g Ff(upper)e Fq(parser)i(succeeds)i(with)100
845 y Ff('H')c Fq(as)i(the)g(result)g(v)n(alue)e(and)i Ff("ello")e
Fq(as)h(the)h(unconsumed)f(su\016x)g(of)g(the)h(input.)f(On)g(the)100
899 y(other)i(hand,)f(applying)g(the)h(parser)h Ff(lower)e
Fq(to)h(the)g(string)g Ff("Hello")f Fq(fails)f(with)i Ff([])f
Fq(as)h(the)100 953 y(result,)e(since)h Ff('H')e Fq(is)g(not)h(a)g(lo)o(w)o
(er-case)g(letter.)141 1007 y(As)d(another)f(example)f(of)g(using)h
Ff(bind)p Fq(,)f(consider)h(the)h(parser)g(that)f(accepts)i(t)o(w)o(o)d(lo)o
(w)o(er-case)100 1061 y(letters)15 b(in)e(sequence,)j(returning)e(a)g(string)
g(of)f(length)h(t)o(w)o(o:)165 1142 y Ff(lower)21 b(`bind`)f(\\x)i(->)165
1196 y(lower)f(`bind`)f(\\y)i(->)165 1249 y(result)f([x,y])100
1330 y Fq(Applying)11 b(this)h(parser)h(to)f(the)h(string)f
Ff("abcd")f Fq(succeeds)k(with)d(the)g(result)h Ff([\("ab","cd"\)])p
Fq(.)100 1384 y(Applying)g(the)i(same)e(parser)j(to)e Ff("aBcd")f
Fq(fails)g(with)i(the)f(result)i Ff([])p Fq(,)d(b)q(ecause)j(ev)o(en)f
(though)100 1438 y(the)d(initial)e(letter)j Ff('a')e Fq(can)h(b)q(e)g
(consumed)g(b)o(y)f(the)i(\014rst)f Ff(lower)f Fq(parser,)h(the)h(follo)o
(wing)c(letter)100 1492 y Ff('B')k Fq(cannot)h(b)q(e)g(consumed)g(b)o(y)g
(the)g(second)h Ff(lower)e Fq(parser.)141 1546 y(Of)j(course,)i(the)f(ab)q(o)
o(v)o(e)f(parser)h(for)f(t)o(w)o(o)g(letters)i(in)e(sequence)i(can)f(b)q(e)g
(generalised)g(to)f(a)100 1600 y(parser)h(for)f(arbitrary)g(strings)h(of)f
(lo)o(w)o(er-case)h(letters.)g(Since)g(the)g(length)f(of)g(the)h(string)f(to)
100 1654 y(b)q(e)f(parsed)i(cannot)e(b)q(e)h(predicted)g(in)f(adv)n(ance,)g
(suc)o(h)h(a)f(parser)h(will)e(naturally)g(b)q(e)i(de\014ned)100
1708 y(recursiv)o(ely)m(,)g(using)h(a)f(c)o(hoice)i(op)q(erator)f(to)f
(decide)i(b)q(et)o(w)o(een)g(parsing)f(a)f(single)g(letter)i(and)100
1762 y(recursing,)11 b(or)g(parsing)g(nothing)f(further)i(and)f(terminating.)
e(A)i(suitable)f(c)o(hoice)i(com)o(binator)100 1816 y(for)h(parsers,)i
Ff(plus)p Fq(,)e(is)g(de\014ned)i(as)f(follo)o(ws:)165 1897
y Ff(plus)152 b(::)21 b(Parser)g(a)g(->)h(Parser)e(a)i(->)f(Parser)g(a)165
1951 y(p)h(`plus`)e(q)44 b(=)21 b(\\inp)g(->)g(\(p)h(inp)f(++)g(q)h(inp\))100
2032 y Fq(That)14 b(is,)g(b)q(oth)h(argumen)o(t)f(parsers)i
Ff(p)e Fq(and)h Ff(q)f Fq(are)h(applied)g(to)f(the)h(same)f(input)h(string,)f
(and)100 2086 y(their)j(result)g(lists)g(are)g(concatenated)i(to)d(form)f(a)i
(single)f(result)i(list.)e(Note)h(that)g(it)f(is)h(not)100
2140 y(required)i(that)g Ff(p)f Fq(and)h Ff(q)f Fq(accept)i(disjoin)o(t)e
(sets)i(of)e(strings:)h(if)e(b)q(oth)i(parsers)h(succeed)h(on)100
2194 y(the)d(input)f(string)h(then)g(more)e(than)i(one)g(result)g(v)n(alue)f
(will)f(b)q(e)i(returned,)h(re\015ecting)f(the)100 2248 y(di\013eren)o(t)c(w)
o(a)o(ys)g(that)g(the)g(input)g(string)g(can)g(b)q(e)h(parsed.)141
2302 y(As)g(examples)f(of)g(using)g Ff(plus)p Fq(,)f(some)h(of)g(our)g
(earlier)h(parsers)h(can)f(no)o(w)f(b)q(e)h(com)o(bined)e(to)100
2356 y(giv)o(e)g(parsers)i(for)f(letters)h(and)f(alpha-n)o(umeric)e(c)o
(haracters:)165 2437 y Ff(letter)64 b(::)22 b(Parser)e(Char)165
2491 y(letter)86 b(=)22 b(lower)e(`plus`)h(upper)165 2599 y(alphanum)f(::)i
(Parser)e(Char)165 2653 y(alphanum)42 b(=)22 b(letter)e(`plus`)h(digit)p
eop
%%Page: 8 8
8 7 bop 100 178 a Fq(8)441 b Fi(Gr)n(aham)14 b(Hutton)i(and)f(Erik)g(Meijer)
100 278 y Fq(More)f(in)o(terestingly)m(,)f(a)h(parser)h(for)e(w)o(ords)h
(\(strings)h(of)e(letters\))i(is)f(de\014ned)h(b)o(y)165 359
y Ff(word)21 b(::)g(Parser)g(String)165 413 y(word)43 b(=)21
b(neWord)g(`plus`)f(result)h("")339 467 y(where)405 521 y(neWord)f(=)i
(letter)e(`bind`)h(\\x)43 b(->)601 575 y(word)64 b(`bind`)21
b(\\xs)g(->)601 629 y(result)f(\(x:xs\))100 710 y Fq(That)15
b(is,)f Ff(word)h Fq(either)h(parses)g(a)f(non-empt)o(y)f(w)o(ord)h(\(a)g
(single)g(letter)h(follo)o(w)o(ed)e(b)o(y)h(a)g(w)o(ord,)100
764 y(using)e(a)g(recursiv)o(e)i(call)e(to)h Ff(word)p Fq(\),)e(in)h(whic)o
(h)g(case)i(the)f(t)o(w)o(o)f(results)i(are)f(com)o(bined)e(to)i(form)100
818 y(a)f(string,)h(or)g(parses)h(nothing)e(and)h(returns)h(the)g(empt)o(y)d
(string.)141 872 y(F)m(or)g(example,)f(applying)g Ff(word)g
Fq(to)i(the)g(input)f Ff("Yes!")f Fq(giv)o(es)h(the)i(result)f
Ff([\("Yes","!"\),)100 926 y(\("Ye","s!"\),)19 b(\("Y","es!"\),)g
(\("","Yes!"\)])p Fq(.)8 b(The)i(\014rst)h(result,)g Ff(\("Yes","!"\))p
Fq(,)c(is)j(the)100 980 y(exp)q(ected)i(result:)e(the)h(string)g(of)e
(letters)j Ff("Yes")d Fq(has)h(b)q(een)i(consumed,)d(and)h(the)h(unconsumed)
100 1034 y(input)g(is)f Ff("!")p Fq(.)g(In)h(the)h(subsequen)o(t)h(results)f
(a)f(decreasing)h(n)o(um)o(b)q(er)e(of)h(letters)h(are)g(consumed.)100
1088 y(This)i(b)q(eha)o(viour)g(arises)h(b)q(ecause)h(the)f(c)o(hoice)g(op)q
(erator)f Ff(plus)g Fq(is)g Fi(non-deterministic)r Fq(:)g(b)q(oth)100
1142 y(alternativ)o(es)e(can)g(b)q(e)g(explored,)g(ev)o(en)g(if)f(the)h
(\014rst)h(alternativ)o(e)f(is)f(successful.)i(Th)o(us,)f(at)f(eac)o(h)100
1196 y(application)f(of)h Ff(letter)p Fq(,)f(there)j(is)e(alw)o(a)o(ys)g(the)
h(option)f(to)h(just)g(\014nish)f(parsing,)g(ev)o(en)i(if)e(there)100
1249 y(are)j(still)f(letters)i(left)f(to)f(b)q(e)i(consumed)f(from)e(the)i
(start)h(of)e(the)h(input.)613 1384 y Fl(3)24 b(P)o(arsers)14
b(and)h(monads)100 1465 y Fq(Later)20 b(on)g(w)o(e)g(will)f(de\014ne)i(a)e(n)
o(um)o(b)q(er)h(of)f(useful)h(parser)h(com)o(binators)e(in)g(terms)h(of)f
(the)100 1519 y(primitiv)o(e)12 b(parsers)17 b(and)e(com)o(binators)e(just)i
(de\014ned.)h(But)f(\014rst)h(w)o(e)f(turn)g(our)g(atten)o(tion)g(to)100
1573 y(the)f(monadic)e(nature)j(of)e(com)o(binator)f(parsers.)610
1708 y Fg(3.1)24 b(The)17 b(p)n(arser)e(monad)100 1789 y Fq(So)e(far,)g(w)o
(e)h(ha)o(v)o(e)g(de\014ned)h(\(among)d(others\))j(the)g(follo)o(wing)c(t)o
(w)o(o)i(op)q(erations)h(on)g(parsers:)165 1870 y Ff(result)21
b(::)g(a)h(->)f(Parser)f(a)165 1924 y(bind)65 b(::)21 b(Parser)f(a)i(->)f
(\(a)h(->)f(Parser)g(b\))g(->)h(Parser)e(b)100 2005 y Fq(Generalising)c(from)
f(the)i(sp)q(eci\014c)h(case)g(of)e Ff(Parser)g Fq(to)g(some)g(arbitrary)h(t)
o(yp)q(e)g(constructor)100 2059 y Ff(M)e Fq(giv)o(es)h(the)g(notion)f(of)g(a)
h(monad:)e(a)h Fi(monad)21 b Fq(is)16 b(a)f(t)o(yp)q(e)i(constructor)g
Ff(M)f Fq(\(a)f(function)h(from)100 2113 y(t)o(yp)q(es)e(to)g(t)o(yp)q(es\),)
h(together)f(with)g(op)q(erations)g Ff(result)f Fq(and)g Ff(bind)g
Fq(of)h(the)g(follo)o(wing)d(t)o(yp)q(es:)165 2194 y Ff(result)21
b(::)g(a)h(->)f(M)g(a)165 2248 y(bind)65 b(::)21 b(M)h(a)f(->)g(\(a)h(->)f(M)
h(b\))f(->)h(M)f(b)100 2329 y Fq(Th)o(us,)10 b(parsers)i(form)d(a)i(monad)e
(for)h(whic)o(h)h Ff(M)f Fq(is)h(the)g Ff(Parser)f Fq(t)o(yp)q(e)h
(constructor,)h(and)e Ff(result)100 2383 y Fq(and)g Ff(bind)g
Fq(are)h(de\014ned)h(as)e(previously)m(.)g(T)m(ec)o(hnically)m(,)f(the)i(t)o
(w)o(o)f(op)q(erations)h(of)f(a)g(monad)f(m)o(ust)100 2437
y(also)14 b(satisfy)h(a)g(few)h(algebraic)f(prop)q(erties,)h(but)f(w)o(e)h
(do)f(not)g(concern)i(ourselv)o(es)f(with)f(suc)o(h)100 2491
y(prop)q(erties)g(here;)g(see)g(\(W)m(adler,)d(1992a;)h(W)m(adler,)f(1992b\))
h(for)h(more)f(details.)141 2545 y(Readers)k(famili)o(ar)c(with)j(the)g
(categorical)g(de\014nition)f(of)g(a)h(monad)d(ma)o(y)h(ha)o(v)o(e)i(exp)q
(ected)100 2599 y(t)o(w)o(o)f(op)q(erations)h Ff(map)21 b(::)h(\(a)f(->)g
(b\))h(->)f(\(M)h(a)f(->)h(M)f(b\))15 b Fq(and)h Ff(join)21
b(::)h(M)f(\(M)g(a\))h(->)f(M)100 2653 y(a)12 b Fq(in)h(place)g(of)f(the)i
(single)f(op)q(eration)f Ff(bind)p Fq(.)g(Ho)o(w)o(ev)o(er,)h(our)g
(de\014nition)f(is)h(equiv)n(alen)o(t)g(to)f(the)p eop
%%Page: 9 9
9 8 bop 575 178 a Fi(Monadic)16 b(Parser)e(Combinators)461
b Fq(9)100 278 y(categorical)14 b(one)h(\(W)m(adler,)f(1992a;)f(W)m(adler,)g
(1992b\),)h(and)g(has)h(the)g(adv)n(an)o(tage)f(that)h Ff(bind)100
332 y Fq(generally)e(pro)o(v)o(es)i(more)d(con)o(v)o(enien)o(t)j(for)e
(monadic)f(programming)e(than)k Ff(map)g Fq(and)f Ff(join)p
Fq(.)141 386 y(P)o(arsers)18 b(are)e(not)g(the)g(only)f(example)g(of)g(a)g
(monad.)f(Indeed,)i(w)o(e)g(will)f(see)i(later)f(on)f(ho)o(w)100
440 y(the)d(parser)i(monad)c(can)i(b)q(e)h(re-form)o(ulated)e(in)g(terms)h
(of)g(t)o(w)o(o)f(simpler)g(monads.)f(This)i(raises)100 494
y(the)j(question)g(of)f(what)h(to)f(do)h(ab)q(out)f(the)h(naming)e(of)h(the)h
(monadic)e(com)o(binators)g Ff(result)100 548 y Fq(and)k Ff(bind)p
Fq(.)e(In)j(functional)e(languages)g(based)i(up)q(on)f(the)h(Hindley-Milner)f
(t)o(yping)f(system)100 602 y(\(for)c(example,)e(Miranda)504
587 y Fd(y)533 602 y Fq(and)i(Standard)h(ML\))f(it)g(is)g(not)g(p)q(ossible)g
(to)h(use)g(the)f(same)g(names)100 656 y(for)k(the)h(com)o(binators)f(of)g
(di\013eren)o(t)h(monads.)e(Rather,)i(one)f(w)o(ould)g(ha)o(v)o(e)h(to)f(use)
i(di\013eren)o(t)100 710 y(names,)12 b(suc)o(h)j(as)f Ff(resultM)e
Fq(and)i Ff(bindM)p Fq(,)e(for)i(the)g(com)o(binators)f(of)g(eac)o(h)h(monad)
e Ff(M)p Fq(.)141 765 y(Gofer,)k(ho)o(w)o(ev)o(er,)g(extends)h(the)g
(Hindley-Milner)e(t)o(yping)h(system)g(with)g(an)g(o)o(v)o(erloading)100
819 y(mec)o(hanism)10 b(that)i(p)q(ermits)g(the)h(use)g(of)f(the)h(same)e
(names)h(for)f(the)i(com)o(binators)e(of)h(di\013eren)o(t)100
873 y(monads.)e(Under)k(this)e(o)o(v)o(erloading)f(mec)o(hanism,)f(the)j
(appropriate)f(monad)f(for)h(eac)o(h)h(use)h(of)100 927 y(a)f(name)g(is)h
(calculated)g(automatically)c(during)k(t)o(yp)q(e)g(inference.)141
981 y(Ov)o(erloading)c(in)h(Gofer)f(is)h(accomplished)f(b)o(y)h(the)g(use)h
(of)f Fi(classes)j Fq(\(Jones,)d(1995c\).)f(A)i(class)100 1035
y(for)h(monads)g(can)h(b)q(e)g(declared)h(in)e(Gofer)h(b)o(y:)165
1121 y Ff(class)21 b(Monad)g(m)g(where)230 1175 y(result)g(::)g(a)h(->)f(m)h
(a)230 1229 y(bind)65 b(::)21 b(m)h(a)f(->)h(\(a)f(->)h(m)f(b\))h(->)f(m)h(b)
100 1315 y Fq(This)16 b(declaration)g(can)h(b)q(e)g(read)f(as)h(follo)o(ws:)d
(a)i(t)o(yp)q(e)h(constructor)h Ff(m)e Fq(is)h(a)f(mem)o(b)q(er)f(of)g(the)
100 1369 y(class)c Ff(Monad)f Fq(if)g(it)h(is)f(equipp)q(ed)i(with)f
Ff(result)e Fq(and)i Ff(bind)f Fq(op)q(erations)h(of)g(the)g(sp)q(eci\014ed)i
(t)o(yp)q(es.)100 1423 y(The)k(fact)g(that)h Ff(m)f Fq(m)o(ust)f(b)q(e)h(a)g
(t)o(yp)q(e)h(constructor)h(\(rather)f(than)f(just)h(a)e(t)o(yp)q(e\))i(is)f
(inferred)100 1477 y(from)12 b(its)i(use)g(in)g(the)g(t)o(yp)q(es)h(for)f
(the)g(op)q(erations.)141 1531 y(No)o(w)d(the)g(t)o(yp)q(e)g(constructor)i
Ff(Parser)d Fq(can)h(b)q(e)g(made)f(in)o(to)g(an)g(instance)i(of)e(the)i
(class)f Ff(Monad)100 1585 y Fq(using)i(the)i Ff(result)d Fq(and)i
Ff(bind)f Fq(from)f(the)j(previous)f(section:)165 1671 y Ff(instance)20
b(Monad)h(Parser)f(where)230 1725 y(--)i(result)e(::)i(a)f(->)h(Parser)e(a)
230 1779 y(result)h(v)65 b(=)22 b(\\inp)f(->)g([\(v,inp\)])230
1887 y(--)h(bind)64 b(::)22 b(Parser)e(a)i(->)f(\(a)h(->)f(Parser)g(b\))g(->)
g(Parser)g(b)230 1941 y(p)h(`bind`)f(f)g(=)h(\\inp)f(->)g(concat)g([f)g(v)h
(out)f(|)g(\(v,out\))g(<-)g(p)h(inp])141 2027 y Fq(W)m(e)15
b(pause)h(brie\015y)g(here)h(to)e(address)i(a)e(couple)h(of)e(tec)o(hnical)i
(p)q(oin)o(ts)g(concerning)g(Gofer.)100 2081 y(First)g(of)g(all,)f(t)o(yp)q
(e)h(synon)o(yms)g(suc)o(h)h(as)f Ff(Parser)f Fq(m)o(ust)g(b)q(e)i(supplied)g
(with)f(all)f(their)h(argu-)100 2135 y(men)o(ts.)c(Hence)i(the)g(instance)f
(declaration)g(ab)q(o)o(v)o(e)g(is)g(not)g(actually)f(v)n(alid)f(Gofer)i(co)q
(de,)g(since)100 2189 y Ff(Parser)f Fq(is)i(used)h(in)f(the)g(\014rst)h(line)
e(without)h(an)g(argumen)o(t.)e(The)i(problem)f(is)h(easy)g(to)g(solv)o(e)100
2243 y(\(rede\014ne)k Ff(Parser)d Fq(using)i Ff(data)e Fq(rather)j(than)f
Ff(type)p Fq(,)e(or)h(as)h(a)f Fi(r)n(estricte)n(d)k Fq(t)o(yp)q(e)d(synon)o
(ym\),)100 2297 y(but)11 b(for)g(simplicit)o(y)d(w)o(e)j(prefer)i(in)d(this)h
(article)g(just)h(to)e(assume)h(that)g(t)o(yp)q(e)h(synon)o(yms)e
Fi(c)n(an)k Fq(b)q(e)100 2351 y(partially)f(applied.)h(The)h(second)h(p)q
(oin)o(t)f(is)f(that)h(the)h(syn)o(tax)f(of)f(Gofer)h(do)q(es)g(not)g(curren)
o(tly)100 2405 y(allo)o(w)h(the)j(t)o(yp)q(es)g(of)e(the)i(de\014ned)g
(functions)f(in)g(instance)h(declarations)f(to)g(b)q(e)h(explicitly)100
2459 y(sp)q(eci\014ed.)c(But)f(for)g(clarit)o(y)m(,)e(as)i(ab)q(o)o(v)o(e,)f
(w)o(e)h(include)g(suc)o(h)h(t)o(yp)q(es)g(in)e(commen)o(ts.)141
2513 y(Let)i(us)f(turn)g(no)o(w)g(to)f(the)i(follo)o(wing)c(op)q(erations)j
(on)g(parsers:)112 2637 y Fc(y)141 2653 y Fk(Miranda)h(is)e(a)g(trademark)h
(of)f(Researc)o(h)h(Soft)o(w)o(are)f(Ltd.)p eop
%%Page: 10 10
10 9 bop 100 178 a Fq(10)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)165 278 y Ff(zero)21 b(::)g(Parser)g(a)165 332 y(plus)g(::)g(Parser)g
(a)g(->)h(Parser)e(a)i(->)f(Parser)g(a)100 416 y Fq(Generalising)14
b(once)i(again)e(from)f(the)j(sp)q(eci\014c)g(case)g(of)f(the)g
Ff(Parser)f Fq(t)o(yp)q(e)i(constructor,)g(w)o(e)100 470 y(arriv)o(e)d(at)g
(the)h(notion)f(of)g(a)g Fi(monad)i(with)f(a)h(zer)n(o)f(and)h(a)g(plus)s
Fq(,)e(whic)o(h)g(can)h(b)q(e)g(encapsulated)100 524 y(using)f(the)i(Gofer)e
(class)i(system)e(in)h(the)g(follo)o(wing)d(manner:)165 608
y Ff(class)21 b(Monad)g(m)g(=>)g(Monad0Plus)f(m)i(where)230
662 y(zero)f(::)h(m)f(a)230 716 y(\(++\))g(::)h(m)f(a)h(->)f(m)h(a)f(->)h(m)f
(a)100 800 y Fq(That)12 b(is,)f(a)h(t)o(yp)q(e)g(constructor)i
Ff(m)e Fq(is)g(a)g(mem)o(b)q(er)e(of)i(the)g(class)h Ff(Monad0Plus)d
Fq(if)h(it)h(is)g(a)g(mem)o(b)q(er)100 854 y(of)g(the)h(class)h
Ff(Monad)d Fq(\(that)i(is,)f(it)h(is)g(equipp)q(ed)g(with)g(a)f
Ff(result)g Fq(and)g Ff(bind)p Fq(\),)g(and)h(if)e(it)i(is)g(also)100
908 y(equipp)q(ed)i(with)g Ff(zero)f Fq(and)h Ff(\(++\))f Fq(op)q(erators)i
(of)e(the)i(sp)q(eci\014ed)h(t)o(yp)q(es.)e(Of)g(course,)h(the)f(t)o(w)o(o)
100 962 y(extra)j(op)q(erations)g(m)o(ust)f(also)g(satisfy)h(some)f
(algebraic)h(prop)q(erties;)h(these)g(are)f(discussed)100 1016
y(in)c(\(W)m(adler,)f(1992a;)g(W)m(adler,)g(1992b\).)g(Note)i(also)f(that)g
Ff(\(++\))g Fq(is)g(used)h(ab)q(o)o(v)o(e)g(rather)g(than)100
1070 y Ff(plus)p Fq(,)g(follo)o(wing)e(the)k(example)e(of)h(lists:)f(w)o(e)i
(will)e(see)i(later)g(on)f(that)g(lists)g(form)f(a)h(monad)100
1124 y(for)d(whic)o(h)h(the)g(plus)g(op)q(eration)g(is)g(just)g(the)g
(familiar)d(app)q(end)j(op)q(eration)g Ff(\(++\))p Fq(.)141
1178 y(No)o(w)g(since)g Ff(Parser)f Fq(is)g(already)h(a)f(monad,)f(it)h(can)h
(b)q(e)h(made)d(in)o(to)i(a)f(monad)f(with)i(a)f(zero)100 1232
y(and)g(a)h(plus)g(using)f(the)i(follo)o(wing)c(de\014nitions:)165
1317 y Ff(instance)20 b(Monad0Plus)g(Parser)g(where)230 1371
y(--)i(zero)f(::)g(Parser)g(a)230 1425 y(zero)109 b(=)21 b(\\inp)g(->)g([])
230 1533 y(--)h(\(++\))f(::)g(Parser)g(a)g(->)h(Parser)e(a)i(->)f(Parser)g(a)
230 1586 y(p)h(++)f(q)66 b(=)21 b(\\inp)g(->)g(\(p)h(inp)f(++)g(q)h(inp\))491
1725 y Fg(3.2)i(Monad)15 b(c)n(ompr)n(ehension)g(syntax)100
1806 y Fq(So)c(far)g(w)o(e)g(ha)o(v)o(e)h(seen)g(one)g(adv)n(an)o(tage)e(of)h
(recognising)h(the)g(monadic)d(nature)j(of)f(parsers:)h(the)100
1860 y(monadic)e(sequencing)j(com)o(binator)d Ff(bind)h Fq(handles)i(result)g
(v)n(alues)e(b)q(etter)j(than)e(the)h(con)o(v)o(en-)100 1914
y(tional)e(sequencing)i(com)o(binator)e Ff(seq)p Fq(.)g(In)h(this)h(section)g
(w)o(e)f(consider)h(another)g(adv)n(an)o(tage)f(of)100 1968
y(the)k(monadic)d(approac)o(h,)i(namely)f(that)h Fi(monad)i(c)n(ompr)n
(ehension)j Fq(syn)o(tax)15 b(can)h(b)q(e)g(used)g(to)100 2022
y(mak)o(e)c(parsers)j(more)e(compact)g(and)h(easier)h(to)e(read.)141
2076 y(As)i(men)o(tioned)e(earlier,)g(man)o(y)f(parsers)k(will)c(ha)o(v)o(e)i
(a)g(structure)i(as)e(a)g(sequence)i(of)d Ff(bind)p Fq(s)100
2130 y(follo)o(w)o(ed)f(b)o(y)i(single)f(call)g(to)h Ff(result)p
Fq(:)165 2214 y Ff(p1)21 b(`bind`)g(\\x1)g(->)165 2268 y(p2)g(`bind`)g(\\x2)g
(->)165 2322 y(...)165 2376 y(pn)g(`bind`)g(\\xn)g(->)165 2430
y(result)g(\(f)g(x1)g(x2)h(...)f(xn\))100 2514 y Fq(Gofer)14
b(pro)o(vides)g(a)h(sp)q(ecial)f(notation)g(for)g(de\014ning)g(parsers)i(of)e
(this)h(shap)q(e,)g(allo)o(wing)d(them)100 2568 y(to)h(b)q(e)i(expressed)h
(in)e(the)g(follo)o(wing,)d(more)i(app)q(ealing)g(form:)165
2653 y Ff([)22 b(f)f(x1)h(x2)f(...)g(xn)g(|)h(x1)f(<-)h(p1)p
eop
%%Page: 11 11
11 10 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(11)535 278 y Ff(,)22 b(x2)f(<-)h(p2)535 332 y(,)g(...)535
386 y(,)g(xn)f(<-)h(pn)f(])100 471 y Fq(In)16 b(fact,)g(this)h(notation)f(is)
g(not)g(sp)q(eci\014c)i(to)f(parsers,)g(but)g(can)g(b)q(e)g(used)h(with)e(an)
o(y)g(monad)100 525 y(\(Jones,)i(1995c\).)e(The)j(reader)f(migh)o(t)e(notice)
i(the)g(similarit)o(y)c(to)k(the)g(list)f(comprehension)100
579 y(notation)d(supp)q(orted)i(b)o(y)e(man)o(y)f(functional)h(languages.)g
(It)h(w)o(as)g(W)m(adler)f(\(1990\))g(who)g(\014rst)100 632
y(observ)o(ed)e(that)f(the)g(comprehension)g(notation)f(is)h(not)g
(particular)g(to)g(lists,)f(but)h(mak)o(es)f(sense)100 686
y(for)i(an)g(arbitrary)h(monad.)d(Indeed,)j(the)h(algebraic)e(prop)q(erties)i
(required)f(of)f(the)i(monad)c(op-)100 740 y(erations)k(turn)g(out)f(to)h(b)q
(e)g(precisely)h(those)f(required)h(for)e(the)h(notation)f(to)h(mak)o(e)e
(sense.)j(T)m(o)100 794 y(our)g(kno)o(wledge,)g(Gofer)g(is)g(the)i(\014rst)f
(language)e(to)i(implemen)o(t)c(W)m(adler's)j Fi(monad)i(c)n(ompr)n(e-)100
848 y(hension)j Fq(notation.)14 b(Using)i(this)g(notation)f(can)h(mak)o(e)f
(parsers)i(m)o(uc)o(h)e(easier)h(to)g(read,)g(and)100 902 y(w)o(e)e(will)e
(use)j(the)f(notation)f(in)h(the)g(remainder)g(of)f(this)h(article.)141
957 y(As)20 b(our)f(\014rst)h(example)e(of)h(using)f(comprehension)i
(notation,)d(w)o(e)j(de\014ne)g(a)f(parser)h(for)100 1011 y(recognising)13
b(sp)q(eci\014c)j(strings,)e(with)f(the)i(string)f(itself)f(returned)j(as)e
(the)g(result:)165 1095 y Ff(string)151 b(::)22 b(String)e(->)i(Parser)e
(String)165 1149 y(string)h("")108 b(=)22 b([""])165 1203 y(string)f
(\(x:xs\))f(=)i([x:xs)e(|)i(_)g(<-)f(char)g(x,)g(_)h(<-)f(string)g(xs])100
1288 y Fq(That)d(is,)g(if)g(the)i(string)f(to)f(b)q(e)i(parsed)f(is)g(empt)o
(y)f(w)o(e)h(just)g(return)h(the)f(empt)o(y)f(string)h(as)100
1342 y(the)f(result;)h Ff([""])e Fq(is)h(just)g(monad)e(comprehension)i(syn)o
(tax)g(for)f Ff(result)k("")p Fq(.)c(Otherwise,)100 1396 y(w)o(e)c(parse)h
(the)g(\014rst)h(c)o(haracter)f(of)f(the)h(string)f(using)h
Ff(char)p Fq(,)e(and)h(then)h(parse)g(the)g(remaining)100 1450
y(c)o(haracters)22 b(using)e(a)h(recursiv)o(e)h(call)e(to)g
Ff(string)p Fq(.)f(Without)h(the)h(aid)f(of)g(comprehension)100
1504 y(notation,)12 b(the)j(ab)q(o)o(v)o(e)e(de\014nition)h(w)o(ould)f(read)h
(as)g(follo)o(ws:)165 1589 y Ff(string)151 b(::)22 b(String)e(->)i(Parser)e
(String)165 1643 y(string)h("")108 b(=)22 b(result)e("")165
1696 y(string)h(\(x:xs\))f(=)i(char)f(x)87 b(`bind`)20 b(\\_)i(->)514
1750 y(string)e(xs)i(`bind`)e(\\_)i(->)514 1804 y(result)e(\(x:xs\))100
1889 y Fq(Note)h(that)f(the)h(parser)h Ff(string)f(xs)f Fq(fails)f(if)h(only)
g(a)g(pre\014x)h(of)f(the)h(giv)o(en)f(string)h Ff(xs)f Fq(is)100
1943 y(recognised)15 b(in)g(the)g(input.)f(F)m(or)g(example,)f(applying)h
(the)h(parser)h Ff(string)21 b("hello")13 b Fq(to)h(the)100
1997 y(input)i Ff("hello)k(there")c Fq(giv)o(es)g(the)h(successful)h(result)g
Ff([\("hello",")h(there"\)])p Fq(.)c(On)h(the)100 2051 y(other)i(hand,)g
(applying)f(the)h(same)g(parser)h(to)f Ff("helicopter")e Fq(fails)g(with)i
(the)h(result)g Ff([])p Fq(,)100 2105 y(ev)o(en)14 b(though)g(the)g(pre\014x)
h Ff("hel")e Fq(of)g(the)h(input)g(can)g(b)q(e)h(recognised.)141
2159 y(In)d(list)f(comprehension)h(notation,)f(w)o(e)h(are)g(not)g(just)g
(restricted)i(to)d Fi(gener)n(ators)k Fq(that)d(bind)100 2213
y(v)n(ariables)g(to)h(v)n(alues,)f(but)i(can)f(also)g(use)h(Bo)q(olean-v)n
(alued)e Fi(guar)n(ds)17 b Fq(that)c(restrict)h(the)g(v)n(alues)100
2267 y(of)g(the)i(b)q(ound)g(v)n(ariables.)e(F)m(or)h(example,)e(a)i
(function)g Ff(negs)g Fq(that)g(selects)i(all)d(the)i(negativ)o(e)100
2321 y(n)o(um)o(b)q(ers)d(from)f(a)i(list)f(of)h(in)o(tegers)g(can)g(b)q(e)h
(expressed)h(as)e(follo)o(ws:)165 2406 y Ff(negs)65 b(::)21
b([Int])g(->)g([Int])165 2460 y(negs)g(xs)g(=)h([x)f(|)h(x)f(<-)h(xs,)f(x)h
(<)f(0])100 2544 y Fq(In)16 b(this)g(case,)g(the)h(expression)g
Ff(x)22 b(<)g(0)15 b Fq(is)h(a)g(guard)g(that)g(restricts)i(the)f(v)n
(ariable)e Ff(x)h Fq(\(b)q(ound)100 2598 y(b)o(y)d(the)i(generator)f
Ff(x)22 b(<-)f(xs)p Fq(\))14 b(to)g(only)f(tak)o(e)h(on)f(v)n(alues)h(less)h
(than)e(zero.)141 2653 y(W)m(adler)20 b(\(1990\))g(observ)o(ed)h(that)g(the)g
(use)g(of)f(guards)h(mak)o(es)e(sense)k(for)d(an)g(arbitrary)p
eop
%%Page: 12 12
12 11 bop 100 178 a Fq(12)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(monad)d(with)h(a)h(zero.)g(The)h(monad)d(comprehension)i
(notation)f(in)g(Gofer)h(supp)q(orts)h(this)f(use)100 332 y(of)g(guards.)h(F)
m(or)f(example,)f(the)j Ff(sat)e Fq(com)o(binator)165 413 y
Ff(sat)43 b(::)21 b(\(Char)g(->)g(Bool\))g(->)h(Parser)e(Char)165
467 y(sat)h(p)h(=)f(item)g(`bind`)g(\\x)g(->)339 521 y(if)h(p)f(x)h(then)f
(result)f(x)i(else)f(zero)100 602 y Fq(can)14 b(b)q(e)g(de\014ned)h(more)e
(succinctly)i(using)f(a)f(comprehension)h(with)f(a)h(guard:)165
683 y Ff(sat)43 b(::)21 b(\(Char)g(->)g(Bool\))g(->)h(Parser)e(Char)165
737 y(sat)h(p)h(=)f([x)h(|)f(x)h(<-)f(item,)g(p)h(x])141 818
y Fq(W)m(e)17 b(conclude)g(this)g(section)h(b)o(y)f(noting)f(that)h(there)h
(is)f(another)g(notation)f(that)h(can)g(b)q(e)100 872 y(used)c(to)g(mak)o(e)f
(monadic)f(programs)h(easier)h(to)g(read:)g(the)h(so-called)e(\\)p
Ff(do)p Fq(")g(notation)g(\(Jones,)100 926 y(1994;)d(Jones)j(&)f(Launc)o(h)o
(bury)m(,)f(1994\).)g(F)m(or)g(example,)f(using)i(this)g(notation)f(the)h
(com)o(binators)100 980 y Ff(string)h Fq(and)i Ff(sat)f Fq(can)h(b)q(e)h
(de\014ned)g(as)f(follo)o(ws:)165 1061 y Ff(string)151 b(::)22
b(String)e(->)i(Parser)e(String)165 1115 y(string)h("")108
b(=)22 b(do)f({)h(result)e("")i(})165 1169 y(string)f(\(x:xs\))f(=)i(do)f({)h
(char)f(x)g(;)h(string)e(xs)i(;)f(result)g(\(x:xs\))f(})165
1276 y(sat)217 b(::)22 b(\(Char)e(->)i(Bool\))f(->)g(Parser)g(Char)165
1330 y(sat)g(p)196 b(=)22 b(do)f({)h(x)f(<-)h(item)f(;)g(if)h(\(p)f(x\))g(;)h
(result)e(x)i(})100 1411 y Fq(The)16 b Ff(do)f Fq(notation)f(has)i(a)f
(couple)h(of)f(adv)n(an)o(tages)g(o)o(v)o(er)g(monad)f(comprehension)h
(notation:)100 1465 y(w)o(e)j(are)h(not)f(restricted)j(to)d(monad)e
(expressions)k(that)f(end)g(with)f(a)g(use)h(of)f Ff(result)p
Fq(;)e(and)100 1519 y(generators)f(of)e(the)h(form)p 520 1519
14 2 v 50 w Ff(<-)21 b(e)14 b Fq(that)g(do)f(not)h(bind)f(v)n(ariables)g(can)
h(b)q(e)h(abbreviated)f(b)o(y)g Ff(e)p Fq(.)100 1573 y(The)j
Ff(do)f Fq(notation)g(is)h(supp)q(orted)h(b)o(y)e(Gofer,)g(but)h(monad)e
(expressions)j(in)o(v)o(olving)c(parsers)100 1627 y(t)o(ypically)f(end)j
(with)e(a)h(use)h(of)e Ff(result)g Fq(\(to)h(compute)g(the)g(result)h(v)n
(alue)e(from)g(the)h(parser\),)100 1681 y(so)f(the)h(extra)f(generalit)o(y)g
(is)g(not)g(really)f(necessary)k(in)c(this)i(case.)f(F)m(or)g(this)g(reason,)
g(and)g(for)100 1735 y(simplicit)o(y)m(,)e(in)i(this)i(article)f(w)o(e)h
(only)f(use)h(the)g(comprehension)f(notation.)f(It)i(w)o(ould)e(b)q(e)i(an)
100 1789 y(easy)e(task,)f(ho)o(w)o(ev)o(er,)h(to)g(translate)g(our)g
(de\014nitions)g(in)o(to)f(the)i Ff(do)e Fq(notation.)542 1924
y Fl(4)23 b(Com)o(binators)14 b(for)h(rep)q(etitio)o(n)100
2005 y Fq(P)o(arser)j(generators)g(suc)o(h)f(as)g(Lex)g(and)g(Y)m(acc)g
(\(Aho)g Fi(et)g(al.)p Fq(,)f(1986\))g(for)h(pro)q(ducing)f(parsers)100
2059 y(written)c(in)f(C,)h(and)f(Ratatosk)g(\(Mogensen,)i(1993\))e(and)g
(Happ)o(y)h(\(Gill)e(&)i(Marlo)o(w,)e(1995\))h(for)100 2113
y(pro)q(ducing)k(parsers)h(written)g(in)f(Hask)o(ell,)f(t)o(ypically)f
(o\013er)j(a)f(\014xed)g(set)h(of)f(com)o(binators)e(for)100
2167 y(describing)f(grammars.)d(In)j(con)o(trast,)g(with)f(the)i(metho)q(d)e
(of)g(building)g(parsers)i(as)f(presen)o(ted)100 2221 y(in)g(this)h(article)f
(the)i(set)f(of)f(com)o(binators)f(is)i(completely)f(extensible:)h(parsers)h
(are)f(\014rst-class)100 2275 y(v)n(alues,)e(and)g(w)o(e)h(ha)o(v)o(e)f(the)i
(full)d(p)q(o)o(w)o(er)i(of)f(a)h(functional)e(language)h(at)g(our)h(disp)q
(osal)f(to)h(de\014ne)100 2329 y(sp)q(ecial)i(com)o(binators)e(for)i(sp)q
(ecial)g(applications.)141 2383 y(In)i(this)f(section)i(w)o(e)e(de\014ne)i
(com)o(binators)d(for)h(a)g(n)o(um)o(b)q(er)g(of)g(common)e(patterns)k(of)d
Fi(r)n(ep-)100 2437 y(etition)s Fq(.)k(These)i(com)o(binators)d(are)i(not)f
(sp)q(eci\014c)i(to)f(parsers,)g(but)g(can)g(b)q(e)g(used)h(with)e(an)100
2491 y(arbitrary)13 b(monad)e(with)i(a)g(zero)h(and)f(plus.)g(F)m(or)g
(clarit)o(y)m(,)f(ho)o(w)o(ev)o(er,)h(w)o(e)g(sp)q(ecialise)h(the)g(t)o(yp)q
(es)100 2545 y(of)f(the)h(com)o(binators)f(to)h(the)g(case)h(of)e(parsers.)
141 2599 y(In)g(subsequen)o(t)j(sections)e(w)o(e)f(will)f(in)o(tro)q(duce)i
(com)o(binators)e(for)h(other)h(purp)q(oses,)g(includ-)100
2653 y(ing)f(handling)f(lexical)h(issues)i(and)f(Gofer's)g(o\013side)g(rule.)
p eop
%%Page: 13 13
13 12 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(13)625 278 y Fg(4.1)24 b(Simple)17 b(r)n(ep)n(etition)100
359 y Fq(Earlier)c(w)o(e)g(de\014ned)h(a)f(parser)h Ff(word)e
Fq(for)h(consuming)e(zero)j(or)f(more)f(letters)i(from)e(the)h(input)100
413 y(string.)g(Using)h(monad)e(comprehension)i(notation,)e(the)j
(de\014nition)e(is:)165 494 y Ff(word)21 b(::)g(Parser)g(String)165
548 y(word)43 b(=)21 b([x:xs)g(|)h(x)f(<-)h(letter,)e(xs)h(<-)h(word])f(++)g
([""])100 629 y Fq(W)m(e)12 b(can)g(easily)g(imagine)e(a)i(n)o(um)o(b)q(er)g
(of)g(other)h(parsers)h(that)e(exhibit)g(a)h(similar)d(structure)k(to)100
683 y Ff(word)p Fq(.)d(F)m(or)g(example,)g(parsers)j(for)e(strings)g(of)g
(digits)g(or)g(strings)h(of)e(spaces)j(could)e(b)q(e)h(de\014ned)100
737 y(in)h(precisely)h(the)g(same)f(w)o(a)o(y)m(,)e(the)j(only)f
(di\013erence)i(b)q(eing)f(b)q(e)g(that)f(the)h(comp)q(onen)o(t)f(parser)100
791 y Ff(letter)9 b Fq(w)o(ould)h(b)q(e)i(replaced)f(b)o(y)g(either)h
Ff(digit)d Fq(or)i Ff(char)21 b(')h(')p Fq(.)10 b(T)m(o)g(a)o(v)o(oid)f
(de\014ning)i(a)g(n)o(um)o(b)q(er)100 845 y(of)g(di\013eren)o(t)i(parsers)g
(with)f(a)g(similar)d(structure,)14 b(w)o(e)e(abstract)h(on)f(the)h(pattern)f
(of)g(recursion)100 899 y(in)h Ff(word)g Fq(and)h(de\014ne)h(a)e(general)h
(com)o(binator,)e Ff(many)p Fq(,)h(that)g(parses)j(sequences)g(of)d(items.)
141 953 y(The)j(com)o(binator)e Ff(many)h Fq(applies)h(a)f(parser)i
Ff(p)f Fq(zero)g(or)g(more)f(times)g(to)g(an)h(input)f(string.)100
1007 y(The)f(results)h(from)d(eac)o(h)j(application)d(of)h
Ff(p)h Fq(are)g(returned)i(in)d(a)h(list:)165 1088 y Ff(many)43
b(::)21 b(Parser)g(a)g(->)h(Parser)e([a])165 1142 y(many)h(p)h(=)f([x:xs)g(|)
g(x)h(<-)f(p,)h(xs)f(<-)h(many)f(p])g(++)g([[]])100 1222 y
Fq(Di\013eren)o(t)g(parsers)h(can)f(b)q(e)h(made)d(b)o(y)i(supplying)f
(di\013eren)o(t)i(argumen)o(ts)e(parsers)i Ff(p)p Fq(.)e(F)m(or)100
1276 y(example,)8 b Ff(word)h Fq(can)i(b)q(e)g(de\014ned)g(just)f(as)g
Ff(many)21 b(letter)p Fq(,)9 b(and)h(the)h(other)f(parsers)i(men)o(tioned)100
1330 y(ab)q(o)o(v)o(e)h(b)o(y)h Ff(many)21 b(digit)13 b Fq(and)g
Ff(many)21 b(\(char)g(')h('\))p Fq(.)141 1384 y(Just)c(as)e(the)h(original)e
Ff(word)h Fq(parser)h(returns)h(man)o(y)d(results)j(in)e(general)h
(\(decreasing)g(in)100 1438 y(the)i(n)o(um)o(b)q(er)f(of)h(letters)h
(consumed)e(from)f(the)j(input\),)e(so)h(do)q(es)h Ff(many)h(p)p
Fq(.)d(Of)h(course,)g(in)100 1492 y(most)13 b(cases)j(w)o(e)f(will)e(only)h
(b)q(e)h(in)o(terested)h(in)e(the)i(\014rst)f(parse)g(from)e
Ff(many)21 b(p)p Fq(,)14 b(in)g(whic)o(h)h Ff(p)f Fq(is)100
1546 y(successfully)h(applied)f(as)h(man)o(y)e(times)h(as)g(p)q(ossible.)h(W)
m(e)f(will)f(return)j(to)e(this)h(p)q(oin)o(t)f(in)g(the)100
1600 y(next)g(section,)g(when)h(w)o(e)f(address)h(the)f(e\016ciency)h(of)e
(parsers.)141 1654 y(As)k(another)g(application)e(of)g Ff(many)p
Fq(,)g(w)o(e)i(can)f(de\014ne)i(a)e(parser)h(for)f(iden)o(ti\014ers.)h(F)m
(or)f(sim-)100 1708 y(plicit)o(y)m(,)9 b(w)o(e)j(regard)h(an)e(iden)o
(ti\014er)i(as)e(a)h(lo)o(w)o(er-case)g(letter)h(follo)o(w)o(ed)d(b)o(y)i
(zero)g(or)g(more)f(alpha-)100 1762 y(n)o(umeric)h(c)o(haracters.)i(It)f(w)o
(ould)f(b)q(e)i(easy)f(to)g(extend)h(the)g(de\014nition)f(to)f(handle)h
(extra)h(c)o(har-)100 1816 y(acters,)g(suc)o(h)h(as)f(underlines)h(or)f(bac)o
(kquotes.)165 1897 y Ff(ident)21 b(::)g(Parser)g(String)165
1951 y(ident)43 b(=)21 b([x:xs)g(|)g(x)h(<-)f(lower,)g(xs)g(<-)h(many)f
(alphanum])141 2032 y Fq(Sometimes)13 b(w)o(e)i(will)e(only)h(b)q(e)i(in)o
(terested)g(in)f(non-empt)o(y)e(sequences)18 b(of)c(items.)f(F)m(or)i(this)
100 2086 y(reason)f(w)o(e)g(de\014ne)h(a)f(sp)q(ecial)g(com)o(binator,)d
Ff(many1)p Fq(,)i(in)g(terms)h(of)f Ff(many)p Fq(:)165 2167
y Ff(many1)43 b(::)21 b(Parser)f(a)i(->)f(Parser)g([a])165
2221 y(many1)g(p)g(=)h([x:xs)f(|)g(x)h(<-)f(p,)h(xs)f(<-)g(many)g(p])100
2302 y Fq(F)m(or)e(example,)f(applying)h Ff(many1)i(\(char)g('a'\))e
Fq(to)h(the)g(input)g Ff("aaab")f Fq(giv)o(es)h(the)g(result)100
2356 y Ff([\("aaa","b"\),)f(\("aa","ab"\),)g(\("a","aab"\)])p
Fq(,)6 b(whic)o(h)j(is)h(the)f(same)g(as)g(for)g Ff(many)21
b(\(char)100 2410 y('a'\))p Fq(,)12 b(except)j(that)f(the)g(\014nal)f(pair)g
Ff(\("",)21 b("aaab"\))13 b Fq(is)g(no)h(longer)f(presen)o(t.)i(Note)f(also)f
(that)100 2464 y Ff(many1)20 b(p)14 b Fq(ma)o(y)e(fail,)g(whereas)j
Ff(many)21 b(p)14 b Fq(alw)o(a)o(ys)e(succeeds.)141 2518 y(Using)i
Ff(many1)f Fq(w)o(e)h(can)g(de\014ne)h(a)e(parser)i(for)f(natural)f(n)o(um)o
(b)q(ers:)165 2599 y Ff(nat)21 b(::)h(Parser)e(Int)165 2653
y(nat)43 b(=)22 b([eval)e(xs)i(|)f(xs)h(<-)f(many1)g(digit])p
eop
%%Page: 14 14
14 13 bop 100 178 a Fq(14)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)318 278 y Ff(where)383 332 y(eval)21 b(xs)43 b(=)22
b(foldl1)e(op)i([ord)f(x)g(-)h(ord)f('0')g(|)h(x)f(<-)h(xs])383
386 y(m)g(`op`)e(n)i(=)g(10*m)f(+)g(n)100 473 y Fq(In)14 b(turn,)f
Ff(nat)h Fq(can)g(b)q(e)g(used)h(to)f(de\014ne)h(a)e(parser)i(for)f(in)o
(tegers:)165 560 y Ff(int)21 b(::)h(Parser)e(Int)165 614 y(int)43
b(=)22 b([-n)f(|)g(_)h(<-)f(char)g('-',)g(n)h(<-)f(nat])g(++)h(nat)100
700 y Fq(A)9 b(more)g(sophisticated)h(w)o(a)o(y)f(to)h(de\014ne)g
Ff(int)f Fq(is)h(as)g(follo)o(ws.)d(First)j(try)g(and)g(parse)g(the)h
(negation)100 754 y(c)o(haracter)18 b(')p Ff(-)p Fq('.)e(If)g(this)h(is)g
(successful)i(then)f(return)g(the)g(negation)f(function)f(as)i(the)f(result)
100 808 y(of)c(the)h(parse;)g(otherwise)h(return)g(the)f(iden)o(tit)o(y)f
(function.)g(The)h(\014nal)f(step)i(is)e(then)i(to)e(parse)100
862 y(a)k(natural)g(n)o(um)o(b)q(er,)g(and)g(use)h(the)h(function)e(returned)
i(b)o(y)f(attempting)e(to)h(parse)i(the)f(')p Ff(-)p Fq(')100
916 y(c)o(haracter)d(to)f(mo)q(dify)d(the)k(resulting)f(n)o(um)o(b)q(er:)165
1003 y Ff(int)21 b(::)h(Parser)e(Int)165 1057 y(int)43 b(=)22
b([f)f(n)h(|)f(f)h(<-)f(op,)g(n)h(<-)f(nat])318 1111 y(where)383
1165 y(op)g(=)h([negate)e(|)i(_)f(<-)h(char)f('-'])g(++)g([id])529
1306 y Fg(4.2)i(R)n(ep)n(etition)15 b(with)h(sep)n(ar)n(ators)100
1387 y Fq(The)g Ff(many)e Fq(com)o(binators)g(parse)j(sequences)h(of)c
(items.)g(No)o(w)i(w)o(e)f(consider)i(a)e(sligh)o(tly)f(more)100
1441 y(general)h(pattern)h(of)f(rep)q(etition,)g(in)g(whic)o(h)g(separators)i
(b)q(et)o(w)o(een)g(the)f(items)e(are)i(in)o(v)o(olv)o(ed.)100
1495 y(Consider)e(the)g(problem)e(of)h(parsing)h(a)f(non-empt)o(y)f(list)h
(of)g(in)o(tegers,)h(suc)o(h)h(as)f Ff([1,-42,17])p Fq(.)100
1549 y(Suc)o(h)g(a)g(parser)h(can)f(b)q(e)g(de\014ned)h(in)f(terms)f(of)g
(the)i Ff(many)e Fq(com)o(binator)f(as)i(follo)o(ws:)165 1636
y Ff(ints)21 b(::)g(Parser)g([Int])165 1690 y(ints)43 b(=)21
b([n:ns)g(|)h(_)43 b(<-)21 b(char)g('[')470 1744 y(,)h(n)43
b(<-)21 b(int)470 1798 y(,)h(ns)f(<-)g(many)g([x)h(|)f(_)h(<-)f(char)g(',',)g
(x)h(<-)f(int])470 1852 y(,)h(_)43 b(<-)21 b(char)g(']'])141
1939 y Fq(As)c(w)o(as)g(the)g(case)h(in)f(the)g(previous)g(section)h(for)e
(the)h Ff(word)f Fq(parser,)i(w)o(e)f(can)g(imagine)d(a)100
1993 y(n)o(um)o(b)q(er)e(of)g(other)i(parsers)h(with)d(a)h(similar)e
(structure)k(to)e Ff(ints)p Fq(,)e(so)i(it)g(is)g(useful)g(to)g(abstract)100
2047 y(on)k(the)i(pattern)g(of)e(rep)q(etition)i(and)f(de\014ne)h(a)f
(general)g(purp)q(ose)h(com)o(binator,)d(whic)o(h)i(w)o(e)100
2101 y(call)13 b Ff(sepby1)p Fq(.)g(The)i(com)o(binator)d Ff(sepby1)h
Fq(is)h(lik)o(e)g Ff(many1)f Fq(in)h(that)h(it)f(recognises)h(non-empt)o(y)
100 2155 y(sequences)g(of)e(a)g(giv)o(en)g(parser)h Ff(p)p
Fq(,)f(but)g(di\013eren)o(t)h(in)f(that)g(the)h(instances)g(of)f
Ff(p)g Fq(are)h(separated)100 2209 y(b)o(y)f(a)h(parser)h Ff(sep)e
Fq(whose)i(result)f(v)n(alues)g(are)g(ignored:)165 2296 y Ff(sepby1)173
b(::)21 b(Parser)g(a)h(->)f(Parser)g(b)g(->)h(Parser)e([a])165
2350 y(p)i(`sepby1`)e(sep)h(=)g([x:xs)g(|)h(x)43 b(<-)22 b(p)666
2404 y(,)g(xs)f(<-)h(many)f([y)g(|)h(_)f(<-)g(sep,)g(y)h(<-)f(p]])100
2490 y Fq(Note)14 b(that)g(the)h(fact)f(that)g(the)h(results)g(of)f(the)g
Ff(sep)g Fq(parser)h(are)f(ignored)g(is)g(re\015ected)j(in)c(the)100
2544 y(t)o(yp)q(e)f(of)g(the)h Ff(sepby1)e Fq(com)o(binator:)e(the)k
Ff(sep)f Fq(parser)h(giv)o(es)f(results)h(of)f(t)o(yp)q(e)g
Ff(b)p Fq(,)g(but)g(this)g(t)o(yp)q(e)100 2598 y(do)q(es)i(not)g(o)q(ccur)h
(in)e(the)i(t)o(yp)q(e)f Ff([a])g Fq(of)f(the)h(results)h(of)f(the)g(com)o
(binator.)141 2653 y(No)o(w)g Ff(ints)f Fq(can)h(b)q(e)g(de\014ned)h(in)f(a)f
(more)g(compact)g(form:)p eop
%%Page: 15 15
15 14 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(15)165 278 y Ff(ints)21 b(=)h([ns)f(|)g(_)44 b(<-)21 b(char)g('[')405
332 y(,)g(ns)h(<-)f(int)g(`sepby1`)f(char)h(',')405 386 y(,)g(_)44
b(<-)21 b(char)g(']'])100 465 y Fq(In)13 b(fact)g(w)o(e)h(can)f(go)g(a)g
(little)g(further.)g(The)h(brac)o(k)o(eting)f(of)g(parsers)i(b)o(y)e(other)h
(parsers)g(whose)100 519 y(results)i(are)f(ignored)g(|)f(in)h(the)g(case)h
(ab)q(o)o(v)o(e,)f(the)g(brac)o(k)o(eting)g(parsers)i(are)e
Ff(char)21 b('[')14 b Fq(and)100 573 y Ff(char)21 b(']')13
b Fq(|)g(is)h(common)d(enough)j(to)g(also)f(merit)g(its)h(o)o(wn)f(com)o
(binator:)165 652 y Ff(bracket)20 b(::)i(Parser)e(a)i(->)f(Parser)g(b)g(->)h
(Parser)e(c)i(->)f(Parser)g(b)165 706 y(bracket)f(open)h(p)h(close)f(=)g([x)h
(|)f(_)h(<-)f(open,)g(x)h(<-)f(p,)g(_)h(<-)f(close])100 786
y Fq(No)o(w)13 b Ff(ints)g Fq(can)h(b)q(e)h(de\014ned)g(just)f(as)165
865 y Ff(ints)21 b(=)h(bracket)e(\(char)h('['\))492 919 y(\(int)g(`sepby1`)f
(char)h(','\))492 973 y(\(char)g(']'\))100 1052 y Fq(Finally)m(,)d(while)j
Ff(many1)f Fq(w)o(as)i(de\014ned)g(in)f(terms)g(of)g Ff(many)p
Fq(,)f(the)h(com)o(binator)f Ff(sepby)g Fq(\(for)100 1106 y(p)q(ossibly-empt)
o(y)12 b(sequences\))17 b(is)c(naturally)g(de\014ned)i(in)f(terms)f(of)h
Ff(sepby1)p Fq(:)165 1185 y Ff(sepby)195 b(::)21 b(Parser)g(a)h(->)f(Parser)g
(b)g(->)h(Parser)e([a])165 1239 y(p)i(`sepby`)e(sep)43 b(=)21
b(\(p)h(`sepby1`)e(sep\))h(++)g([[]])406 1372 y Fg(4.3)i(R)n(ep)n(etition)15
b(with)h(me)n(aningful)g(sep)n(ar)n(ators)100 1452 y Fq(The)d
Ff(sepby)f Fq(com)o(binators)f(handle)i(the)h(case)f(of)g(parsing)f
(sequences)k(of)c(items)g(separated)i(b)o(y)100 1506 y(text)i(that)h(can)f(b)
q(e)h(ignored.)e(In)i(this)f(\014nal)f(section)i(on)f(rep)q(etition,)g(w)o(e)
h(address)g(the)g(more)100 1560 y(general)f(case)i(in)e(whic)o(h)g(the)i
(separators)f(themselv)o(es)g(carry)g(meaning.)d(The)j(com)o(binators)100
1614 y(de\014ned)e(in)e(this)h(section)h(are)f(due)g(to)g(F)m(okk)o(er)g
(\(1995\).)141 1668 y(Consider)c(the)g(problem)e(of)h(parsing)g(simple)f
(arithmetic)g(expressions)j(suc)o(h)f(as)f Ff(1+2-\(3+4\))p
Fq(,)100 1722 y(built)15 b(up)h(from)f(natural)g(n)o(um)o(b)q(ers)h(using)g
(addition,)e(subtraction,)j(and)f(paren)o(theses.)i(The)100
1776 y(t)o(w)o(o)e(arithmetic)f(op)q(erators)j(are)f(assumed)f(to)g(asso)q
(ciate)i(to)e(the)h(left)g(\(th)o(us,)f(for)h(example,)100
1830 y Ff(1-2-3)11 b Fq(should)i(b)q(e)h(parsed)g(as)f Ff(\(1-2\)-3)p
Fq(\),)e(and)h(ha)o(v)o(e)h(the)h(same)e(precedence.)j(The)f(standard)100
1884 y(BNF)g(grammar)d(for)i(suc)o(h)i(expressions)h(is)d(written)i(as)f
(follo)o(ws:)462 1959 y Fi(expr)79 b(::=)49 b(expr)15 b(addop)h(factor)29
b Fe(j)g Fi(factor)462 2013 y(addop)51 b(::=)e Ff(+)29 b Fe(j)g
Ff(-)462 2067 y Fi(factor)50 b(::=)f(nat)30 b Fe(j)f Ff(\()15
b Fi(expr)f Ff(\))100 2142 y Fq(This)f(grammar)e(can)j(b)q(e)h(translated)f
(directly)g(in)o(to)g(a)f(com)o(binator)f(parser:)165 2221
y Ff(expr)65 b(::)21 b(Parser)f(Int)165 2275 y(addop)43 b(::)21
b(Parser)f(\(Int)h(->)h(Int)f(->)g(Int\))165 2329 y(factor)g(::)g(Parser)f
(Int)165 2437 y(expr)65 b(=)21 b([f)h(x)f(y)h(|)f(x)h(<-)f(expr,)g(f)h(<-)f
(addop,)g(y)g(<-)g(factor])g(++)g(factor)165 2545 y(addop)43
b(=)21 b([\(+\))g(|)h(_)f(<-)h(char)f('+'])g(++)g([\(-\))g(|)h(_)f(<-)g(char)
g('-'])165 2653 y(factor)g(=)g(nat)g(++)h(bracket)e(\(char)h('\('\))g(expr)g
(\(char)f('\)'\))p eop
%%Page: 16 16
16 15 bop 100 178 a Fq(16)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(In)g(fact,)h(rather)h(than)e(just)h(returning)h(some)e
(kind)g(of)g(parse)i(tree,)g(the)f Ff(expr)f Fq(parser)i(ab)q(o)o(v)o(e)100
332 y(actually)f(ev)n(aluates)i(arithmetic)f(expressions)i(to)f(their)g(in)o
(teger)g(v)n(alue:)f(the)h Ff(addop)f Fq(parser)100 386 y(returns)i(a)f
(function)g(as)g(its)g(result)h(v)n(alue,)e(whic)o(h)h(is)g(used)h(to)f(com)o
(bine)f(the)h(result)h(v)n(alues)100 440 y(pro)q(duced)d(b)o(y)e(parsing)h
(the)h(argumen)o(ts)e(to)g(the)i(op)q(erator.)141 494 y(Of)i(course,)h(ho)o
(w)o(ev)o(er,)e(there)j(is)d(a)h(problem)f(with)g(the)i Ff(expr)e
Fq(parser)i(as)f(de\014ned)h(ab)q(o)o(v)o(e.)100 548 y(The)c(fact)g(that)g
(the)g(op)q(erators)h(asso)q(ciate)g(to)f(the)g(left)g(is)g(tak)o(en)g
(accoun)o(t)g(of)f(b)o(y)h Ff(expr)f Fq(b)q(eing)100 602 y
Fi(left-r)n(e)n(cursive)j Fq(\(the)h(\014rst)f(thing)f(it)g(do)q(es)h(is)f
(mak)o(e)f(a)h(recursiv)o(e)i(call)e(to)g(itself)s(\).)g(Th)o(us)h
Ff(expr)100 656 y Fq(nev)o(er)e(mak)o(es)f(an)o(y)h(progress,)g(and)g(hence)h
(do)q(es)g(not)f(terminate.)141 710 y(As)i(is)g(w)o(ell-kno)o(wn,)e(this)i
(kind)g(of)f(non-termination)f(for)h(parsers)j(can)e(b)q(e)g(solv)o(ed)g(b)o
(y)f(re-)100 764 y(placing)g(left-recursion)j(b)o(y)f(iteration.)e(Lo)q
(oking)h(at)h(the)g Fi(expr)k Fq(grammar,)13 b(w)o(e)k(see)h(that)f(an)100
818 y(expression)g(is)f(a)g(sequence)j(of)d Fi(factor)t Fq(s,)g(separated)i
(b)o(y)e Fi(addop)s Fq(s.)h(Th)o(us)f(the)h(parser)h(for)e(ex-)100
872 y(pressions)f(can)f(b)q(e)g(re-de\014ned)i(using)d Ff(many)g
Fq(as)h(follo)o(ws:)165 946 y Ff(expr)21 b(=)h([...)f(|)g(x)65
b(<-)22 b(factor)427 1000 y(,)f(fys)g(<-)h(many)f([\(f,y\))f(|)i(f)f(<-)h
(addop,)e(y)i(<-)f(factor]])100 1074 y Fq(This)13 b(tak)o(es)g(care)h(of)e
(the)i(non-termination,)d(but)i(it)g(still)f(remains)g(to)h(\014ll)f(in)g
(the)i(\\)p Ff(...)p Fq(")e(part)100 1128 y(of)h(the)h(new)h(de\014nition,)e
(whic)o(h)h(computes)f(the)i(v)n(alue)e(of)g(an)h(expression.)141
1182 y(Supp)q(ose)g(no)o(w)f(that)g(the)h(input)f(string)g(is)g
Ff("1-2+3-4")p Fq(.)e(Then)i(after)h(parsing)e(using)h Ff(expr)p
Fq(,)100 1236 y(the)j(v)n(ariable)f Ff(x)h Fq(will)e(b)q(e)j
Ff(1)f Fq(and)g Ff(fys)f Fq(will)f(b)q(e)j(the)g(list)e Ff([\(\(-\),2\),)20
b(\(\(+\),3\),)g(\(\(-\),4\)])p Fq(.)100 1290 y(These)15 b(can)g(b)q(e)g
(reduced)h(to)f(a)f(single)g(v)n(alue)g Ff(1-2+3-4)20 b(=)i(\(\(1-2\)+3\)-4)d
(=)j(-2)14 b Fq(b)o(y)g(folding:)100 1344 y(the)21 b(built-in)e(function)h
Ff(foldl)f Fq(is)h(suc)o(h)h(that,)f(for)g(example,)e Ff(foldl)j(g)h(a)f
([b,c,d,e])f(=)100 1398 y(\(\(a)h(`g`)g(b\))g(`g`)h(c\))f(`g`)g(d\))g(`g`)h
(e)p Fq(.)13 b(In)i(the)g(presen)o(t)g(case,)g(w)o(e)g(need)g(to)f(tak)o(e)h
Ff(g)f Fq(as)g(the)100 1452 y(function)f Ff(\\x)22 b(\(f,y\))e(->)i(f)f(x)h
(y)p Fq(,)13 b(and)h Ff(a)f Fq(as)h(the)h(in)o(teger)f Ff(x)p
Fq(:)165 1526 y Ff(expr)21 b(=)h([foldl)e(\(\\x)h(\(f,y\))g(->)g(f)h(x)g(y\))
f(x)h(fys)383 1580 y(|)g(x)65 b(<-)21 b(factor)383 1634 y(,)h(fys)f(<-)g
(many)g([\(f,y\))g(|)g(f)h(<-)f(addop,)g(y)g(<-)h(factor]])100
1708 y Fq(No)o(w,)13 b(for)g(example,)g(applying)f Ff(expr)h
Fq(to)h(the)h(input)e(string)h Ff("1+2-\(3+4\)")e Fq(giv)o(es)i(the)g(result)
100 1762 y Ff([\(-4,""\),)20 b(\(3,"-\(3+4\)",)f(\(1,"+2-\(3+4\)"\)])p
Fq(,)10 b(as)k(exp)q(ected.)141 1816 y(Pla)o(ying)h(the)j(generalisation)e
(game)f(once)i(again,)e(w)o(e)i(can)g(abstract)g(on)g(the)g(pattern)h(of)100
1870 y(rep)q(etition)c(in)f Ff(expr)h Fq(and)f(de\014ne)i(a)f(new)g(com)o
(binator.)e(The)i(com)o(binator,)e Ff(chainl1)p Fq(,)g(parses)100
1924 y(non-empt)o(y)g(sequences)17 b(of)c(items)g(separated)i(b)o(y)f(op)q
(erators)g(that)g(asso)q(ciate)h(to)f(the)g(left:)165 1998
y Ff(chainl1)151 b(::)21 b(Parser)g(a)h(->)f(Parser)g(\(a)g(->)g(a)h(->)f
(a\))h(->)f(Parser)g(a)165 2052 y(p)h(`chainl1`)e(op)h(=)g([foldl)g(\(\\x)g
(\(f,y\))g(->)g(f)h(x)g(y\))f(x)g(fys)601 2106 y(|)g(x)66 b(<-)21
b(p)601 2160 y(,)g(fys)h(<-)f(many)g([\(f,y\))g(|)g(f)h(<-)f(op,)g(y)h(<-)f
(p]])100 2234 y Fq(Th)o(us)14 b(our)g(parser)h(for)e(expressions)j(can)e(no)o
(w)f(b)q(e)i(written)f(as)g(follo)o(ws:)165 2309 y Ff(expr)65
b(=)21 b(factor)g(`chainl1`)f(addop)165 2416 y(addop)43 b(=)21
b([\(+\))g(|)h(_)f(<-)h(char)f('+'])g(++)g([\(-\))g(|)h(_)f(<-)g(char)g('-'])
165 2524 y(factor)g(=)g(nat)g(++)h(bracket)e(\(char)h('\('\))g(expr)g(\(char)
f('\)'\))100 2599 y Fq(Most)15 b(op)q(erator)g(parsers)i(will)c(ha)o(v)o(e)i
(a)g(similar)d(structure)17 b(to)e Ff(addop)f Fq(ab)q(o)o(v)o(e,)g(so)h(it)g
(is)g(useful)100 2653 y(to)e(abstract)i(a)f(com)o(binator)e(for)h(building)g
(suc)o(h)h(parsers:)p eop
%%Page: 17 17
17 16 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(17)165 278 y Ff(ops)65 b(::)21 b([\(Parser)f(a,)i(b\)])f(->)g(Parser)g
(b)165 332 y(ops)g(xs)h(=)f(foldr1)g(\(++\))g([[op)g(|)g(_)h(<-)f(p])h(|)f
(\(p,op\))g(<-)g(xs])100 410 y Fq(The)14 b(built-in)f(function)g
Ff(foldr1)g Fq(is)h(suc)o(h)g(that,)g(for)f(example,)g Ff(foldr1)20
b(g)i([a,b,c,d])e(=)h(a)100 464 y(`g`)g(\(b)g(`g`)g(\(c)h(`g`)f(d\)\))p
Fq(.)16 b(It)h(is)g(de\014ned)i(for)d(an)o(y)h(non-empt)o(y)f(list.)g(In)h
(the)h(ab)q(o)o(v)o(e)f(case)100 518 y(then,)12 b Ff(foldr1)f
Fq(places)h(the)h(c)o(hoice)f(op)q(erator)h Ff(\(++\))e Fq(b)q(et)o(w)o(een)i
(eac)o(h)g(parser)g(in)e(the)i(list.)e(Using)100 572 y Ff(ops)p
Fq(,)h(our)i Ff(addop)f Fq(parser)i(can)f(no)o(w)g(b)q(e)g(de\014ned)h(b)o(y)
165 650 y Ff(addop)21 b(=)g(ops)h([\(char)e('+',)h(\(+\)\),)g(\(char)g('-',)g
(\(-\)\)])141 728 y Fq(A)d(p)q(ossible)f(ine\016ciency)h(in)f(the)h
(de\014nition)f(of)f(the)i Ff(chainl1)e Fq(com)o(binator)g(is)h(the)h(con-)
100 782 y(struction)f(of)f(the)h(in)o(termediate)f(list)g Ff(fys)p
Fq(.)g(This)g(can)h(b)q(e)g(a)o(v)o(oided)f(b)o(y)h(giving)e(a)h(direct)h
(re-)100 836 y(cursiv)o(e)e(de\014nition)e(of)h Ff(chainl1)f
Fq(that)h(do)q(es)h(not)f(mak)o(e)f(use)i(of)e Ff(foldl)g Fq(and)h
Ff(many)p Fq(,)f(using)h(an)100 890 y(accum)o(ulating)d(parameter)j(to)g
(construct)h(the)g(\014nal)e(result:)165 968 y Ff(chainl1)151
b(::)21 b(Parser)g(a)h(->)f(Parser)g(\(a)g(->)g(a)h(->)f(a\))h(->)f(Parser)g
(a)165 1022 y(p)h(`chainl1`)e(op)h(=)g(p)h(`bind`)f(rest)535
1076 y(where)601 1130 y(rest)g(x)g(=)h(\(op)f(`bind`)g(\\f)g(->)819
1184 y(p)43 b(`bind`)21 b(\\y)g(->)819 1237 y(rest)g(\(f)g(x)h(y\)\))f(++)g
([x])100 1315 y Fq(This)12 b(de\014nition)f(has)i(a)f(natural)f(op)q
(erational)h(reading.)f(The)i(parser)g Ff(p)22 b(`chainl1`)d(op)12
b Fq(\014rst)100 1369 y(parses)k(a)e(single)h Ff(p)p Fq(,)f(whose)h(result)g
(v)n(alue)g(b)q(ecomes)g(the)g(initial)e(accum)o(ulator)g(for)h(the)i
Ff(rest)100 1423 y Fq(function.)f(Then)i(it)f(attempts)g(to)g(parse)h(an)f
(op)q(erator)h(and)f(a)g(single)f Ff(p)p Fq(.)h(If)g(successful,)h(the)100
1477 y(accum)o(ulator)10 b(and)h(the)h(result)h(from)d Ff(p)h
Fq(are)h(com)o(bined)e(using)i(the)g(function)f Ff(f)g Fq(returned)j(from)100
1531 y(parsing)h(the)g(op)q(erator,)h(and)f(the)h(resulting)f(v)n(alue)g(b)q
(ecomes)g(the)h(new)g(accum)o(ulator)d(when)100 1585 y(parsing)h(the)h
(remainder)f(of)g(the)h(sequence)i(\(using)d(a)g(recursiv)o(e)i(call)e(to)h
Ff(rest)p Fq(\).)e(Otherwise,)100 1639 y(the)h(sequence)i(is)e(\014nished,)g
(and)g(the)g(accum)o(ulator)f(is)g(returned.)141 1693 y(As)h(another)f(in)o
(teresting)h(application)d(of)i Ff(chainl1)p Fq(,)e(w)o(e)i(can)h(rede\014ne)
g(our)g(earlier)f(parser)100 1747 y Ff(nat)18 b Fq(for)g(natural)g(n)o(um)o
(b)q(ers)g(suc)o(h)i(that)f(it)f(do)q(es)h(not)g(construct)h(an)f(in)o
(termediate)e(list)i(of)100 1801 y(digits.)11 b(In)i(this)g(case,)g(the)g
Ff(op)g Fq(parser)h(do)q(es)f(not)g(do)f(an)o(y)h(parsing,)f(but)h(returns)h
(the)f(function)100 1855 y(that)h(com)o(bines)f(a)g(natural)h(and)f(a)h
(digit:)165 1933 y Ff(nat)21 b(::)h(Parser)e(Int)165 1987 y(nat)43
b(=)22 b([ord)f(x)g(-)h(ord)f('0')g(|)h(x)f(<-)h(digit])e(`chainl1`)g([op])
318 2041 y(where)383 2095 y(m)i(`op`)e(n)i(=)g(10*m)f(+)g(n)141
2173 y Fq(Naturally)m(,)15 b(w)o(e)h(can)h(also)e(de\014ne)j(a)e(com)o
(binator)e Ff(chainr1)h Fq(that)i(parses)g(non-empt)o(y)e(se-)100
2227 y(quences)g(of)e(items)g(separated)i(b)o(y)f(op)q(erators)h(that)e(asso)
q(ciate)i(to)f(the)g Fi(right)p Fq(,)f(rather)h(than)g(to)100
2281 y(the)g(left.)f(F)m(or)h(simplicit)o(y)m(,)c(w)o(e)k(only)f(giv)o(e)h
(the)g(direct)h(recursiv)o(e)g(de\014nition:)165 2359 y Ff(chainr1)151
b(::)21 b(Parser)g(a)h(->)f(Parser)g(\(a)g(->)g(a)h(->)f(a\))h(->)f(Parser)g
(a)165 2413 y(p)h(`chainr1`)e(op)h(=)230 2467 y(p)h(`bind`)f(\\x)g(->)296
2521 y([f)g(x)h(y)f(|)h(f)f(<-)h(op,)f(y)h(<-)f(p)h(`chainr1`)e(op])h(++)g
([x])100 2599 y Fq(That)12 b(is,)f Ff(p)22 b(`chainr1`)e(op)11
b Fq(\014rst)i(parses)g(a)f(single)g Ff(p)p Fq(.)f(Then)i(it)e(attempts)h(to)
g(parse)h(an)f(op)q(er-)100 2653 y(ator)h(and)h(the)h(rest)g(of)e(the)i
(sequence)h(\(using)e(a)f(recursiv)o(e)j(call)d(to)h Ff(chainr1)p
Fq(\).)e(If)i(successful,)p eop
%%Page: 18 18
18 17 bop 100 178 a Fq(18)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(the)i(pair)g(of)f(results)j(from)c(the)j(\014rst)f
Ff(p)g Fq(and)g(the)h(rest)g(of)f(the)g(sequence)i(are)f(com)o(bined)e(us-)
100 332 y(ing)f(the)i(function)e Ff(f)h Fq(returned)i(from)c(parsing)i(the)g
(op)q(erator.)g(Otherwise,)h(the)g(sequence)h(is)100 386 y(\014nished,)d(and)
f(the)i(result)f(from)f Ff(p)g Fq(is)h(returned.)141 443 y(As)e(an)g(example)
f(of)g(using)g Ff(chainr1)p Fq(,)f(w)o(e)i(extend)h(our)f(parser)h(for)f
(arithmetic)e(expressions)100 497 y(to)17 b(handle)g(exp)q(onen)o(tiation;)g
(this)h(op)q(erator)g(has)g(higher)f(precedence)k(than)c(the)i(previous)100
551 y(t)o(w)o(o)13 b(op)q(erators,)h(and)g(asso)q(ciates)h(to)f(the)g(righ)o
(t:)165 669 y Ff(expr)65 b(=)21 b(term)65 b(`chainl1`)20 b(addop)165
777 y(term)65 b(=)21 b(factor)g(`chainr1`)f(expop)165 884 y(factor)h(=)g(nat)
g(++)h(bracket)e(\(char)h('\('\))g(expr)g(\(char)f('\)'\))165
992 y(addop)43 b(=)21 b(ops)g([\(char)g('+',)g(\(+\)\),)g(\(char)f('-',)h
(\(-\)\)])165 1100 y(expop)43 b(=)21 b(ops)g([\(char)g('^',)g(\(^\)\)])141
1215 y Fq(F)m(or)14 b(completeness,)h(w)o(e)f(also)g(de\014ne)h(com)o
(binators)e Ff(chainl)g Fq(and)i Ff(chainr)e Fq(that)h(ha)o(v)o(e)g(the)100
1269 y(same)i(b)q(eha)o(viour)g(as)h Ff(chainl1)f Fq(and)h
Ff(chainr1)p Fq(,)d(except)19 b(that)e(they)g(can)g(also)g(consume)f(no)100
1323 y(input,)d(in)g(whic)o(h)h(case)h(a)f(giv)o(en)f(v)n(alue)g
Ff(v)h Fq(is)g(returned)h(as)f(the)h(result:)165 1440 y Ff(chainl)21
b(::)g(Parser)f(a)i(->)f(Parser)g(\(a)g(->)h(a)f(->)h(a\))f(->)g(a)h(->)f
(Parser)g(a)165 1494 y(chainl)g(p)g(op)h(v)f(=)h(\(p)f(`chainl1`)f(op\))h(++)
h([v])165 1602 y(chainr)f(::)g(Parser)f(a)i(->)f(Parser)g(\(a)g(->)h(a)f(->)h
(a\))f(->)g(a)h(->)f(Parser)g(a)165 1656 y(chainr)g(p)g(op)h(v)f(=)h(\(p)f
(`chainr1`)f(op\))h(++)h([v])141 1771 y Fq(In)14 b(summary)d(then,)j
Ff(chainl)f Fq(and)h Ff(chainr)e Fq(pro)o(vide)i(a)g(simple)e(w)o(a)o(y)h(to)
h(build)f(parsers)i(for)100 1825 y(expression-lik)o(e)j(grammars.)e(Using)i
(these)i(com)o(binators)d(a)o(v)o(oids)g(the)i(need)h(for)e(transfor-)100
1879 y(mations)d(to)i(remo)o(v)o(e)g(left-recursion)h(in)f(the)h(grammar,)c
(that)j(w)o(ould)g(otherwise)h(result)g(in)100 1933 y(non-termination)10
b(of)i(the)h(parser.)g(They)g(also)f(a)o(v)o(oid)f(the)i(need)h(for)e
(left-factorisation)f(of)h(the)100 1987 y(gramma)o(r,)g(that)i(w)o(ould)g
(otherwise)h(result)h(in)e(unnecessary)i(bac)o(ktrac)o(king;)e(w)o(e)h(will)e
(return)100 2041 y(to)g(this)h(p)q(oin)o(t)g(in)f(the)i(next)f(section.)613
2245 y Fl(5)24 b(E\016ciency)15 b(of)h(parsers)100 2329 y Fq(Using)h(com)o
(binators)f(is)h(a)g(simple)e(and)j(\015exible)f(metho)q(d)f(of)h(building)f
(parsers.)i(Ho)o(w)o(ev)o(er,)100 2383 y(the)13 b(p)q(o)o(w)o(er)f(of)g(the)h
(com)o(binators)e(|)g(in)h(particular,)g(their)g(abilit)o(y)f(to)h(bac)o
(ktrac)o(k)h(and)f(return)100 2437 y(m)o(ultiple)c(results)k(|)f(can)g(lead)g
(to)f(parsers)j(with)e(unexp)q(ected)i(space)f(and)e(time)g(p)q(erformance)
100 2491 y(if)g(one)i(do)q(es)g(not)g(tak)o(e)f(care.)h(In)f(this)h(section)g
(w)o(e)g(outline)f(some)f(simple)g(tec)o(hniques)j(that)f(can)100
2545 y(b)q(e)f(used)g(to)f(impro)o(v)o(e)f(the)i(e\016ciency)g(of)f(parsers.)
h(Readers)g(in)o(terested)h(in)e(further)i(tec)o(hniques)100
2599 y(are)h(referred)i(to)d(R\177)-21 b(ojemo's)11 b(thesis)j(\(1995\),)d
(whic)o(h)i(con)o(tains)g(a)g(c)o(hapter)h(on)e(the)i(use)f(of)g(heap)100
2653 y(pro\014ling)f(to)q(ols)i(in)f(the)i(optimisation)c(of)i(parser)i(com)o
(binators.)p eop
%%Page: 19 19
19 18 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(19)659 278 y Fg(5.1)24 b(L)n(eft)16 b(factoring)100 357
y Fq(Consider)e(the)h(simple)d(problem)h(of)g(parsing)h(and)g(ev)n(aluating)f
(t)o(w)o(o)g(natural)h(n)o(um)o(b)q(ers)g(sepa-)100 411 y(rated)c(b)o(y)g
(the)h(addition)e(sym)o(b)q(ol)f(`)p Ff(+)p Fq(',)h(or)h(b)o(y)g(the)h
(subtraction)f(sym)o(b)q(ol)f(`)p Ff(-)p Fq('.)f(This)i(sp)q(eci\014cation)
100 465 y(can)k(b)q(e)g(translated)h(directly)f(in)o(to)f(the)h(follo)o(wing)
e(parser:)165 540 y Ff(eval)21 b(::)g(Parser)g(Int)165 594
y(eval)43 b(=)21 b(add)h(++)f(sub)339 648 y(where)405 702 y(add)g(=)g([x+y)g
(|)h(x)g(<-)f(nat,)g(_)h(<-)f(char)g('+',)g(y)g(<-)h(nat])405
756 y(sub)f(=)g([x-y)g(|)h(x)g(<-)f(nat,)g(_)h(<-)f(char)g('-',)g(y)g(<-)h
(nat])100 830 y Fq(This)15 b(parser)h(giv)o(es)e(the)i(correct)h(results,)e
(but)h(is)e(ine\016cien)o(t.)h(F)m(or)g(example,)e(when)i(parsing)100
884 y(the)h(string)f Ff("123-456")e Fq(the)j(n)o(um)o(b)q(er)f
Ff(123)f Fq(will)g(\014rst)i(b)q(e)g(parsed)g(b)o(y)f(the)h
Ff(add)f Fq(parser,)h(that)100 938 y(will)9 b(then)j(fail)e(b)q(ecause)j
(there)f(is)g(no)f(`)p Ff(+)p Fq(')f(sym)o(b)q(ol)f(follo)o(wing)g(the)i(n)o
(um)o(b)q(er.)f(The)i(correct)h(parse)100 992 y(will)d(only)i(b)q(e)g(found)g
(b)o(y)g(bac)o(ktrac)o(king)g(in)f(the)i(input)f(string,)g(and)g(parsing)g
(the)g(n)o(um)o(b)q(er)g Ff(123)100 1046 y Fi(again)s Fq(,)i(this)g(time)e
(from)g(within)i(the)g Ff(sub)f Fq(parser.)141 1100 y(Of)h(course,)g(the)g(w)
o(a)o(y)f(to)h(a)o(v)o(oid)e(the)i(p)q(ossibilit)o(y)e(of)h(bac)o(ktrac)o
(king)h(and)f(rep)q(eated)i(parsing)100 1154 y(is)d(to)h Fi(left)h(factorise)
h Fq(the)f Ff(eval)e Fq(parser.)h(That)g(is,)f(the)i(initial)d(use)j(of)e
Ff(nat)h Fq(in)f(the)i(comp)q(onen)o(t)100 1208 y(parsers)h
Ff(add)e Fq(and)h Ff(sub)f Fq(should)h(b)q(e)g(factorised)h(out:)165
1283 y Ff(eval)21 b(=)h([v)f(|)h(x)f(<-)g(nat,)g(v)h(<-)f(add)h(x)f(++)h(sub)
f(x])318 1337 y(where)383 1391 y(add)g(x)h(=)f([x+y)g(|)h(_)f(<-)h(char)f
('+',)g(y)g(<-)h(nat])383 1445 y(sub)f(x)h(=)f([x+y)g(|)h(_)f(<-)h(char)f
('-',)g(y)g(<-)h(nat])100 1520 y Fq(This)11 b(new)i(v)o(ersion)f(of)f
Ff(eval)g Fq(giv)o(es)h(the)g(same)f(results)i(as)f(the)h(original)d(v)o
(ersion,)i(but)g(requires)100 1574 y(no)i(bac)o(ktrac)o(king.)g(Using)g(the)i
(new)f Ff(eval)p Fq(,)e(the)i(string)g Ff("123-456")e Fq(can)h(no)o(w)h(b)q
(e)g(parsed)g(in)100 1627 y(linear)j(time.)e(In)j(fact)f(w)o(e)h(can)f(go)g
(a)g(little)g(further,)h(and)f(righ)o(t)g(factorise)h(the)g(remaining)100
1681 y(use)c(of)e Ff(nat)h Fq(in)g(b)q(oth)g Ff(add)g Fq(and)g
Ff(sub)p Fq(.)f(This)h(do)q(es)h(not)g(impro)o(v)o(e)d(the)j(e\016ciency)g
(of)f Ff(eval)p Fq(,)f(but)100 1735 y(arguably)g(giv)o(es)g(a)h(cleaner)h
(parser:)165 1810 y Ff(eval)21 b(=)h([f)f(x)h(y)f(|)h(x)f(<-)h(nat)470
1864 y(,)g(f)f(<-)h(ops)f([\(char)f('+',)h(\(+\)\),)g(\(char)g('-',)g
(\(-\)\)])470 1918 y(,)h(y)f(<-)h(nat])141 1993 y Fq(In)12
b(practice,)f(most)g(cases)h(where)h(left)e(factorisation)g(of)f(a)h(parser)i
(is)e(necessary)j(to)d(impro)o(v)o(e)100 2047 y(e\016ciency)j(will)e(concern)
j(parsers)g(for)e(some)g(kind)g(of)g(expression.)i(In)e(suc)o(h)i(cases,)f
(man)o(ually)100 2101 y(factorising)d(the)h(parser)h(will)e(not)g(b)q(e)i
(required,)f(since)h(expression-lik)o(e)f(parsers)h(can)f(b)q(e)h(built)100
2155 y(using)g(the)h Ff(chain)f Fq(com)o(binators)f(from)f(the)k(previous)e
(section,)h(whic)o(h)g(already)f(encapsulate)100 2209 y(the)h(necessary)i
(left)e(factorisation.)141 2263 y(The)g(motto)d(of)i(this)g(section)h(is)f
(the)h(follo)o(wing:)c(bac)o(ktrac)o(king)i(is)h(a)g(p)q(o)o(w)o(erful)g(to)q
(ol,)f(but)h(it)100 2317 y(should)g(not)h(b)q(e)h(used)f(as)g(a)g(substitute)
h(for)f(care)g(in)g(designing)f(parsers.)607 2445 y Fg(5.2)24
b(Impr)n(oving)15 b(laziness)100 2524 y Fq(Recall)e(the)h(de\014nition)g(of)f
(the)h(rep)q(etition)h(com)o(binator)d Ff(many)p Fq(:)165 2599
y Ff(many)43 b(::)21 b(Parser)g(a)g(->)h(Parser)e([a])165 2653
y(many)h(p)h(=)f([x:xs)g(|)g(x)h(<-)f(p,)h(xs)f(<-)h(many)f(p])g(++)g([[]])p
eop
%%Page: 20 20
20 19 bop 100 178 a Fq(20)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(F)m(or)21 b(example,)g(applying)g Ff(many)g(\(char)f
('a'\))i Fq(to)g(the)h(input)f Ff("aaab")e Fq(giv)o(es)i(the)h(result)100
332 y Ff([\("aaa","b"\),)c(\("aa","ab"\),)g(\("a","aab"\),\("","a)o(aab")o
(\)])p Fq(.)13 b(Since)18 b(Gofer)f(is)f(lazy)m(,)100 386 y(w)o(e)c(w)o(ould)
g(exp)q(ect)i(the)f Ff(a)p Fq('s)f(in)g(the)i(\014rst)f(result)g
Ff("aaa")f Fq(to)g(b)q(ecome)g(a)o(v)n(ailable)e(one)j(at)g(a)f(time,)100
440 y(as)g(they)i(are)f(consumed)g(from)e(the)i(input.)f(This)h(is)f(not)h
(in)f(fact)h(what)g(happ)q(ens.)g(In)g(practice)100 494 y(no)g(part)h(of)g
(the)g(result)h Ff("aaa")d Fq(will)h(b)q(e)h(pro)q(duced)h(un)o(til)e(all)g
(the)i Ff(a)p Fq('s)e(ha)o(v)o(e)h(b)q(een)h(consumed.)100
548 y(In)f(other)g(w)o(ords,)g Ff(many)f Fq(is)g(not)h(as)g(lazy)g(as)g(w)o
(e)g(w)o(ould)f(exp)q(ect.)141 602 y(But)d(do)q(es)h(this)f(really)f(matter?)
f(Y)m(es,)i(b)q(ecause)h(it)e(is)h(common)d(in)i(functional)g(programmi)o(ng)
100 656 y(to)15 b(rely)g(on)g(laziness)h(to)f(a)o(v)o(oid)g(the)g(creation)h
(of)f(large)g(in)o(termediate)g(structures)j(\(Hughes,)100
710 y(1989\).)10 b(As)i(noted)g(b)o(y)g(W)m(adler)f(\(1985;)f(1992b\),)h
(what)g(is)h(needed)h(to)f(solv)o(e)g(the)g(problem)e(with)100
764 y Ff(many)15 b Fq(is)i(a)f(means)g(to)h(mak)o(e)e(explicit)h(that)h(the)g
(parser)h Ff(many)j(p)16 b Fq(alw)o(a)o(ys)g(succeeds.)i(\(Ev)o(en)100
818 y(if)d Ff(p)h Fq(itself)g(alw)o(a)o(ys)g(fails,)e Ff(many)21
b(p)16 b Fq(will)f(still)h(succeed,)i(with)e(the)h(empt)o(y)e(list)h(as)g
(the)h(result)100 872 y(v)n(alue.\))c(This)g(is)h(the)h(purp)q(ose)g(of)e
(the)h Ff(force)f Fq(com)o(binator:)165 949 y Ff(force)43 b(::)21
b(Parser)f(a)i(->)f(Parser)g(a)165 1003 y(force)g(p)g(=)h(\\inp)f(->)g(let)g
(x)h(=)g(p)f(inp)g(in)557 1057 y(\(fst)g(\(head)g(x\),)g(snd)g(\(head)g
(x\)\))g(:)h(tail)f(x)100 1135 y Fq(Giv)o(en)12 b(a)g(parser)i
Ff(p)f Fq(that)g(alw)o(a)o(ys)f(succeeds,)j(the)e(parser)h
Ff(force)21 b(p)13 b Fq(has)g(the)g(same)f(b)q(eha)o(viour)100
1189 y(as)j Ff(p)p Fq(,)f(except)i(that)g(b)q(efore)f(an)o(y)g(parsing)g(of)f
(the)i(input)e(string)i(is)e(attempted)h(the)h(result)g(of)100
1243 y(the)c(parser)h(is)f(imm)o(ediately)d(forced)j(to)g(tak)o(e)g(on)f(the)
i(form)d(\()p Fe(?)p Fh(;)d Fe(?)p Fq(\))j(:)h Fe(?)p Fq(,)f(where)j
Fe(?)e Fq(represen)o(ts)100 1297 y(a)i(presen)o(tly)i(unde\014ned)g(v)n
(alue.)141 1351 y(Using)f Ff(force)p Fq(,)e(the)j Ff(many)e
Fq(com)o(binator)f(can)i(b)q(e)g(re-de\014ned)i(as)e(follo)o(ws:)165
1429 y Ff(many)43 b(::)21 b(Parser)g(a)g(->)h(Parser)e([a])165
1483 y(many)h(p)h(=)f(force)g(\([x:xs)f(|)i(x)g(<-)f(p,)g(xs)h(<-)f(many)g
(p])g(++)h([[]]\))100 1560 y Fq(The)15 b(use)h(of)e Ff(force)g
Fq(ensures)j(that)e Ff(many)21 b(p)15 b Fq(and)g(all)e(of)i(its)g(recursiv)o
(e)h(calls)f(return)h(at)f(least)100 1614 y(one)f(result.)g(The)g(new)g
(de\014nition)g(of)f Ff(many)g Fq(no)o(w)h(has)g(the)g(exp)q(ected)i(b)q(eha)
o(viour)e(under)g(lazy)100 1668 y(ev)n(aluation.)c(F)m(or)i(example,)f
(applying)g Ff(many)21 b(\(char)f('a'\))12 b Fq(to)g(the)h
(partially-de\014ned)f(string)100 1707 y Fd(0)111 1722 y Ff(a)133
1707 y Fd(0)159 1722 y Fq(:)i Fe(?)h Fq(giv)o(es)h(the)g(partially-de\014ned)
f(result)i(\()856 1707 y Fd(0)868 1722 y Ff(a)890 1707 y Fd(0)916
1722 y Fq(:)d Fe(?)p Fh(;)7 b Fe(?)p Fq(\))13 b(:)h Fe(?)p
Fq(.)g(In)i(con)o(trast,)g(with)f(the)i(old)100 1776 y(v)o(ersion)d(of)f
Ff(many)p Fq(,)f(the)j(result)g(for)e(this)h(example)f(is)g(the)i(completely)
e(unde\014ned)i(v)n(alue)e Fe(?)p Fq(.)141 1830 y(Some)j(readers)i(migh)o(t)c
(w)o(onder)j(wh)o(y)g Ff(force)e Fq(is)i(de\014ned)h(using)e(the)h(follo)o
(wing)d(selection)100 1884 y(functions,)f(rather)i(than)f(b)o(y)f(pattern)i
(matc)o(hing?)165 1962 y Ff(fst)21 b(::)h(\(a,b\))e(->)i(a)130
b(head)21 b(::)h([a])f(->)g(a)165 2016 y(snd)g(::)h(\(a,b\))e(->)i(b)130
b(tail)21 b(::)h([a])f(->)g([a])100 2094 y Fq(The)16 b(answ)o(er)h(is)f
(that,)f(dep)q(ending)i(on)f(the)h(seman)o(tics)e(of)h(patterns)h(in)f(the)g
(particular)g(im-)100 2148 y(plemen)o(tation)h(language,)g(a)h(de\014nition)g
(of)g Ff(force)g Fq(using)g(patterns)i(migh)o(t)c(not)j(ha)o(v)o(e)f(the)100
2202 y(exp)q(ected)e(b)q(eha)o(viour)d(under)i(lazy)e(ev)n(aluation.)483
2333 y Fg(5.3)23 b(Limiting)17 b(the)g(numb)n(er)f(of)h(r)n(esults)100
2413 y Fq(Consider)d(the)h(simple)e(problem)f(of)i(parsing)g(a)g(natural)f(n)
o(um)o(b)q(er,)g(or)i(if)e(no)h(suc)o(h)h(n)o(um)o(b)q(er)e(is)100
2467 y(presen)o(t)i(just)e(returning)h(the)g(n)o(um)o(b)q(er)f(0)g(as)h(the)g
(default)f(result.)h(A)f(\014rst)i(appro)o(ximation)10 b(to)100
2521 y(suc)o(h)k(a)g(parser)h(migh)o(t)d(b)q(e)i(as)g(follo)o(ws:)165
2599 y Ff(number)21 b(::)g(Parser)f(Int)165 2653 y(number)42
b(=)22 b(nat)f(++)g([0])p eop
%%Page: 21 21
21 20 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(21)100 278 y(Ho)o(w)o(ev)o(er,)16 b(this)g(do)q(es)h(not)e(quite)i(ha)o
(v)o(e)e(the)i(required)g(b)q(eha)o(viour.)e(F)m(or)h(example,)e(applying)100
332 y Ff(number)c Fq(to)i(the)h(input)f Ff("hello")f Fq(giv)o(es)h(the)g
(correct)i(result)f Ff([\(0,"hello"\)])p Fq(.)c(On)k(the)f(other)100
386 y(hand,)e(applying)g Ff(number)g Fq(to)h Ff("123")f Fq(giv)o(es)h(the)h
(result)g Ff([\(123,""\),)20 b(\(0,"123"\)])p Fq(,)9 b(whereas)100
440 y(w)o(e)14 b(only)f(really)g(w)o(an)o(t)h(the)g(single)g(result)g
Ff([\(123,""\)])p Fq(.)141 494 y(One)i(solution)f(to)h(the)g(ab)q(o)o(v)o(e)f
(problem)f(is)i(to)f(mak)o(e)f(use)j(of)e Fi(deterministic)i
Fq(parser)f(com-)100 548 y(binators)d(\(see)i(section)g(7.5\))d(|)h(all)g
(parsers)i(built)e(using)g(suc)o(h)i(com)o(binators)d(are)i(restricted)100
602 y(b)o(y)e(construction)h(to)f(pro)q(ducing)g(at)g(most)f(one)i(result.)f
(A)h(more)e(general)h(solution,)f(ho)o(w)o(ev)o(er,)100 656
y(is)16 b(to)h(retain)g(the)h(\015exibilit)o(y)d(of)i(the)g
(non-deterministic)f(com)o(binators,)f(but)j(to)e(pro)o(vide)h(a)100
710 y(means)d(to)g(mak)o(e)g(explicit)g(that)h(w)o(e)g(are)g(only)f(in)o
(terested)j(in)d(the)i(\014rst)f(result)h(pro)q(duced)g(b)o(y)100
764 y(certain)e(parsers,)h(suc)o(h)g(as)f Ff(number)p Fq(.)e(This)i(is)f(the)
i(purp)q(ose)g(of)e(the)i Ff(first)d Fq(com)o(binator:)165
845 y Ff(first)43 b(::)21 b(Parser)f(a)i(->)f(Parser)g(a)165
899 y(first)g(p)g(=)h(\\inp)f(->)g(case)g(p)h(inp)f(of)623
953 y([])108 b(->)22 b([])623 1007 y(\(x:xs\))e(->)i([x])100
1088 y Fq(Giv)o(en)17 b(a)h(parser)h Ff(p)p Fq(,)e(the)i(parser)g
Ff(first)i(p)c Fq(has)i(the)f(same)f(b)q(eha)o(viour)h(as)g
Ff(p)p Fq(,)f(except)j(that)100 1142 y(only)12 b(the)i(\014rst)g(result)h
(\(if)d(an)o(y\))h(is)h(returned.)g(Using)f Ff(first)g Fq(w)o(e)g(can)h
(de\014ne)g(a)f(deterministic)100 1196 y(v)o(ersion)h Ff(\(+++\))e
Fq(of)i(the)g(standard)h(c)o(hoice)f(com)o(binator)e Ff(\(++\))h
Fq(for)h(parsers:)165 1276 y Ff(\(+++\))43 b(::)21 b(Parser)f(a)i(->)f
(Parser)g(a)h(->)f(Parser)g(a)165 1330 y(p)h(+++)f(q)g(=)h(first)f(\(p)g(++)g
(q\))100 1411 y Fq(Replacing)13 b Ff(\(++\))g Fq(b)o(y)g Ff(\(+++\))g
Fq(in)h Ff(number)e Fq(giv)o(es)i(the)g(desired)h(b)q(eha)o(viour.)141
1465 y(As)e(w)o(ell)e(as)h(b)q(eing)g(used)h(to)e(ensure)j(the)e(correct)i(b)
q(eha)o(viour)e(of)f(parsers,)i(using)f Ff(\(+++\))f Fq(can)100
1519 y(also)j(impro)o(v)o(e)f(their)j(e\016ciency)m(.)e(As)i(an)f(example,)e
(consider)j(a)e(parser)i(that)g(accepts)g(either)100 1573 y(of)d(the)h
(strings)h Ff("yellow")d Fq(or)i Ff("orange")p Fq(:)165 1654
y Ff(colour)21 b(::)g(Parser)f(String)165 1708 y(colour)42
b(=)22 b(p1)f(++)h(p2)383 1762 y(where)448 1816 y(p1)g(=)f(string)g("yellow")
448 1870 y(p2)h(=)f(string)g("orange")100 1951 y Fq(Recall)13
b(no)o(w)i(the)g(b)q(eha)o(viour)f(of)g(the)h(c)o(hoice)h(com)o(binator)c
Ff(\(++\))p Fq(:)i(it)g(tak)o(es)h(a)f(string,)g(applies)100
2005 y(b)q(oth)g(argumen)o(t)f(parsers)j(to)e(this)g(string,)f(and)h
(concatenates)i(the)f(resulting)f(lists.)g(Th)o(us)g(in)100
2059 y(the)f Ff(colour)e Fq(example,)f(if)i Ff(p1)g Fq(is)g(successfully)i
(applied)e(then)h Ff(p2)f Fq(will)f(still)g(b)q(e)i(applied)f(to)g(the)100
2113 y(same)i(string,)h(ev)o(en)h(though)f(it)g(is)g(guaran)o(teed)h(to)f
(fail.)e(This)j(ine\016ciency)f(can)h(b)q(e)g(a)o(v)o(oided)100
2167 y(using)d Ff(\(+++\))p Fq(,)g(whic)o(h)g(ensures)j(that)e(if)f
Ff(p1)h Fq(succeeds)i(then)f Ff(p2)e Fq(is)h(nev)o(er)h(applied:)165
2248 y Ff(colour)21 b(=)g(p1)h(+++)f(p2)361 2302 y(where)427
2356 y(p1)g(=)g(string)g("yellow")427 2410 y(p2)g(=)g(string)g("orange")100
2491 y Fq(More)14 b(generally)m(,)e(if)h(w)o(e)i(kno)o(w)e(that)h(a)f(parser)
i(of)f(the)g(form)e Ff(p)22 b(++)f(q)14 b Fq(is)f(deterministic)h(\(only)100
2545 y(ev)o(er)e(returns)h(at)e(most)f(one)i(result)g(v)n(alue\),)f(then)h
Ff(p)21 b(+++)g(q)12 b Fq(has)f(the)h(same)f(b)q(eha)o(viour,)f(but)i(is)100
2599 y(more)g(e\016cien)o(t:)g(if)g Ff(p)h Fq(succeeds)j(then)d
Ff(q)g Fq(is)f(nev)o(er)i(applied.)e(In)h(the)g(remainder)g(of)f(this)h
(article)100 2653 y(it)e(will)f(mostly)g(b)q(e)i(the)g Ff(\(+++\))f
Fq(c)o(hoice)h(com)o(binator)e(that)i(is)f(used.)h(F)m(or)f(reasons)i(of)e
(e\016ciency)m(,)p eop
%%Page: 22 22
22 21 bop 100 178 a Fq(22)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(in)e(the)i(com)o(binator)d(libraries)h(that)h(accompan)o
(y)f(this)h(article,)f(the)i(rep)q(etition)f(com)o(binators)100
332 y(from)f(the)i(previous)g(section)h(are)f(de\014ned)h(using)f
Ff(\(+++\))f Fq(rather)i(than)e Ff(\(++\))p Fq(.)141 386 y(W)m(e)j(conclude)h
(this)f(section)h(b)o(y)e(asking)h(wh)o(y)g Ff(first)f Fq(is)g(de\014ned)j(b)
o(y)d(pattern)i(matc)o(hing,)100 440 y(rather)f(than)f(b)o(y)g(using)g(the)h
(selection)g(function)f Ff(take)21 b(::)g(Int)h(->)f([a])g(->)h([a])14
b Fq(\(where,)100 494 y(for)f(example,)f Ff(take)21 b(3)h("parsing")e(=)h
("par")p Fq(\):)165 567 y Ff(first)g(p)g(=)h(\\inp)f(->)g(take)g(1)h(\(p)f
(inp\))100 639 y Fq(The)14 b(answ)o(er)h(concerns)h(the)f(b)q(eha)o(viour)f
(under)h(lazy)f(ev)n(aluation.)f(T)m(o)g(see)j(the)e(problem,)f(let)100
693 y(us)h(unfold)f(the)h(use)h(of)e Ff(take)g Fq(in)h(the)g(ab)q(o)o(v)o(e)g
(de\014nition:)165 766 y Ff(first)21 b(p)g(=)h(\\inp)f(->)g(case)g(p)h(inp)f
(of)623 820 y([])108 b(->)22 b([])623 874 y(\(x:xs\))e(->)i(x)f(:)h(take)f(0)
g(xs)100 947 y Fq(When)14 b(the)h(sub-expression)h Ff(take)21
b(0)g(xs)14 b Fq(is)g(ev)n(aluated,)g(it)g(will)f(yield)g Ff([])p
Fq(.)h(Ho)o(w)o(ev)o(er,)g(under)100 1001 y(lazy)f(ev)n(aluation)g(this)g
(computation)g(will)f(b)q(e)i(susp)q(ended)i(un)o(til)d(its)h(v)n(alue)f(is)h
(required.)h(The)100 1055 y(e\013ect)j(is)e(that)g(the)h(list)f
Ff(xs)g Fq(ma)o(y)e(b)q(e)j(retained)g(in)f(memory)e(for)i(some)g(time,)e
(when)j(in)f(fact)100 1109 y(it)h(can)i(safely)f(b)q(e)g(discarded)h
(immediately)m(.)14 b(This)k(is)g(an)g(example)f(of)h(a)f Fi(sp)n(ac)n(e)j
(le)n(ak)t Fq(.)e(The)100 1163 y(de\014nition)13 b(of)g Ff(first)g
Fq(using)h(pattern)h(matc)o(hing)d(do)q(es)i(not)g(su\013er)h(from)d(this)i
(problem.)587 1289 y Fl(6)24 b(Handling)13 b(lexical)h(issues)100
1367 y Fq(T)m(raditionally)m(,)i(a)k(string)h(to)f(b)q(e)g(parsed)i(is)e(not)
g(supplied)g(directly)h(to)f(a)g(parser,)h(but)f(is)100 1421
y(\014rst)c(passed)h(through)e(a)h(lexical)e(analysis)h(phase)i(\(or)e
Fi(lexer)p Fq(\))h(that)f(breaks)i(the)f(string)g(in)o(to)100
1475 y(a)g(sequence)j(of)d(tok)o(ens)i(\(Aho)f Fi(et)g(al.)p
Fq(,)f(1986\).)f(Lexical)i(analysis)f(is)g(a)h(con)o(v)o(enien)o(t)g(place)g
(to)100 1529 y(remo)o(v)o(e)i(white-space)j(\(spaces,)f(newlines,)g(and)f
(tabs\))h(and)g(commen)o(ts)d(from)h(the)i(input)100 1583 y(string,)13
b(and)h(to)g(distinguish)f(b)q(et)o(w)o(een)i(iden)o(ti\014ers)g(and)e(k)o
(eyw)o(ords.)141 1637 y(Since)i(lexers)g(are)f(just)h(simple)d(parsers,)k
(they)e(can)h(b)q(e)f(built)g(using)g(parser)h(com)o(binators,)100
1691 y(as)h(discussed)i(b)o(y)e(Hutton)g(\(1992\).)f(Ho)o(w)o(ev)o(er,)h(as)g
(w)o(e)g(shall)g(see)h(in)f(this)g(section,)g(the)h(need)100
1745 y(for)f(a)g(separate)h(lexer)g(can)g(often)f(b)q(e)h(a)o(v)o(oided)f
(\(ev)o(en)h(for)f(substan)o(tial)g(grammars)e(suc)o(h)j(as)100
1798 y(that)d(for)h(Gofer\),)f(with)g(lexical)g(issues)h(b)q(eing)g(handled)f
(within)g(the)i(main)c(parser)k(b)o(y)e(using)100 1852 y(some)f(sp)q(ecial)h
(purp)q(ose)h(com)o(binators.)401 1978 y Fg(6.1)23 b(White-sp)n(ac)n(e,)16
b(c)n(omments,)g(and)h(keywor)n(ds)100 2057 y Fq(W)m(e)d(b)q(egin)h(b)o(y)f
(de\014ning)h(a)f(parser)i(that)e(consumes)h(white-space)h(from)d(the)i(b)q
(eginning)f(of)g(a)100 2111 y(string,)f(with)h(a)f(dumm)o(y)e(v)n(alue)i
Ff(\(\))h Fq(returned)h(as)f(result:)165 2183 y Ff(spaces)21
b(::)g(Parser)f(\(\))165 2237 y(spaces)42 b(=)22 b([\(\))f(|)h(_)f(<-)h
(many1)e(\(sat)h(isSpace\)])383 2291 y(where)448 2345 y(isSpace)g(x)g(=)514
2399 y(\(x)g(==)g(')h('\))f(||)h(\(x)f(==)h('\\n'\))e(||)i(\(x)f(==)g
('\\t'\))100 2472 y Fq(Similarl)o(y)m(,)10 b(a)k(single-line)f(Gofer)g
(commen)o(t)f(can)i(b)q(e)h(consumed)e(as)h(follo)o(ws:)165
2545 y Ff(comment)20 b(::)i(Parser)e(\(\))165 2599 y(comment)42
b(=)22 b([\(\))f(|)g(_)h(<-)f(string)g("--")492 2653 y(,)g(_)h(<-)f(many)g
(\(sat)g(\(\\x)h(->)f(x)h(/=)f('\\n'\)\)])p eop
%%Page: 23 23
23 22 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(23)100 278 y(W)m(e)12 b(lea)o(v)o(e)g(it)g(as)h(an)g(exercise)h(for)e
(the)h(reader)h(to)f(de\014ne)g(a)g(parser)g(for)g(consuming)e(m)o(ulti-line)
100 332 y(Gofer)i(commen)o(ts)f Fe(f)p Ff(-)22 b(...)f(-)p
Fe(g)p Fq(,)13 b(whic)o(h)g(can)i(b)q(e)f(nested.)141 386 y(After)f
(consuming)e(white-space,)i(there)g(ma)o(y)e(still)g(b)q(e)i(a)f(commen)o(t)e
(left)i(to)g(consume)g(from)100 440 y(the)j(input)f(string.)g(Dually)m(,)e
(after)j(a)f(commen)o(t)e(there)k(ma)o(y)c(still)i(b)q(e)h(white-space.)g(Th)
o(us)g(w)o(e)100 494 y(are)c(motiv)n(ated)f(to)h(de\014ned)i(a)e(sp)q(ecial)h
(parser)g(that)g(rep)q(eatedly)g(consumes)g(white-space)g(and)100
548 y(commen)o(ts)g(un)o(til)h(no)g(more)g(remain:)165 629
y Ff(junk)21 b(::)g(Parser)g(\(\))165 683 y(junk)43 b(=)21
b([\(\))h(|)f(_)h(<-)f(many)g(\(spaces)f(+++)i(comment\)])100
764 y Fq(Note)12 b(that)h(while)f Ff(spaces)f Fq(and)h Ff(comment)f
Fq(can)h(fail,)f(the)i Ff(junk)e Fq(parser)j(alw)o(a)o(ys)d(succeeds.)j(W)m
(e)100 818 y(de\014ne)19 b(t)o(w)o(o)e(com)o(binators)g(in)h(terms)f(of)h
Ff(junk)p Fq(:)f Ff(parse)g Fq(remo)o(v)o(es)g(junk)h Fi(b)n(efor)n(e)j
Fq(applying)16 b(a)100 872 y(giv)o(en)d(parser,)i(and)e Ff(token)g
Fq(remo)o(v)o(es)g(junk)h Fi(after)k Fq(applying)12 b(a)i(parser:)165
953 y Ff(parse)43 b(::)21 b(Parser)f(a)i(->)f(Parser)g(a)165
1007 y(parse)g(p)g(=)h([v)f(|)h(_)f(<-)h(junk,)f(v)g(<-)h(p])165
1115 y(token)43 b(::)21 b(Parser)f(a)i(->)f(Parser)g(a)165
1169 y(token)g(p)g(=)h([v)f(|)h(v)f(<-)h(p,)f(_)h(<-)f(junk])100
1249 y Fq(With)16 b(the)h(aid)f(of)g(these)i(t)o(w)o(o)e(com)o(binators,)f
(parsers)j(can)f(b)q(e)h(mo)q(di\014ed)d(to)i(ignore)f(white-)100
1303 y(space)d(and)f(commen)o(ts.)e(Firstly)m(,)h Ff(parse)g
Fq(is)h(applied)f(once)i(to)f(the)h(parser)g(as)g(a)f(whole,)f(ensur-)100
1357 y(ing)i(that)g(input)h(to)g(the)g(parser)h(b)q(egins)f(at)f(a)h
(signi\014can)o(t)f(c)o(haracter.)i(And)f(secondly)m(,)f Ff(token)100
1411 y Fq(is)f(applied)f(once)i(to)f(all)f(sub-parsers)i(that)g(consume)e
(complete)h(tok)o(ens,)g(th)o(us)g(ensuring)h(that)100 1465
y(the)h(input)g(alw)o(a)o(ys)f(remains)g(at)g(a)h(signi\014can)o(t)f(c)o
(haracter.)141 1519 y(Examples)i(of)g(parsers)i(for)e(complete)g(tok)o(ens)h
(are)g Ff(nat)f Fq(and)g Ff(int)g Fq(\(for)g(natural)g(n)o(um)o(b)q(ers)100
1573 y(and)20 b(in)o(tegers\),)h(parsers)g(of)f(the)h(form)d
Ff(string)j(xs)f Fq(\(for)g(sym)o(b)q(ols)f(and)h(k)o(eyw)o(ords\),)g(and)100
1627 y Ff(ident)12 b Fq(\(for)g(iden)o(ti\014ers\).)i(It)f(is)g(useful)g(to)g
(de\014ne)h(sp)q(ecial)f(v)o(ersions)g(of)g(these)h(parsers)h(|)d(and)100
1681 y(more)h(generally)m(,)g(sp)q(ecial)i(v)o(ersions)g(of)f(an)o(y)f
(user-de\014ned)k(parsers)f(for)e(complete)g(tok)o(ens)h(|)100
1735 y(that)f(encapsulate)g(the)h(necessary)h(application)c(of)i
Ff(token)p Fq(:)165 1816 y Ff(natural)129 b(::)22 b(Parser)e(Int)165
1870 y(natural)151 b(=)22 b(token)e(nat)165 1978 y(integer)129
b(::)22 b(Parser)e(Int)165 2032 y(integer)151 b(=)22 b(token)e(int)165
2140 y(symbol)151 b(::)22 b(String)e(->)i(Parser)e(String)165
2194 y(symbol)h(xs)108 b(=)22 b(token)e(\(string)h(xs\))165
2302 y(identifier)63 b(::)22 b([String])e(->)h(Parser)g(String)165
2356 y(identifier)f(ks)h(=)h(token)e([x)i(|)f(x)h(<-)f(ident,)g(not)g(\(elem)
g(x)g(ks\)])100 2437 y Fq(Note)16 b(that)g Ff(identifier)d
Fq(tak)o(es)j(a)g(list)f(of)g(k)o(eyw)o(ords)h(as)g(an)g(argumen)o(t,)e
(where)j(a)e(k)o(eyw)o(ord)100 2491 y(is)f(a)f(string)i(that)f(is)g(not)g(p)q
(ermitted)g(as)g(an)g(iden)o(ti\014er.)g(F)m(or)g(example,)e(in)i(Gofer)g
(the)h(strings)100 2545 y(\\)p Ff(data)p Fq(")h(and)i(\\)p
Ff(where)p Fq(")f(\(among)f(others\))j(are)g(k)o(eyw)o(ords.)f(Without)g(the)
g(k)o(eyw)o(ord)g(c)o(hec)o(k,)100 2599 y(parsers)11 b(de\014ned)h(in)d
(terms)h(of)g Ff(identifier)e Fq(could)i(pro)q(duce)h(unexp)q(ected)h
(results,)f(or)f(in)o(v)o(olv)o(e)100 2653 y(unnecessary)16
b(bac)o(ktrac)o(king)d(to)h(construct)i(the)e(correct)i(parse)e(of)g(the)g
(input)g(string.)p eop
%%Page: 24 24
24 23 bop 100 178 a Fq(24)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)523 278 y Fg(6.2)24 b(A)17 b(p)n(arser)f(for)g Fh(\025)p
Fg(-expr)n(essions)100 359 y Fq(T)m(o)c(illustrate)i(the)g(use)g(of)f(the)i
(new)f(com)o(binators)e(giv)o(en)h(ab)q(o)o(v)o(e,)g(let)h(us)g(de\014ne)g(a)
g(parser)g(for)100 413 y(simple)f Fh(\025)p Fq(-expressions)j(extended)g
(with)e(a)g(\\)p Ff(let)p Fq(")f(construct)j(for)e(lo)q(cal)g(de\014nitions.)
g(P)o(arsed)100 467 y(expressions)h(will)d(b)q(e)j(represen)o(ted)i(in)c
(Gofer)h(as)g(follo)o(ws:)165 553 y Ff(data)21 b(Expr)g(=)h(App)f(Expr)g
(Expr)260 b(--)22 b(application)383 607 y(|)g(Lam)f(String)f(Expr)217
b(--)22 b(lambda)e(abstraction)383 661 y(|)i(Let)f(String)f(Expr)h(Expr)108
b(--)22 b(local)e(definition)383 715 y(|)i(Var)f(String)325
b(--)22 b(variable)100 800 y Fq(No)o(w)13 b(a)h(parser)h Ff(expr)21
b(::)g(Parser)g(Expr)13 b Fq(can)h(b)q(e)g(de\014ned)h(b)o(y:)165
885 y Ff(expr)108 b(=)22 b(atom)f(`chainl1`)f([App])165 993
y(atom)108 b(=)22 b(lam)f(+++)g(local)g(+++)g(var)g(+++)g(paren)165
1101 y(lam)130 b(=)22 b([Lam)f(x)g(e)h(|)f(_)h(<-)f(symbol)g("\\\\")601
1155 y(,)g(x)h(<-)f(variable)601 1209 y(,)g(_)h(<-)f(symbol)g("->")601
1263 y(,)g(e)h(<-)f(expr])165 1371 y(local)86 b(=)22 b([Let)f(x)g(e)h(e')f(|)
h(_)43 b(<-)22 b(symbol)e("let")666 1425 y(,)i(x)43 b(<-)22
b(variable)666 1479 y(,)g(_)43 b(<-)22 b(symbol)e("=")666 1533
y(,)i(e)43 b(<-)22 b(expr)666 1587 y(,)g(_)43 b(<-)22 b(symbol)e("in")666
1641 y(,)i(e')f(<-)h(expr])165 1749 y(var)130 b(=)22 b([Var)f(x)g(|)h(x)f(<-)
h(variable])165 1857 y(paren)86 b(=)22 b(bracket)e(\(symbol)g("\("\))h(expr)g
(\(symbol)g("\)"\))165 1965 y(variable)f(=)i(identifier)d(["let","in"])100
2050 y Fq(Note)13 b(ho)o(w)g(the)h Ff(expr)e Fq(parser)i(handles)g
(white-space)g(and)f(commen)o(ts)f(b)o(y)h(using)f(the)i Ff(symbol)100
2104 y Fq(parser)k(in)e(place)h(of)f Ff(string)f Fq(and)i Ff(char)p
Fq(.)f(Similarl)o(y)m(,)d(the)k(k)o(eyw)o(ords)h(\\)p Ff(let)p
Fq(")d(and)i(\\)p Ff(in)p Fq(")f(are)100 2158 y(handled)e(b)o(y)h(using)f
Ff(identifier)f Fq(to)i(de\014ne)h(the)f(parser)h(for)e(v)n(ariables.)g
(Finally)m(,)e(note)j(ho)o(w)100 2212 y(applications)h Ff(\(f)22
b(e1)f(e2)h(...)f(en\))c Fq(are)h(parsed)h(in)e(the)i(form)d
Ff(\(\(\(f)21 b(e1\))g(e2\))g(...)h(\))17 b Fq(b)o(y)100 2266
y(using)c(the)i Ff(chainl1)d Fq(com)o(binator.)517 2409 y Fl(7)23
b(F)l(actorising)14 b(the)g(parser)h(monad)100 2491 y Fq(Up)g(to)f(this)h(p)q
(oin)o(t)g(in)f(the)i(article,)e(com)o(binator)f(parsers)j(ha)o(v)o(e)f(b)q
(een)h(our)f(only)f(example)g(of)100 2545 y(the)g(notion)e(of)h(a)g(monad.)e
(In)j(this)f(section)i(w)o(e)e(de\014ne)i(a)e(n)o(um)o(b)q(er)g(of)f(other)i
(monads)e(related)100 2599 y(to)j(the)h(parser)h(monad,)c(leading)i(up)g(to)h
(a)f(mo)q(dular)f(reform)o(ulation)f(of)i(the)h(parser)h(monad)100
2653 y(in)d(terms)h(of)f(t)o(w)o(o)h(simpler)e(monads)h(\(Jones,)h(1995a\).)f
(The)h(immediate)d(b)q(ene\014t)17 b(is)d(that,)h(as)p eop
%%Page: 25 25
25 24 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(25)100 278 y(w)o(e)15 b(shall)g(see,)h(the)g(basic)f(parser)i(com)o
(binators)d(no)h(longer)g(need)h(to)f(b)q(e)h(de\014ned)h(explicitly)m(.)100
332 y(Rather,)c(they)g(arise)h(automatically)c(as)j(a)g(sp)q(ecial)h(case)g
(of)e(lifting)g(monad)f(op)q(erations)j(from)100 386 y(a)f(base)i(monad)d
Fh(m)j Fq(to)f(a)g(certain)g(other)h(monad)d(parameterised)i(o)o(v)o(er)g
Fh(m)p Fq(.)g(This)g(also)g(means)100 440 y(that,)d(if)g(w)o(e)h(c)o(hange)h
(the)f(nature)h(of)e(parsers)i(b)o(y)f(mo)q(difying)d(the)j(base)h(monad)d
(\(for)i(example,)100 494 y(limiti)o(ng)d(parsers)k(to)e(pro)q(ducing)g(at)h
(most)e(one)i(result\),)f(new)h(com)o(binators)e(for)h(the)h(mo)q(di\014ed)
100 548 y(monad)g(of)h(parsers)i(are)g(also)e(de\014ned)i(automatically)l(.)
579 687 y Fg(7.1)23 b(The)17 b(exc)n(eption)f(monad)100 768
y Fq(Before)k(starting)f(to)h(de\014ne)g(other)g(monads,)e(it)h(is)g(useful)h
(to)f(\014rst)i(fo)q(cus)e(brie\015y)h(on)f(the)100 822 y(in)o(tuition)12
b(b)q(ehind)i(the)h(use)g(of)e(monads)f(in)i(functional)f(programmi)o(ng)e
(\(W)m(adler,)i(1992a\).)141 877 y(The)k(basic)g(idea)f(b)q(ehind)h(monads)e
(is)i(to)f(distinguish)g(the)i Fi(values)i Fq(that)c(a)h(computation)100
931 y(can)f(pro)q(duce)i(from)d(the)i Fi(c)n(omputation)k Fq(itself.)16
b(More)h(sp)q(eci\014cally)m(,)f(giv)o(en)g(a)g(monad)f Ff(m)h
Fq(and)100 985 y(a)i(t)o(yp)q(e)g Ff(a)p Fq(,)g(w)o(e)g(can)g(think)g(of)g
Ff(m)j(a)d Fq(as)h(the)f(t)o(yp)q(e)h(of)f(computations)e(that)j(yield)e
(results)j(of)100 1039 y(t)o(yp)q(e)e Ff(a)p Fq(,)e(with)i(the)g(nature)g(of)
f(the)h(computation)e(captured)i(b)o(y)f(the)i(t)o(yp)q(e)f(constructor)h
Ff(m)p Fq(.)100 1093 y(The)c(com)o(binators)e Ff(result)g Fq(and)h
Ff(bind)g Fq(\(with)h Ff(zero)e Fq(and)i Ff(\(++\))e Fq(if)h(appropriate\))h
(pro)o(vide)f(a)100 1147 y(means)f(to)g(structure)j(the)f(building)d(of)i
(suc)o(h)g(computations:)165 1232 y Ff(result)21 b(::)g(m)h(a)165
1286 y(bind)65 b(::)21 b(m)h(a)f(->)g(\(a)h(->)f(m)h(b\))f(->)h(m)f(b)165
1340 y(zero)65 b(::)21 b(m)h(a)165 1394 y(\(++\))65 b(::)21
b(m)h(a)f(->)g(m)h(a)g(->)f(m)h(a)100 1479 y Fq(F)m(rom)17
b(a)i(computational)e(p)q(oin)o(t)h(of)h(view,)g Ff(result)f
Fq(con)o(v)o(erts)i(v)n(alues)f(in)o(to)f(computations)100
1533 y(that)d(yield)h(those)g(v)n(alues;)f Ff(bind)g Fq(c)o(hains)g(t)o(w)o
(o)h(computations)e(together)j(in)e(sequence,)i(with)100 1587
y(results)d(of)f(the)h(\014rst)g(computation)e(b)q(eing)h(made)f(a)o(v)n
(ailable)f(for)i(use)i(in)e(the)h(second;)g Ff(zero)e Fq(is)100
1641 y(the)i(trivial)e(computation)g(that)i(do)q(es)h(nothing;)d(and)i
(\014nally)m(,)e Ff(\(++\))h Fq(is)g(some)g(kind)g(of)g(c)o(hoice)100
1695 y(op)q(eration)g(for)h(computations.)141 1749 y(Consider,)g(for)g
(example,)e(the)i(t)o(yp)q(e)h(constructor)g Ff(Maybe)p Fq(:)165
1834 y Ff(data)21 b(Maybe)g(a)g(=)h(Just)f(a)g(|)h(Nothing)100
1919 y Fq(W)m(e)10 b(can)i(think)e(of)h(a)g(v)n(alue)f(of)h(t)o(yp)q(e)g
Ff(Maybe)21 b(a)11 b Fq(as)g(a)g(computation)e(that)j(either)g(succeeds)h
(with)100 1973 y(a)j(v)n(alue)f(of)h(t)o(yp)q(e)h Ff(a)p Fq(,)e(or)i(fails,)d
(pro)q(ducing)j(no)f(v)n(alue.)f(Th)o(us,)h(the)h(t)o(yp)q(e)g(constructor)h
Ff(Maybe)100 2027 y Fq(captures)d(computations)e(that)g(ha)o(v)o(e)h(the)h(p)
q(ossibilit)o(y)d(to)i(fail.)141 2082 y(De\014ning)j(the)h(monad)d(com)o
(binators)h(for)h(a)f(giv)o(en)h(t)o(yp)q(e)h(constructor)h(is)e(usually)f
(just)h(a)100 2136 y(matter)12 b(of)h(making)d(the)k(\\ob)o(vious)e
(de\014nitions")h(suggested)h(b)o(y)f(the)h(t)o(yp)q(es)g(of)e(the)i(com)o
(bina-)100 2189 y(tors.)i(F)m(or)f(example,)g(the)h(t)o(yp)q(e)h(constructor)
h Ff(Maybe)c Fq(can)j(b)q(e)f(made)f(in)o(to)h(a)f(monad)g(with)g(a)100
2243 y(zero)f(and)g(plus)g(using)g(the)g(follo)o(wing)d(de\014nitions:)165
2329 y Ff(instance)20 b(Monad)h(Maybe)g(where)230 2383 y(--)h(result)173
b(::)21 b(a)h(->)f(Maybe)g(a)230 2437 y(result)g(x)218 b(=)21
b(Just)g(x)230 2545 y(--)h(bind)217 b(::)21 b(Maybe)g(a)h(->)f(\(a)g(->)h
(Maybe)e(b\))i(->)f(Maybe)g(b)230 2599 y(\(Just)g(x\))h(`bind`)e(f)i(=)f(f)h
(x)230 2653 y(Nothing)43 b(`bind`)20 b(f)i(=)f(Nothing)p eop
%%Page: 26 26
26 25 bop 100 178 a Fq(26)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)165 332 y Ff(instance)20 b(Monad0Plus)g(Maybe)h(where)230
386 y(--)h(zero)217 b(::)21 b(Maybe)g(a)230 440 y(zero)305
b(=)21 b(Nothing)230 548 y(--)h(\(++\))217 b(::)21 b(Maybe)g(a)h(->)f(Maybe)g
(a)g(->)h(Maybe)e(a)230 602 y(Just)h(x)44 b(++)21 b(y)131 b(=)21
b(Just)g(x)230 656 y(Nothing)g(++)g(y)131 b(=)21 b(y)100 731
y Fq(That)13 b(is,)f Ff(result)g Fq(con)o(v)o(erts)i(a)f(v)n(alue)g(in)o(to)f
(a)h(computation)e(that)i(succeeds)j(with)d(this)g(v)n(alue;)100
785 y Ff(bind)h Fq(is)g(a)h(sequencing)h(op)q(erator,)f(with)f(a)h
(successful)i(result)e(from)f(the)h(\014rst)h(computation)100
839 y(b)q(eing)h(a)o(v)n(ailable)d(for)j(use)h(in)e(the)i(second)g
(computation;)c Ff(zero)i Fq(is)h(the)h(computation)d(that)100
893 y(fails;)h(and)j(\014nally)m(,)d Ff(\(++\))i Fq(is)g(a)g
(\(deterministic\))h(c)o(hoice)g(op)q(erator)g(that)f(returns)i(the)f
(\014rst)100 947 y(computation)12 b(if)h(it)g(succeeds,)j(and)e(the)h(second)
g(otherwise.)141 1001 y(Since)j(failure)e(can)i(b)q(e)g(view)o(ed)f(as)g(a)g
(simple)f(kind)g(of)h(exception,)h Ff(Maybe)e Fq(is)h(sometimes)100
1054 y(called)c(the)i Fi(exc)n(eption)i Fq(monad)c(in)g(the)h(literature)h
(\(Spiv)o(ey)m(,)e(1990\).)498 1183 y Fg(7.2)23 b(The)17 b(non-determinism)f
(monad)100 1262 y Fq(A)e(natural)g(generalisation)g(of)g Ff(Maybe)g
Fq(is)g(the)h(list)g(t)o(yp)q(e)g(constructor)h Ff([])p Fq(.)e(While)f(a)i(v)
n(alue)f(of)100 1316 y(t)o(yp)q(e)e Ff(Maybe)20 b(a)12 b Fq(can)f(b)q(e)h
(though)o(t)g(of)f(as)g(a)g(computation)f(that)i(either)g(succeeds)i(with)d
(a)g(single)100 1370 y(result)17 b(of)f(t)o(yp)q(e)h(a)f(or)g(fails,)f(a)h(v)
n(alue)g(of)g(t)o(yp)q(e)h Ff([a])e Fq(can)i(b)q(e)g(though)o(t)f(of)g(as)h
(a)f(computation)100 1424 y(that)e(has)g(the)h(p)q(ossibilit)o(y)e(to)h
(succeed)i(with)e(an)o(y)f(n)o(um)o(b)q(er)h(of)f(results)i(of)f(t)o(yp)q(e)h
Ff(a)p Fq(,)e(including)100 1478 y(zero)k(\(whic)o(h)g(represen)o(ts)j
(failure\).)c(Th)o(us)h(the)h(list)e(t)o(yp)q(e)i(constructor)g
Ff([])f Fq(can)g(b)q(e)g(used)h(to)100 1532 y(capture)d Fi(non-deterministic)
h Fq(computations.)141 1585 y(No)o(w)e Ff([])f Fq(can)h(b)q(e)h(made)d(in)o
(to)i(a)f(monad)f(with)i(a)f(zero)i(and)f(plus:)165 1660 y
Ff(instance)20 b(Monad)h([])g(where)230 1714 y(--)h(result)129
b(::)22 b(a)f(->)h([a])230 1768 y(result)f(x)174 b(=)22 b([x])230
1876 y(--)g(bind)173 b(::)22 b([a])f(->)g(\(a)h(->)f([b]\))g(->)g([b])230
1930 y([])109 b(`bind`)20 b(f)i(=)g([])230 1984 y(\(x:xs\))f(`bind`)f(f)i(=)g
(f)f(x)h(++)f(\(xs)g(`bind`)g(f\))165 2092 y(instance)f(Monad0Plus)g([])h
(where)230 2146 y(--)h(zero)173 b(::)22 b([a])230 2200 y(zero)261
b(=)22 b([])230 2308 y(--)g(\(++\))173 b(::)22 b([a])f(->)g([a])g(->)h([a])
230 2362 y([])109 b(++)21 b(ys)87 b(=)22 b(ys)230 2416 y(\(x:xs\))f(++)g(ys)
87 b(=)22 b(x)f(:)h(\(xs)f(++)g(ys\))100 2491 y Fq(That)13
b(is,)g Ff(result)f Fq(con)o(v)o(erts)i(a)f(v)n(alue)g(in)o(to)g(a)g
(computation)e(that)j(succeeds)i(with)d(this)g(single)100 2545
y(v)n(alue;)h Ff(bind)g Fq(is)g(a)h(sequencing)h(op)q(erator)g(for)e
(non-deterministic)h(computations;)e Ff(zero)h Fq(al-)100 2599
y(w)o(a)o(ys)g(fails;)g(and)g(\014nally)m(,)f Ff(\(++\))h Fq(is)h(a)g
(\(non-deterministic\))f(c)o(hoice)i(op)q(erator)f(that)g(app)q(ends)100
2653 y(the)f(results)h(of)e(the)i(t)o(w)o(o)e(argumen)o(t)g(computations.)p
eop
%%Page: 27 27
27 26 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(27)493 278 y Fg(7.3)23 b(The)17 b(state-tr)n(ansformer)e(monad)100
359 y Fq(Consider)f(the)g(\(binary\))g(t)o(yp)q(e)h(constructor)g
Ff(State)p Fq(:)165 440 y Ff(type)21 b(State)g(s)g(a)h(=)f(s)h(->)f(\(a,s\))
100 521 y Fq(V)m(alues)11 b(of)g(t)o(yp)q(e)g Ff(State)21 b(s)h(a)11
b Fq(can)g(b)q(e)h(in)o(terpreted)h(as)f(follo)o(ws:)d(they)j(are)g
(computations)e(that)100 575 y(tak)o(e)i(an)g(initial)e(state)k(of)d(t)o(yp)q
(e)i Ff(s)p Fq(,)f(and)g(yield)g(a)g(v)n(alue)f(of)h(t)o(yp)q(e)h
Ff(a)f Fq(together)h(with)f(a)g(new)h(state)100 629 y(of)k(t)o(yp)q(e)h
Ff(s)p Fq(.)e(Th)o(us,)i(the)g(t)o(yp)q(e)g(constructor)h Ff(State)i(s)c
Fq(obtained)g(b)o(y)g(applying)g Ff(State)f Fq(to)h(a)100 683
y(single)e(t)o(yp)q(e)h Ff(s)f Fq(captures)i(computations)d(that)i(in)o(v)o
(olv)o(e)e(state)j(of)d(t)o(yp)q(e)j Ff(s)p Fq(.)d(W)m(e)h(will)g(refer)h(to)
100 737 y(v)n(alues)d(of)h(t)o(yp)q(e)g Ff(State)21 b(s)g(a)14
b Fq(as)g Fi(stateful)g(c)n(omputations)s Fq(.)141 791 y(No)o(w)g
Ff(State)20 b(s)14 b Fq(can)g(b)q(e)h(made)d(in)o(to)i(a)f(monad:)165
872 y Ff(instance)20 b(Monad)h(\(State)f(s\))i(where)230 926
y(--)g(result)42 b(::)21 b(a)h(->)f(State)g(s)h(a)230 980 y(result)f(v)87
b(=)21 b(\\s)h(->)f(\(v,s\))230 1088 y(--)h(bind)86 b(::)21
b(State)g(s)h(a)f(->)h(\(a)f(->)h(State)e(s)i(b\))f(->)h(State)e(s)i(b)230
1142 y(st)g(`bind`)e(f)i(=)f(\\s)h(->)f(let)g(\(v,s'\))g(=)h(st)f(s)h(in)f(f)
g(v)h(s')100 1222 y Fq(That)10 b(is,)h Ff(result)e Fq(con)o(v)o(erts)j(a)f(v)
n(alue)f(in)o(to)g(a)h(stateful)g(computation)e(that)i(returns)i(that)e(v)n
(alue)100 1276 y(without)f(mo)q(difying)e(the)j(in)o(ternal)g(state,)g(and)f
Ff(bind)g Fq(comp)q(oses)h(t)o(w)o(o)f(stateful)h(computations)100
1330 y(in)18 b(sequence,)j(with)e(the)g(result)h(v)n(alue)f(from)e(the)i
(\014rst)h(b)q(eing)f(supplied)g(as)h(input)e(to)h(the)100
1384 y(second.)12 b(Thinking)f(pictorially)f(in)i(terms)g(of)f(b)q(o)o(xes)h
(and)g(wires)h(is)e(a)h(useful)g(aid)f(to)h(b)q(ecoming)100
1438 y(famili)o(ar)f(with)j(these)h(t)o(w)o(o)e(op)q(erations)i(\(Jones)f(&)h
(Launc)o(h)o(bury)m(,)e(1994\).)141 1492 y(The)f Fi(state-tr)n(ansformer)e
Fq(monad)g Ff(State)21 b(s)11 b Fq(do)q(es)i(not)e(ha)o(v)o(e)h(a)f(zero)i
(and)e(a)h(plus.)f(Ho)o(w)o(ev)o(er,)100 1546 y(as)h(w)o(e)g(shall)f(see)j
(in)d(the)i(next)g(section,)f(the)h Fi(p)n(ar)n(ameterise)n(d)i
Fq(state-transformer)e(monad)d(o)o(v)o(er)100 1600 y(a)j(giv)o(en)h(based)g
(monad)e Ff(m)i Fi(do)n(es)j Fq(ha)o(v)o(e)d(a)g(zero)h(and)e(a)h(plus,)f
(pro)o(vided)h(that)g Ff(m)g Fq(do)q(es.)141 1654 y(T)m(o)i(allo)o(w)f(us)i
(to)f(access)i(and)f(mo)q(dify)d(the)j(in)o(ternal)f(state,)h(a)f(few)g
(extra)h(op)q(erations)g(on)100 1708 y(the)c(monad)e Ff(State)20
b(s)13 b Fq(are)g(in)o(tro)q(duced.)f(The)h(\014rst)h(op)q(eration,)e
Ff(update)p Fq(,)f(mo)q(di\014es)g(the)i(state)100 1762 y(b)o(y)j(applying)e
(a)i(giv)o(en)g(function,)f(and)h(returns)i(the)e(old)g(state)h(as)f(the)h
(result)f(v)n(alue)g(of)f(the)100 1816 y(computation.)g(The)i(remaining)e(t)o
(w)o(o)i(op)q(erations)g(are)h(de\014ned)g(in)f(terms)g(of)f
Ff(update)p Fq(:)g Ff(set)100 1870 y Fq(replaces)g(the)f(state)g(with)g(a)f
(new)h(state,)g(and)f(returns)j(the)e(old)f(state)h(as)g(the)g(result;)g
Ff(fetch)100 1924 y Fq(returns)g(the)g(state)f(without)g(mo)q(difying)d(it.)
165 2005 y Ff(update)42 b(::)22 b(\(s)f(->)g(s\))h(->)f(State)g(s)h(s)165
2059 y(set)108 b(::)22 b(s)f(->)h(State)e(s)i(s)165 2113 y(fetch)64
b(::)22 b(State)e(s)i(s)165 2221 y(update)f(f)g(=)h(\\s)f(->)g(\(s,)h(f)f
(s\))165 2275 y(set)g(s)87 b(=)22 b(update)e(\(\\_)h(->)h(s\))165
2329 y(fetch)86 b(=)22 b(update)e(id)100 2410 y Fq(In)e(fact)g
Ff(State)i(s)e Fq(is)g(not)g(the)h(only)e(monad)f(for)i(whic)o(h)f(it)h(mak)o
(es)f(sense)j(to)e(de\014ne)h(these)100 2464 y(op)q(erations.)14
b(F)m(or)g(this)h(reason)h(w)o(e)f(encapsulate)g(the)h(extra)f(op)q(erations)
g(in)f(a)g(class,)h(so)g(that)100 2518 y(the)f(same)f(names)g(can)h(b)q(e)h
(used)g(for)e(the)i(op)q(erations)f(of)f(di\013eren)o(t)i(monads:)165
2599 y Ff(class)21 b(Monad)g(m)g(=>)g(StateMonad)f(m)i(s)f(where)230
2653 y(update)g(::)g(\(s)h(->)f(s\))g(->)h(m)f(s)p eop
%%Page: 28 28
28 27 bop 100 178 a Fq(28)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)230 278 y Ff(set)87 b(::)21 b(s)h(->)f(m)h(s)230 332
y(fetch)43 b(::)21 b(m)h(s)230 440 y(set)g(s)65 b(=)21 b(update)g(\(\\_)g(->)
g(s\))230 494 y(fetch)65 b(=)21 b(update)g(id)100 572 y Fq(This)e
(declaration)f(can)i(b)q(e)f(read)h(as)f(follo)o(ws:)e(a)i(t)o(yp)q(e)h
(constructor)g Ff(m)f Fq(and)g(a)g(t)o(yp)q(e)h Ff(s)f Fq(are)100
626 y(together)e(a)g(mem)o(b)q(er)e(of)h(the)h(class)h Ff(StateMonad)c
Fq(if)i Ff(m)h Fq(is)f(a)h(mem)o(b)q(er)e(of)h(the)h(class)h
Ff(Monad)p Fq(,)100 680 y(and)d(if)f Ff(m)h Fq(is)g(also)f(equipp)q(ed)i
(with)f Ff(update)p Fq(,)f Ff(set)p Fq(,)g(and)h Ff(fetch)f
Fq(op)q(erations)h(of)g(the)g(sp)q(eci\014ed)100 734 y(t)o(yp)q(es.)f(Moreo)o
(v)o(er,)f(the)h(fact)g(that)f Ff(set)g Fq(and)g Ff(fetch)g
Fq(can)g(b)q(e)h(de\014ned)h(in)e(terms)g(of)g Ff(update)f
Fq(is)100 788 y(also)h(re\015ected)j(in)d(the)i(declaration,)e(b)o(y)h(means)
f(of)g(default)h(de\014nitions.)141 842 y(No)o(w)j(b)q(ecause)h
Ff(State)j(s)16 b Fq(is)h(already)f(a)h(monad,)d(it)j(can)g(b)q(e)g(made)f
(in)o(to)g(a)g(state)i(monad)100 896 y(using)13 b(the)i Ff(update)d
Fq(op)q(eration)i(as)g(de\014ned)h(earlier:)165 973 y Ff(instance)20
b(StateMonad)g(\(State)g(s\))i(s)f(where)230 1027 y(--)h(update)e(::)i(\(s)f
(->)g(s\))h(->)f(State)g(s)h(s)230 1081 y(update)f(f)65 b(=)22
b(\\s)f(->)g(\(s,)h(f)f(s\))340 1213 y Fg(7.4)i(The)17 b(p)n(ar)n(ameterise)n
(d)d(state-tr)n(ansformer)h(monad)100 1292 y Fq(Recall)e(no)o(w)g(our)h(t)o
(yp)q(e)h(of)e(com)o(binator)f(parsers:)165 1370 y Ff(type)21
b(Parser)g(a)g(=)h(String)e(->)i([\(a,String\)])100 1448 y
Fq(W)m(e)10 b(see)j(no)o(w)d(that)h(parsers)i(com)o(bine)c(t)o(w)o(o)i(kinds)
g(of)f(computation:)f(non-deterministic)h(com-)100 1502 y(putations)g(\(the)h
(result)g(of)f(a)h(parser)g(is)g(a)f(list\),)f(and)i(stateful)f(computations)
f(\(the)j(state)f(is)f(the)100 1556 y(string)h(b)q(eing)g(parsed\).)h
(Abstracting)g(from)d(the)j(sp)q(eci\014c)h(case)f(of)e(returning)i(a)f(list)
g(of)f(results,)100 1610 y(the)16 b Ff(Parser)f Fq(t)o(yp)q(e)h(giv)o(es)g
(rise)h(to)f(a)f(generalised)i(v)o(ersion)f(of)f(the)i Ff(State)e
Fq(t)o(yp)q(e)h(constructor)100 1664 y(that)e(applies)f(a)h(giv)o(en)f(t)o
(yp)q(e)i(constructor)g Ff(m)f Fq(to)f(the)i(result)g(of)e(the)h
(computation:)165 1742 y Ff(type)21 b(StateM)g(m)g(s)h(a)f(=)h(s)f(->)h(m)f
(\(a,s\))141 1819 y Fq(No)o(w)11 b Ff(StateM)21 b(m)g(s)12
b Fq(can)f(b)q(e)h(made)f(in)o(to)f(a)i(monad)d(with)i(a)h(zero)g(and)f(a)g
(plus,)g(b)o(y)h(inheriting)100 1873 y(the)i(monad)e(op)q(erations)i(from)e
(the)j(base)f(monad)e Ff(m)p Fq(:)165 1951 y Ff(instance)20
b(Monad)h(m)g(=>)h(Monad)f(\(StateM)f(m)i(s\))f(where)230 2005
y(--)h(result)64 b(::)21 b(a)h(->)f(StateM)g(m)g(s)h(a)230
2059 y(result)f(v)109 b(=)21 b(\\s)h(->)f(result)g(\(v,s\))230
2167 y(--)h(bind)108 b(::)21 b(StateM)g(m)g(s)h(a)g(->)230
2221 y(--)349 b(\(a)21 b(->)g(StateM)g(m)h(s)f(b\))h(->)f(StateM)f(m)i(s)g(b)
230 2275 y(stm)g(`bind`)e(f)i(=)f(\\s)h(->)f(stm)g(s)h(`bind`)e(\\\(v,s'\))h
(->)g(f)h(v)f(s')165 2383 y(instance)f(Monad0Plus)g(m)h(=>)h(Monad0Plus)e
(\(StateM)g(m)h(s\))h(where)230 2437 y(--)g(zero)108 b(::)21
b(StateM)g(m)g(s)h(a)230 2491 y(zero)196 b(=)21 b(\\s)h(->)f(zero)230
2599 y(--)h(\(++\))108 b(::)21 b(StateM)g(m)g(s)h(a)g(->)f(StateM)g(m)g(s)h
(a)f(->)h(StateM)e(m)i(s)f(a)230 2653 y(stm)h(++)f(stm')43
b(=)21 b(\\s)h(->)f(stm)g(s)h(++)f(stm')g(s)p eop
%%Page: 29 29
29 28 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(29)100 278 y(That)11 b(is,)f Ff(result)g Fq(con)o(v)o(erts)i(a)f(v)n
(alue)g(in)o(to)f(a)h(computation)f(that)h(returns)i(this)e(v)n(alue)f
(without)100 332 y(mo)q(difying)i(the)17 b(in)o(ternal)e(state;)i
Ff(bind)e Fq(c)o(hains)g(t)o(w)o(o)h(computations)e(together;)j
Ff(zero)e Fq(is)g(the)100 386 y(computation)g(that)i(fails)f(regardless)i(of)
e(the)h(input)g(state;)g(and)g(\014nally)m(,)e Ff(\(++\))h
Fq(is)h(a)f(c)o(hoice)100 440 y(op)q(eration)e(that)h(passes)g(the)g(same)f
(input)g(state)i(through)e(to)g(b)q(oth)h(of)f(the)h(argumen)o(t)e(com-)100
494 y(putations,)g(and)h(com)o(bines)f(their)h(results.)141
549 y(In)h(the)h(previous)g(section)g(w)o(e)f(de\014ned)h(the)g(extra)g(op)q
(erations)f Ff(update)p Fq(,)f Ff(set)g Fq(and)h Ff(fetch)100
603 y Fq(for)j(the)h(monad)d Ff(State)21 b(s)p Fq(.)d(Of)g(course,)i(these)f
(op)q(erations)g(can)g(also)f(b)q(e)h(de\014ned)g(for)f(the)100
657 y Fi(p)n(ar)n(ameterise)n(d)e(state-tr)n(ansformer)f(monad)22
b Ff(StateM)e(m)i(s)p Fq(.)15 b(As)i(previously)m(,)e(w)o(e)i(only)e(need)100
711 y(to)j(de\014ne)i Ff(update)p Fq(,)e(the)h(remaining)e(t)o(w)o(o)i(op)q
(erations)g(b)q(eing)g(de\014ned)h(automatically)c(via)100
764 y(default)d(de\014nitions:)165 854 y Ff(instance)20 b(Monad)h(m)g(=>)h
(StateMonad)e(\(StateM)g(m)i(s\))f(s)g(where)230 908 y(--)h(update)e(::)i
(Monad)e(m)i(=>)f(\(s)h(->)f(s\))h(->)f(StateM)f(m)i(s)g(s)230
962 y(update)f(f)65 b(=)22 b(\\s)f(->)g(result)g(\(s,)g(f)h(s\))516
1105 y Fg(7.5)h(The)17 b(p)n(arser)f(monad)g(r)n(evisite)n(d)100
1186 y Fq(Recall)d(once)h(again)f(our)h(t)o(yp)q(e)g(of)g(com)o(binator)e
(parsers:)165 1275 y Ff(type)21 b(Parser)g(a)g(=)h(String)e(->)i
([\(a,String\)])100 1364 y Fq(This)9 b(t)o(yp)q(e)h(can)f(no)o(w)g(b)q(e)h
(re-expressed)j(using)c(the)h(parameterised)f(state-transformer)h(monad)100
1418 y Ff(StateM)20 b(m)i(s)13 b Fq(b)o(y)h(taking)f Ff([])g
Fq(for)h Ff(m)p Fq(,)f(and)h Ff(String)e Fq(for)i Ff(s)p Fq(:)165
1507 y Ff(type)21 b(Parser)g(a)g(=)h(StateM)e([])i(String)e(a)100
1596 y Fq(But)13 b(wh)o(y)g(view)g(the)h Ff(Parser)d Fq(t)o(yp)q(e)j(in)f
(this)g(w)o(a)o(y?)f(The)h(answ)o(er)h(is)f(that)g(all)f(the)i(basic)f
(parser)100 1650 y(com)o(binators)d(no)h(longer)g(need)i(to)e(b)q(e)h
(de\014ned)h(explicitly)e(\(except)i(one,)e(the)h(parser)h
Ff(item)d Fq(for)100 1704 y(single)k(c)o(haracters\),)i(but)f(rather)h(arise)
f(as)g(an)g(instance)g(of)f(the)i(general)f(case)g(of)g(extending)100
1758 y(monad)e(op)q(erations)i(from)e(a)h(t)o(yp)q(e)i(constructor)g
Ff(m)f Fq(to)f(the)i(t)o(yp)q(e)f(constructor)i Ff(StateM)j(m)i(s)p
Fq(.)100 1811 y(More)12 b(sp)q(eci\014cally)m(,)g(since)h Ff([])e
Fq(forms)g(a)h(monad)e(with)i(a)g(zero)h(and)f(a)g(plus,)g(so)g(do)q(es)h
Ff(State)20 b([])100 1865 y(String)p Fq(,)12 b(and)h(hence)j(Gofer)d
(automatically)e(pro)o(vides)j(the)h(follo)o(wing)c(com)o(binators:)165
1955 y Ff(result)21 b(::)g(a)h(->)f(Parser)f(a)165 2009 y(bind)65
b(::)21 b(Parser)f(a)i(->)f(\(a)h(->)f(Parser)g(b\))g(->)h(Parser)e(b)165
2063 y(zero)65 b(::)21 b(Parser)f(a)165 2117 y(\(++\))65 b(::)21
b(Parser)f(a)i(->)f(Parser)g(a)h(->)f(Parser)g(a)141 2205 y
Fq(Moreo)o(v)o(er,)d(de\014ning)g(the)h(parser)g(monad)d(in)h(this)h(mo)q
(dular)e(w)o(a)o(y)i(in)f(terms)h(of)f Ff(StateM)100 2259 y
Fq(means)10 b(that,)g(if)h(w)o(e)g(c)o(hange)g(the)h(t)o(yp)q(e)f(of)g
(parsers,)h(then)f(new)h(com)o(binators)d(for)i(the)g(mo)q(di\014ed)100
2313 y(t)o(yp)q(e)j(are)g(also)g(de\014ned)h(automatically)l(.)10
b(F)m(or)k(example,)e(consider)j(replacing)165 2402 y Ff(type)21
b(Parser)g(a)g(=)h(StateM)e([])i(String)e(a)100 2491 y Fq(b)o(y)f(a)g(new)h
(de\014nition)f(in)g(whic)o(h)g(the)h(list)f(t)o(yp)q(e)h(constructor)h
Ff([])e Fq(\(whic)o(h)g(captures)i(non-)100 2545 y(deterministic)12
b(computations)f(that)i(can)g(return)h(man)o(y)d(results\))k(is)d(replaced)i
(b)o(y)f(the)g Ff(Maybe)100 2599 y Fq(t)o(yp)q(e)18 b(constructor)h(\(whic)o
(h)f(captures)h(deterministic)e(computations)g(that)g(either)i(fail,)c(re-)
100 2653 y(turning)e(no)h(result,)g(or)g(succeed)i(with)e(a)f(single)h
(result\):)p eop
%%Page: 30 30
30 29 bop 100 178 a Fq(30)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)165 278 y Ff(data)21 b(Maybe)g(a)43 b(=)22 b(Just)f(a)g(|)h(Nothing)
165 386 y(type)f(Parser)g(a)g(=)h(StateM)e(Maybe)h(String)g(a)100
467 y Fq(Since)15 b Ff(Maybe)e Fq(forms)g(a)h(monad)f(with)h(a)g(zero)h(and)f
(a)h(plus,)e(so)i(do)q(es)g(the)g(re-de\014ned)h Ff(Parser)100
521 y Fq(t)o(yp)q(e)d(constructor,)g(and)f(hence)i(Gofer)e(automatically)e
(pro)o(vides)i Ff(result)p Fq(,)f Ff(bind)p Fq(,)g Ff(zero)p
Fq(,)g(and)100 575 y Ff(\(++\))e Fq(com)o(binators)f(for)i(deterministic)f
(parsers.)i(In)f(earlier)g(approac)o(hes)g(that)g(do)g(not)g(exploit)100
629 y(the)h(monadic)e(nature)i(of)f(parsers)i(\(W)m(adler,)d(1985;)g(Hutton,)
i(1992;)e(F)m(okk)o(er,)g(1995\),)h(the)h(basic)100 683 y(com)o(binators)h(w)
o(ould)h(ha)o(v)o(e)h(to)g(b)q(e)g(re-de\014ned)i(b)o(y)d(hand.)141
737 y(The)h(only)f(basic)g(parsing)g(primitiv)o(e)f(that)h(do)q(es)h(not)g
(arise)f(from)f(the)i(monadic)e(structure)100 791 y(of)h(the)h
Ff(Parser)f Fq(t)o(yp)q(e)h(is)g(the)h(parser)g Ff(item)e Fq(for)g(consuming)
g(single)g(c)o(haracters:)165 872 y Ff(item)21 b(::)g(Parser)g(Char)165
926 y(item)43 b(=)21 b(\\inp)g(->)h(case)f(inp)g(of)579 980
y([])109 b(->)21 b([])579 1034 y(\(x:xs\))g(->)g([\(x,xs\)])100
1115 y Fq(Ho)o(w)o(ev)o(er,)15 b Ff(item)g Fq(can)g(no)o(w)g(b)q(e)h
(re-de\014ned)h(in)e(monadic)f(st)o(yle.)h(W)m(e)g(\014rst)h(fetc)o(h)g(the)g
(curren)o(t)100 1169 y(state)e(\(the)g(input)f(string\);)g(if)f(the)i(string)
f(is)h(empt)o(y)e(then)i(the)g Ff(item)e Fq(parser)i(fails,)e(otherwise)100
1222 y(the)k(\014rst)h(c)o(haracter)g(is)f(consumed)f(\(b)o(y)h(applying)f
(the)h Ff(tail)f Fq(function)h(to)f(the)i(state\),)f(and)100
1276 y(returned)f(as)f(the)h(result)f(v)n(alue)g(of)f(the)h(parser:)165
1357 y Ff(item)43 b(=)21 b([x)h(|)f(\(x:_\))g(<-)g(update)g(tail])100
1438 y Fq(The)15 b(adv)n(an)o(tage)g(of)f(the)i(monadic)e(de\014nition)h(of)f
Ff(item)h Fq(is)g(that)g(it)g(do)q(es)h(not)f(dep)q(end)i(up)q(on)100
1492 y(the)c(in)o(ternal)f(details)g(of)f(the)i Ff(Parser)f
Fq(t)o(yp)q(e.)g(Th)o(us,)g(for)g(example,)f(it)h(w)o(orks)g(equally)g(w)o
(ell)f(for)100 1546 y(b)q(oth)j(the)g(non-deterministic)f(and)h
(deterministic)f(v)o(ersions)i(of)e Ff(Parser)p Fq(.)564 1681
y Fl(8)23 b(Handling)14 b(the)h(o\013side)f(rule)100 1762 y
Fq(Earlier)20 b(\(section)h(6\))g(w)o(e)f(sho)o(w)o(ed)h(that)f(the)h(need)h
(for)e(a)g(lexer)h(to)f(handle)g(white-space,)100 1816 y(commen)o(ts,)13
b(and)j(k)o(eyw)o(ords)g(can)g(b)q(e)g(a)o(v)o(oided)f(b)o(y)h(using)f(sp)q
(ecial)h(com)o(binators)e(within)h(the)100 1870 y(main)8 b(parser.)j(Another)
g(task)f(usually)g(p)q(erformed)g(b)o(y)g(a)g(lexer)h(is)f(handling)f(the)i
(Gofer)f Fi(o\013side)100 1924 y(rule)p Fq(.)19 b(This)h(rule)g(allo)o(ws)f
(the)i(grouping)f(of)f(de\014nitions)i(in)e(a)h(program)f(to)h(b)q(e)h
(indicated)100 1978 y(using)15 b(inden)o(tation,)g(and)g(is)h(usually)f
(implemen)o(ted)e(b)o(y)j(the)g(lexer)g(inserting)g(extra)g(tok)o(ens)100
2032 y(\(concerning)e(inden)o(tation\))g(in)o(to)f(its)h(output)g(stream.)141
2086 y(In)g(this)h(section)g(w)o(e)f(sho)o(w)g(that)g(Gofer's)g(o\013side)h
(rule)f(can)h(b)q(e)g(handled)f(in)g(a)f(simple)g(and)100 2140
y(natural)g(manner)f(without)h(a)g(separate)i(lexer,)e(b)o(y)h(once)g(again)e
(using)h(sp)q(ecial)h(com)o(binators.)100 2194 y(Our)h(approac)o(h)h(w)o(as)f
(inspired)g(b)o(y)g(the)h(monadic)e(view)h(of)f(parsers,)j(and)e(is)g(a)g
(dev)o(elopmen)o(t)100 2248 y(of)e(an)h(idea)f(describ)q(ed)j(earlier)e(b)o
(y)g(Hutton)g(\(1992\).)636 2383 y Fg(8.1)24 b(The)17 b(o\013side)f(rule)100
2464 y Fq(Consider)e(the)g(follo)o(wing)e(simple)g(Gofer)i(program:)165
2545 y Ff(a)22 b(=)f(b)h(+)f(c)252 2599 y(where)318 2653 y(b)g(=)h(10)p
eop
%%Page: 31 31
31 30 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(31)318 278 y Ff(c)21 b(=)h(15)f(-)h(5)165 332 y(d)g(=)f(a)h(*)f(2)100
419 y Fq(It)f(is)g(clear)h(from)e(the)h(use)i(of)d(inden)o(tation)h(that)g
Ff(a)h Fq(and)f Ff(d)g Fq(are)h(in)o(tended)f(to)h(b)q(e)g(global)100
473 y(de\014nitions,)14 b(with)h Ff(b)g Fq(and)g Ff(c)g Fq(lo)q(cal)f
(de\014nitions)h(to)h Ff(a)p Fq(.)e(Indeed,)i(the)f(ab)q(o)o(v)o(e)g(program)
f(can)h(b)q(e)100 527 y(view)o(ed)9 b(as)h(a)f(shorthand)h(for)f(the)h(follo)
o(wing)d(program,)g(in)i(whic)o(h)g(the)i(grouping)d(of)h(de\014nitions)100
581 y(is)k(made)g(explicit)h(using)f(sp)q(ecial)h(brac)o(k)o(ets)h(and)f
(separators:)165 668 y Ff({)22 b(a)f(=)h(b)f(+)h(c)296 722
y(where)361 776 y({)g(b)f(=)h(10)361 830 y(;)g(c)f(=)h(15)f(-)h(5)f(})165
884 y(;)h(d)f(=)h(a)f(*)h(2)g(})141 970 y Fq(Ho)o(w)14 b(the)h(grouping)f(of)
f(Gofer)i(de\014nitions)f(follo)o(ws)f(from)f(their)j(inden)o(tation)f(is)g
(formally)100 1024 y(sp)q(eci\014ed)h(b)o(y)f(the)g Fi(o\013side)i(rule)s
Fq(.)c(The)j(essence)h(of)d(the)i(rule)f(is)g(as)g(follo)o(ws:)d(consecutiv)o
(e)16 b(de\014-)100 1078 y(nitions)d(that)h(b)q(egin)g(in)f(the)i(same)e
(column)f Fh(c)i Fq(are)g(deemed)g(to)g(b)q(e)h(part)f(of)f(the)i(same)e
(group.)100 1132 y(T)m(o)e(mak)o(e)g(parsing)h(easier,)h(it)f(is)g(further)h
(required)g(that)g(the)g(remainder)e(of)h(the)h(text)g(of)e(eac)o(h)100
1186 y(de\014nition)j(\(excluding)g(white-space)h(and)f(commen)o(ts,)e(of)i
(course\))i(in)d(a)h(group)h(m)o(ust)e(o)q(ccur)100 1240 y(in)h(a)h(column)e
(strictly)i(greater)h(than)f Fh(c)p Fq(.)g(In)g(terms)g(of)f(the)i(o\013side)
f(rule)g(then,)g(de\014nitions)g Ff(a)100 1294 y Fq(and)e Ff(d)h
Fq(in)g(the)g(example)f(program)f(ab)q(o)o(v)o(e)i(are)h(formally)c(group)q
(ed)j(together)h(\(and)f(similarly)100 1348 y(for)f Ff(b)h
Fq(and)g Ff(c)p Fq(\))f(b)q(ecause)j(they)e(start)h(in)e(the)i(same)e(column)
f(as)i(one)g(another.)494 1489 y Fg(8.2)24 b(Mo)n(difying)15
b(the)h(typ)n(e)h(of)f(p)n(arsers)100 1570 y Fq(T)m(o)h(implemen)o(t)f(the)i
(o\013side)h(rule,)f(w)o(e)g(will)f(ha)o(v)o(e)h(to)g(main)o(tain)e(some)h
(extra)i(information)100 1624 y(during)13 b(parsing.)g(First)i(of)e(all,)f
(since)j(column)d(n)o(um)o(b)q(ers)i(pla)o(y)e(a)i(crucial)g(role)g(in)f(the)
i(o\013side)100 1678 y(rule,)h(parsers)i(will)d(need)i(to)g(kno)o(w)f(the)h
(column)e(n)o(um)o(b)q(er)g(of)h(the)h(\014rst)h(c)o(haracter)g(in)e(their)
100 1732 y(input)i(string.)h(In)g(fact,)g(it)f(turns)i(out)f(that)g(parsers)i
(will)c(also)h(require)i(the)g(curren)o(t)g(line)100 1786 y(n)o(um)o(b)q(er.)
12 b(Th)o(us)i(our)g(presen)o(t)i(t)o(yp)q(e)e(of)g(com)o(binator)e(parsers,)
165 1873 y Ff(type)21 b(Parser)g(a)g(=)h(StateM)e([])i(String)e(a)100
1960 y Fq(is)12 b(revised)h(to)f(the)h(follo)o(wing)c(t)o(yp)q(e,)j(in)g
(whic)o(h)g(the)h(in)o(ternal)f(state)h(of)e(a)h(parser)h(no)o(w)f(con)o
(tains)100 2014 y(a)h(\(line,column\))f(p)q(osition)h(in)h(addition)e(to)i(a)
g(string:)165 2101 y Ff(type)21 b(Parser)g(a)g(=)h(StateM)e([])i(Pstring)e(a)
165 2209 y(type)h(Pstring)42 b(=)22 b(\(Pos,String\))165 2317
y(type)f(Pos)130 b(=)22 b(\(Int,Int\))141 2404 y Fq(In)13 b(addition,)f
(parsers)i(will)e(need)i(to)f(kno)o(w)f(the)i(starting)f(p)q(osition)f(of)h
(the)g(curren)o(t)i(de\014ni-)100 2458 y(tion)f(b)q(eing)h(parsed)h(|)f(if)f
(the)h(o\013side)h(rule)f(is)g(not)g(in)f(e\013ect,)j(this)e
Fi(de\014nition)h(p)n(osition)j Fq(can)100 2511 y(b)q(e)f(set)g(with)f(a)g
(negativ)o(e)g(column)f(n)o(um)o(b)q(er.)g(Th)o(us)i(our)f(t)o(yp)q(e)h(of)f
(parsers)i(is)e(revised)h(once)100 2565 y(more,)12 b(to)i(tak)o(e)g(the)g
(curren)o(t)i(de\014nition)d(p)q(osition)g(as)h(an)g(extra)g(argumen)o(t:)165
2653 y Ff(type)21 b(Parser)g(a)g(=)h(Pos)f(->)g(StateM)g([])g(Pstring)g(a)p
eop
%%Page: 32 32
32 31 bop 100 178 a Fq(32)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(Another)i(option)e(w)o(ould)h(ha)o(v)o(e)g(b)q(een)i(to)
e(main)o(tain)d(the)k(de\014nition)f(p)q(osition)g(in)g(the)h(parser)100
332 y(state,)d(along)f(with)h(the)g(curren)o(t)i(p)q(osition)d(and)h(the)h
(string)f(to)g(b)q(e)g(parsed.)h(Ho)o(w)o(ev)o(er,)f(de\014ni-)100
386 y(tion)i(p)q(ositions)g(can)h(b)q(e)g(nested,)h(and)f(supplying)f(the)h
(p)q(osition)f(as)h(an)f(extra)i(argumen)o(t)d(to)100 440 y(parsers)h(|)e(as)
h(opp)q(osed)g(to)g(within)f(the)h(parser)h(state)f(|)g(is)f(more)g(natural)g
(from)f(the)i(p)q(oin)o(t)100 494 y(of)f(view)h(of)f(implemen)o(ting)d
(nesting)15 b(of)e(p)q(ositions.)141 548 y(Is)g(the)g(revised)h
Ff(Parser)d Fq(t)o(yp)q(e)j(still)d(a)i(monad?)d(Abstracting)j(from)e(the)j
(details,)e(the)h(b)q(o)q(dy)100 602 y(of)f(the)h Ff(Parser)e
Fq(t)o(yp)q(e)i(de\014nition)f(is)h(of)f(the)h(form)e Ff(s)22
b(->)f(m)g(a)13 b Fq(\(in)f(our)h(case)g Ff(s)g Fq(is)f Ff(Pos)p
Fq(,)g Ff(m)g Fq(is)g(the)100 656 y(monad)h Ff(StateM)20 b([])h(Pstring)p
Fq(,)13 b(and)i Ff(a)f Fq(is)h(the)g(parameter)g(t)o(yp)q(e)g
Ff(a)p Fq(.\))f(W)m(e)g(recognise)i(this)f(as)100 710 y(b)q(eing)h(similar)f
(to)i(the)g(t)o(yp)q(e)h Ff(s)j(->)h(m)f(\(a,s\))16 b Fq(of)g(parameterised)h
(state-transformers,)g(the)100 764 y(di\013erence)d(b)q(eing)f(that)g(the)h
(t)o(yp)q(e)f Ff(s)g Fq(of)f(states)i(no)f(longer)g(o)q(ccurs)h(in)f(the)g(t)
o(yp)q(e)h(of)e(the)i(result:)100 818 y(in)e(other)h(w)o(ords,)f(the)i(state)
f(can)g(b)q(e)g(read,)g(but)g(not)f(mo)q(di\014ed.)f(Th)o(us)i(w)o(e)g(can)g
(think)f(of)g Ff(s)21 b(->)100 872 y(m)g(a)14 b Fq(as)g(the)g(t)o(yp)q(e)h
(of)e Fi(p)n(ar)n(ameterise)n(d)h(state-r)n(e)n(aders)s Fq(.)f(The)h(monadic)
e(nature)j(of)e(this)h(t)o(yp)q(e)g(is)100 926 y(the)g(topic)g(of)f(the)i
(next)f(section.)400 1061 y Fg(8.3)23 b(The)17 b(p)n(ar)n(ameterise)n(d)d
(state-r)n(e)n(ader)h(monad)100 1142 y Fq(Consider)f(the)g(t)o(yp)q(e)h
(constructor)g Ff(ReaderM)p Fq(,)d(de\014ned)j(as)f(follo)o(ws:)165
1222 y Ff(type)21 b(ReaderM)f(m)i(s)f(a)h(=)g(s)f(->)h(m)f(a)100
1303 y Fq(In)15 b(a)h(similar)d(w)o(a)o(y)i(to)h Ff(StateM)k(m)i(s)p
Fq(,)15 b Ff(ReaderM)20 b(m)i(s)15 b Fq(can)h(b)q(e)h(made)d(in)o(to)h(a)h
(monad)e(with)h(a)100 1357 y(zero)f(and)g(a)g(plus,)f(b)o(y)h(inheriting)f
(the)h(monad)f(op)q(erations)h(from)e(the)i(base)h(monad)d
Ff(m)p Fq(:)165 1438 y Ff(instance)20 b(Monad)h(m)g(=>)h(Monad)f(\(ReaderM)f
(m)h(s\))h(where)230 1492 y(--)g(result)64 b(::)21 b(a)h(->)f(ReaderM)g(m)g
(s)h(a)230 1546 y(result)f(v)109 b(=)21 b(\\s)h(->)f(result)g(v)230
1654 y(--)h(bind)108 b(::)21 b(ReaderM)g(m)g(s)h(a)f(->)230
1708 y(--)349 b(\(a)21 b(->)g(ReaderM)g(m)g(s)h(b\))f(->)h(ReaderM)e(m)i(s)f
(b)230 1762 y(srm)h(`bind`)e(f)i(=)f(\\s)h(->)f(srm)g(s)h(`bind`)e(\\v)i(->)f
(f)h(v)f(s)165 1870 y(instance)f(Monad0Plus)g(m)h(=>)h(Monad0Plus)e
(\(ReaderM)g(m)h(s\))h(where)230 1924 y(--)g(zero)108 b(::)21
b(ReaderM)g(m)g(s)h(a)230 1978 y(zero)196 b(=)21 b(\\s)h(->)f(zero)230
2086 y(--)h(\(++\))108 b(::)21 b(ReaderM)g(m)g(s)h(a)f(->)230
2140 y(--)349 b(ReaderM)20 b(m)i(s)f(a)h(->)f(ReaderM)f(m)i(s)g(a)230
2194 y(srm)g(++)f(srm')43 b(=)21 b(\\s)h(->)f(srm)g(s)h(++)f(srm')g(s)100
2275 y Fq(That)11 b(is,)f Ff(result)g Fq(con)o(v)o(erts)i(a)f(v)n(alue)g(in)o
(to)f(a)h(computation)f(that)h(returns)i(this)e(v)n(alue)f(without)100
2329 y(consulting)k(the)i(state;)g Ff(bind)e Fq(c)o(hains)h(t)o(w)o(o)g
(computations)f(together,)h(with)g(the)h(same)e(state)100 2383
y(b)q(eing)g(passed)i(to)e(b)q(oth)h(computations)e(\(con)o(trast)j(with)e
(the)h Ff(bind)f Fq(op)q(eration)g(for)h Ff(StateM)p Fq(,)100
2437 y(in)d(whic)o(h)g(the)i(second)g(computation)d(receiv)o(es)j(the)f(new)h
(state)f(pro)q(duced)h(b)o(y)f(the)g(\014rst)g(com-)100 2491
y(putation\);)d Ff(zero)h Fq(is)g(the)h(computation)d(that)j(fails;)d(and)i
(\014nally)m(,)f Ff(\(++\))g Fq(is)h(a)g(c)o(hoice)h(op)q(eration)100
2545 y(that)i(passes)h(the)f(same)f(state)i(to)f(b)q(oth)g(of)f(the)i
(argumen)o(t)d(computations.)141 2599 y(T)m(o)19 b(allo)o(w)g(us)h(to)g
(access)i(and)e(set)h(the)f(state,)g(a)g(couple)g(of)g(extra)g(op)q(erations)
h(on)e(the)100 2653 y Fi(p)n(ar)n(ameterise)n(d)13 b(state-r)n(e)n(ader)k
Fq(monad)12 b Ff(ReaderM)20 b(m)i(s)13 b Fq(are)h(in)o(tro)q(duced.)f(As)h
(for)f Ff(StateM)p Fq(,)f(w)o(e)p eop
%%Page: 33 33
33 32 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(33)100 278 y(encapsulate)14 b(the)g(extra)g(op)q(erations)g(in)e(a)i
(class.)f(The)h(op)q(eration)f Ff(env)g Fq(returns)i(the)f(state)g(as)100
332 y(the)h(result)h(of)e(the)i(computation,)d(while)h Ff(setenv)g
Fq(replaces)i(the)g(curren)o(t)g(state)g(for)f(a)f(giv)o(en)100
386 y(computation)e(with)h(a)h(new)g(state:)165 470 y Ff(class)21
b(Monad)g(m)g(=>)g(ReaderMonad)f(m)i(s)f(where)230 524 y(env)87
b(::)21 b(m)h(s)230 578 y(setenv)f(::)g(s)h(->)f(m)h(a)f(->)h(m)f(a)165
686 y(instance)f(Monad)h(m)g(=>)h(ReaderMonad)d(\(ReaderM)i(m)g(s\))g(s)h
(where)230 740 y(--)g(env)130 b(::)21 b(Monad)g(m)h(=>)f(ReaderM)f(m)i(s)g(s)
230 794 y(env)218 b(=)21 b(\\s)h(->)f(result)g(s)230 901 y(--)h(setenv)64
b(::)21 b(Monad)g(m)h(=>)f(s)h(->)230 955 y(--)349 b(ReaderM)20
b(m)i(s)f(a)h(->)f(ReaderM)f(m)i(s)g(a)230 1009 y(setenv)f(s)h(srm)f(=)g(\\_)
h(->)f(srm)g(s)100 1093 y Fq(The)16 b(name)f Ff(env)h Fq(comes)g(from)e(the)j
(fact)f(that)h(one)f(can)g(think)g(of)g(the)h(state)g(supplied)f(to)g(a)100
1147 y(state-reader)g(as)f(b)q(eing)g(a)f(kind)h(of)f Fi(env)t
Fq(ironmen)o(t.)g(Indeed,)h(in)f(the)i(literature)f(state-reader)100
1201 y(monads)d(are)i(sometimes)e(called)i Fi(envir)n(onment)k
Fq(monads.)505 1338 y Fg(8.4)23 b(The)17 b(new)g(p)n(arser)f(c)n(ombinators)
100 1420 y Fq(Using)d(the)i Ff(ReaderM)d Fq(t)o(yp)q(e)j(constructor,)g(our)f
(revised)g(t)o(yp)q(e)h(of)e(parsers)165 1503 y Ff(type)21
b(Parser)g(a)g(=)h(Pos)f(->)g(StateM)g([])g(Pstring)g(a)100
1587 y Fq(can)14 b(no)o(w)f(b)q(e)i(expressed)h(as)e(follo)o(ws:)165
1671 y Ff(type)21 b(Parser)g(a)g(=)h(ReaderM)e(\(StateM)g([])i(Pstring\))e
(Pos)h(a)100 1754 y Fq(No)o(w)13 b(since)i Ff([])e Fq(forms)f(a)h(monad)f
(with)i(a)f(zero)i(and)e(a)h(plus,)f(so)h(do)q(es)g Ff(StateM)21
b([])g(Pstring)p Fq(,)100 1808 y(and)11 b(hence)i(so)f(do)q(es)h
Ff(ReaderM)20 b(\(StateM)g([])i(Pstring\))e(Pos)p Fq(.)11 b(Th)o(us)h(Gofer)f
(automatically)100 1862 y(pro)o(vides)j Ff(result)p Fq(,)e
Ff(bind)p Fq(,)h Ff(zero)p Fq(,)g(and)h Ff(\(++\))f Fq(op)q(erations)h(for)g
(parsers)i(that)e(can)g(handle)g(the)100 1916 y(o\013side)f(rule.)f(Since)h
(the)g(t)o(yp)q(e)g(of)f(parsers)i(is)e(no)o(w)h(de\014ned)g(in)f(terms)h(of)
e Ff(ReaderM)h Fq(at)g(the)h(top)100 1970 y(lev)o(el,)e(the)i(extra)g(op)q
(erations)g Ff(env)f Fq(and)g Ff(setenv)f Fq(are)i(also)f(pro)o(vided)g(for)g
(parsers.)i(Moreo)o(v)o(er,)100 2024 y(the)h(extra)h(op)q(eration)f
Ff(update)f Fq(\(and)h(the)h(deriv)o(ed)f(op)q(erations)g Ff(set)g
Fq(and)g Ff(fetch)p Fq(\))f(from)f(the)100 2078 y(underlying)c(state)i(monad)
d(can)i(b)q(e)g(lifted)g(to)f(the)i(new)f(t)o(yp)q(e)h(of)e(parsers)i(|)f(or)
f(more)g(generally)m(,)100 2132 y(to)k(an)o(y)h(parameterised)g(state-reader)
i(monad)c(|)h(b)o(y)h(ignoring)e(the)j(en)o(vironmen)o(t:)165
2216 y Ff(instance)20 b(StateMonad)g(m)h(a)h(=>)f(StateMonad)f(\(ReaderM)g(m)
i(s\))f(a)h(where)230 2269 y(--)g(update)e(::)i(StateMonad)d(m)j(a)g(=>)f
(\(a)g(->)h(a\))f(->)g(ReaderM)g(m)g(s)h(a)230 2323 y(update)f(f)65
b(=)22 b(\\_)f(->)g(update)g(f)141 2407 y Fq(No)o(w)9 b(that)g(the)h(in)o
(ternal)f(state)h(of)f(parsers)i(has)e(b)q(een)h(mo)q(di\014ed)e(\(from)g
Ff(String)g Fq(to)h Ff(Pstring)p Fq(\),)100 2461 y(the)14 b(parser)h
Ff(item)e Fq(for)g(consuming)g(single)g(c)o(haracters)i(from)d(the)j(input)e
(m)o(ust)g(also)g(b)q(e)i(mo)q(d-)100 2515 y(i\014ed.)e(The)h(new)h
(de\014nition)e(for)h Ff(item)f Fq(is)h(similar)d(to)j(the)g(old,)165
2599 y Ff(item)21 b(::)g(Parser)g(Char)165 2653 y(item)43 b(=)21
b([x)h(|)f(\(x:_\))g(<-)g(update)g(tail])p eop
%%Page: 34 34
34 33 bop 100 178 a Fq(34)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fq(except)e(that)e(the)h Ff(item)f Fq(parser)i(no)o(w)e
(fails)g(if)f(the)i(p)q(osition)f(of)g(the)i(c)o(haracter)g(to)e(b)q(e)h
(consumed)100 332 y(is)i(not)h Fi(onside)k Fq(with)13 b(resp)q(ect)j(to)e
(curren)o(t)i(de\014nition)d(p)q(osition:)165 413 y Ff(item)21
b(::)g(Parser)g(Char)165 467 y(item)43 b(=)21 b([x)h(|)f(\(pos,x:_\))f(<-)i
(update)e(newstate)405 521 y(,)h(defpos)86 b(<-)22 b(env)405
575 y(,)f(onside)g(pos)g(defpos])100 656 y Fq(A)15 b(p)q(osition)f(is)h
(onside)g(if)f(its)h(column)e(n)o(um)o(b)q(er)h(is)h(strictly)g(greater)h
(than)f(the)g(curren)o(t)i(de\014-)100 710 y(nition)c(column.)g(Ho)o(w)o(ev)o
(er,)i(the)g(\014rst)g(c)o(haracter)h(of)f(a)f(new)h(de\014nition)f(b)q
(egins)h(in)g(the)g(same)100 764 y(column)d(as)i(the)g(de\014nition)g
(column,)e(so)i(this)g(is)f(handled)h(as)g(a)g(sp)q(ecial)g(case:)165
845 y Ff(onside)304 b(::)21 b(Pos)g(->)h(Pos)f(->)g(Bool)165
899 y(onside)g(\(l,c\))f(\(dl,dc\))h(=)g(\(c)h(>)f(dc\))g(||)h(\(l)f(==)h
(dl\))100 980 y Fq(The)13 b(remaining)e(auxiliary)g(function,)h
Ff(newstate)p Fq(,)e(consumes)j(the)h(\014rst)f(c)o(haracter)h(from)d(the)100
1034 y(input)f(string,)g(and)h(up)q(dates)g(the)h(curren)o(t)g(p)q(osition)e
(accordingly)g(\(for)g(example,)f(if)h(a)g(newline)100 1088
y(c)o(haracter)16 b(w)o(as)f(consumed,)g(the)h(curren)o(t)g(line)f(n)o(um)o
(b)q(er)g(is)g(incremen)o(ted,)g(and)g(the)g(curren)o(t)100
1142 y(column)d(n)o(um)o(b)q(er)h(is)h(set)h(bac)o(k)e(to)h(zero\):)165
1222 y Ff(newstate)20 b(::)i(Pstring)e(->)h(Pstring)165 1276
y(newstate)f(\(\(l,c\),x:xs\))230 1330 y(=)i(\(newpos,xs\))274
1384 y(where)339 1438 y(newpos)f(=)g(case)g(x)h(of)601 1492
y('\\n')f(->)g(\(l+1,0\))601 1546 y('\\t')g(->)g(\(l,\(\(c)g(`div`)g
(8\)+1\)*8\))601 1600 y(_)87 b(->)21 b(\(l,c+1\))141 1681 y
Fq(One)f(asp)q(ect)h(of)d(the)i(o\013side)g(rule)f(still)f(remains)g(to)h(b)q
(e)h(addressed:)h(for)e(the)g(purp)q(oses)100 1735 y(of)d(this)g(rule,)g
(white-space)i(and)e(commen)o(ts)f(are)i(not)g(signi\014can)o(t,)e(and)i
(should)f(alw)o(a)o(ys)f(b)q(e)100 1789 y(successfully)e(consumed)f(ev)o(en)h
(if)f(they)h(con)o(tain)f(c)o(haracters)i(that)e(are)h(not)f(onside.)g(This)h
(can)100 1843 y(b)q(e)f(handled)f(b)o(y)g(temp)q(orarily)f(setting)i(the)g
(de\014nition)e(p)q(osition)h(to)g(\(0)p Fh(;)c Fe(\000)p Fq(1\))k(within)g
(the)h Ff(junk)100 1897 y Fq(parser)j(for)e(white-space)i(and)f(commen)o(ts:)
165 1978 y Ff(junk)21 b(::)g(Parser)g(\(\))165 2032 y(junk)43
b(=)21 b([\(\))h(|)f(_)h(<-)f(setenv)g(\(0,-1\))f(\(many)h(\(spaces)f(+++)h
(comment\)\)])141 2113 y Fq(All)14 b(that)g(remains)f(no)o(w)h(is)h(to)f
(de\014ne)h(a)f(com)o(binator)f(that)h(parses)i(a)e(sequence)i(of)e
(de\014ni-)100 2167 y(tions)f(sub)r(ject)j(to)d(the)i(Gofer)e(o\013side)i
(rule:)165 2248 y Ff(many1_offside)41 b(::)21 b(Parser)g(a)g(->)h(Parser)e
([a])165 2302 y(many1_offside)f(p)j(=)f([vs)g(|)h(\(pos,_\))e(<-)i(fetch)644
2356 y(,)g(vs)130 b(<-)22 b(setenv)e(pos)h(\(many1)g(\(off)g(p\)\)])100
2437 y Fq(That)12 b(is,)h Ff(many1)p 368 2437 14 2 v 14 w(offside)21
b(p)12 b Fq(b)q(eha)o(v)o(es)i(just)f(as)g Ff(many1)21 b(\(off)g(p\))p
Fq(,)12 b(except)i(that)f(within)f(this)100 2491 y(parser)18
b(the)f(de\014nition)g(p)q(osition)f(is)h(set)h(to)f(the)g(curren)o(t)i(p)q
(osition.)c(\(There)k(is)d(no)h(need)h(to)100 2545 y(skip)c(white-space)i
(and)f(commen)o(ts)e(b)q(efore)j(setting)g(the)f(p)q(osition,)f(since)i(this)
f(will)e(already)100 2599 y(ha)o(v)o(e)f(b)q(een)h(e\013ected)i(b)o(y)d(prop)
q(er)h(use)h(of)e(the)h(lexical)e(com)o(binators)g Ff(token)g
Fq(and)i Ff(parse)p Fq(.\))e(The)100 2653 y(auxiliary)16 b(com)o(binator)h
Ff(off)h Fq(tak)o(es)h(care)g(of)f(setting)h(the)g(de\014nition)f(p)q
(osition)g(lo)q(cally)f(for)p eop
%%Page: 35 35
35 34 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(35)100 278 y(eac)o(h)17 b(new)g(de\014nition)f(in)g(the)h(sequence,)h
(where)g(a)e(new)h(de\014nition)f(b)q(egins)h(if)e(the)j(column)100
332 y(p)q(osition)13 b(equals)h(the)g(de\014nition)g(column)e(p)q(osition:)
165 413 y Ff(off)43 b(::)21 b(Parser)g(a)g(->)h(Parser)e(a)165
467 y(off)h(p)h(=)f([v)h(|)f(\(dl,dc\))64 b(<-)22 b(env)405
521 y(,)f(\(\(l,c\),_\))f(<-)i(fetch)405 575 y(,)f(c)h(==)f(dc)405
629 y(,)g(v)196 b(<-)22 b(setenv)e(\(l,dc\))h(p])141 710 y
Fq(F)m(or)14 b(completeness,)h(w)o(e)f(also)g(de\014ne)h(a)g(com)o(binator)d
Ff(many)p 1088 710 14 2 v 15 w(offside)h Fq(that)h(has)h(the)g(same)100
764 y(b)q(eha)o(viour)10 b(as)g(the)h(com)o(binator)e Ff(many1)p
732 764 V 15 w(offside)p Fq(,)f(except)k(that)e(it)g(can)h(also)f(parse)h(an)
f(empt)o(y)100 818 y(sequence)16 b(of)d(de\014nitions:)165
899 y Ff(many_offside)19 b(::)j(Parser)e(a)i(->)f(Parser)g([a])165
953 y(many_offside)e(p)j(=)f(many1_offside)f(p)h(+++)g([[]])141
1034 y Fq(T)m(o)c(illustrate)g(the)i(use)f(of)f(the)i(new)f(com)o(binators)e
(de\014ned)j(ab)q(o)o(v)o(e,)e(let)h(us)g(mo)q(dify)d(our)100
1088 y(parser)21 b(for)e Fh(\025)p Fq(-expressions)j(\(section)e(6.2\))f(so)h
(that)g(the)h(\\)p Ff(let)p Fq(")d(construct)k(p)q(ermits)d(non-)100
1142 y(empt)o(y)9 b(sequences)j(of)e(lo)q(cal)f(de\014nitions)h(sub)r(ject)h
(to)f(the)h(o\013side)f(rule.)g(The)g(datat)o(yp)q(e)g Ff(Expr)g
Fq(of)100 1196 y(expressions)j(is)e(\014rst)i(mo)q(di\014ed)d(so)i(that)g
(the)g Ff(Let)f Fq(constructor)i(has)f(t)o(yp)q(e)g Ff([\(String,Expr\)])100
1249 y(->)21 b(Expr)13 b Fq(instead)h(of)g Ff(String)20 b(->)h(Expr)g(->)h
(Expr)p Fq(:)165 1330 y Ff(data)f(Expr)g(=)h(...)383 1384 y(|)g(Let)f
([\(String,Expr\)])d(Expr)383 1438 y(|)k(...)100 1519 y Fq(The)14
b(only)e(part)i(of)f(the)h(parser)h(that)f(needs)h(to)e(b)q(e)h(mo)q
(di\014ed)f(is)g(the)h(parser)h Ff(local)e Fq(for)g(lo)q(cal)100
1573 y(de\014nitions,)g(whic)o(h)h(no)o(w)f(accepts)j(sequences:)165
1654 y Ff(local)21 b(=)g([Let)g(ds)h(e)f(|)h(_)43 b(<-)22 b(symbol)e("let")
557 1708 y(,)i(ds)f(<-)h(many1_offside)d(defn)557 1762 y(,)j(_)43
b(<-)22 b(symbol)e("in")557 1816 y(,)i(e)43 b(<-)22 b(expr])165
1924 y(defn)43 b(=)21 b([\(x,e\))g(|)g(x)h(<-)f(identifier)492
1978 y(,)g(_)h(<-)f(symbol)g("=")492 2032 y(,)g(e)h(<-)f(expr])141
2113 y Fq(W)m(e)10 b(conclude)i(this)e(section)i(b)o(y)e(noting)g(that)g(the)
i(use)f(of)f(the)h(o\013side)g(rule)g(when)g(la)o(ying)e(out)100
2167 y(sequences)j(of)c(Gofer)i(de\014nitions)f(is)g(not)h(mandatory)m(.)d
(As)j(sho)o(wn)f(in)g(our)h(initial)d(example,)h(one)100 2221
y(also)j(has)g(the)i(option)e(to)g(include)h(explicit)f(la)o(y)o(out)g
(information)d(in)k(the)g(form)e(of)h(paren)o(theses)100 2275
y(\\)p Fe(f)p Fq(")16 b(and)g(\\)p Fe(g)p Fq(")g(around)h(the)g(sequence,)h
(with)f(de\014nitions)f(separated)i(b)o(y)f(semi-colons)e(\\)p
Ff(;)p Fq(".)100 2329 y(W)m(e)c(lea)o(v)o(e)g(it)g(as)h(an)g(exercise)h(to)e
(the)i(reader)f(to)g(use)g Ff(many)p 1015 2329 V 15 w(offside)e
Fq(to)i(de\014ne)g(a)g(com)o(binator)100 2383 y(that)i(implem)o(en)o(ts)e
(this)i(con)o(v)o(en)o(tion.)141 2437 y(In)f(summary)e(then,)i(to)f(p)q
(ermit)h(com)o(binator)e(parsers)j(to)f(handle)g(the)g(Gofer)g(o\013side)g
(rule,)100 2491 y(w)o(e)k(c)o(hanged)h(the)g(t)o(yp)q(e)g(of)f(parsers)i(to)e
(include)h(some)e(p)q(ositional)g(information,)e(mo)q(di\014ed)100
2545 y(the)20 b Ff(item)f Fq(and)g Ff(junk)g Fq(com)o(binators)f(accordingly)
m(,)g(and)i(de\014ned)h(t)o(w)o(o)e(new)h(com)o(binators:)100
2599 y Ff(many1)p 213 2599 V 14 w(offside)15 b Fq(and)i Ff(many)p
568 2599 V 15 w(offside)p Fq(.)d(All)i(other)h(necessary)i(rede\014ning)e(of)
f(com)o(binators)100 2653 y(is)d(done)i(automatically)10 b(b)o(y)k(the)g
(Gofer)g(t)o(yp)q(e)g(system.)p eop
%%Page: 36 36
36 35 bop 100 178 a Fq(36)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)625 278 y Fl(9)24 b(Ac)o(kno)o(wledgemen)n(ts)100 358
y Fq(The)c(\014rst)g(author)f(w)o(as)h(emplo)o(y)o(ed)d(b)o(y)j(the)g(Univ)o
(ersit)o(y)f(of)g(Utrec)o(h)o(t)i(during)e(part)h(of)e(the)100
412 y(writing)13 b(of)g(this)h(article,)f(for)h(whic)o(h)g(funding)f(is)h
(gratefully)e(ac)o(kno)o(wledged.)141 466 y(Sp)q(ecial)18 b(thanks)g(are)g
(due)g(to)g(Luc)g(Dup)q(onc)o(heel)g(for)g(man)o(y)e(impro)o(v)o(emen)o(ts)f
(to)j(the)g(im-)100 520 y(plemen)o(tation)12 b(of)i(the)i(com)o(binator)c
(libraries)j(in)f(Gofer)g(\(particularly)g(concerning)h(the)g(use)100
574 y(of)g(t)o(yp)q(e)i(classes)h(and)e(restricted)i(t)o(yp)q(e)f(synon)o
(yms\),)e(and)h(to)g(Mark)g(P)m(.)g(Jones)h(for)f(detailed)100
628 y(commen)o(ts)c(on)h(the)i(\014nal)e(draft)h(of)f(this)h(article.)404
759 y Fl(10)23 b(App)q(endix:)14 b(a)i(parser)f(for)g(data)g(de\014nition)o
(s)100 839 y Fq(T)m(o)d(illustrate)h(the)h(monadic)e(parser)i(com)o(binators)
e(dev)o(elop)q(ed)i(in)f(this)h(article)f(in)g(a)g(real-life)100
893 y(setting,)d(w)o(e)g(consider)h(the)g(problem)e(of)h(parsing)g(a)g
(sequence)i(of)e(Gofer)g(datat)o(yp)q(e)g(de\014nitions.)100
947 y(An)k(example)e(of)i(suc)o(h)g(a)g(sequence)i(is)e(as)f(follo)o(ws:)165
1024 y Ff(data)21 b(List)g(a)h(=)f(Nil)g(|)h(Cons)f(a)g(\(List)g(a\))165
1132 y(data)g(Tree)g(a)h(b)f(=)h(Leaf)f(a)470 1186 y(|)h(Node)f(\(Tree)f(a)i
(b,)f(b,)h(Tree)f(a)g(b\))100 1263 y Fq(Within)12 b(the)j(parser,)f(datat)o
(yp)q(es)h(will)d(b)q(e)j(represen)o(ted)i(as)d(follo)o(ws:)165
1341 y Ff(type)21 b(Data)g(=)h(\(String,)281 b(--)22 b(type)f(name)427
1395 y([String],)259 b(--)22 b(parameters)427 1449 y([\(String,[Type])o
(\)]\))62 b(--)22 b(constructors)d(and)i(arguments)100 1526
y Fq(The)14 b(represen)o(tation)i Ff(Type)e Fq(for)g(t)o(yp)q(es)h(will)e(b)q
(e)i(treated)h(shortly)m(.)d(A)i(parser)h Ff(datadecls)j(::)100
1580 y(Parser)h([Data])13 b Fq(for)g(a)h(sequence)i(of)d(datat)o(yp)q(es)i
(can)f(no)o(w)f(b)q(e)i(de\014ned)g(b)o(y)165 1658 y Ff(datadecls)64
b(=)21 b(many_offside)e(datadecl)165 1766 y(datadecl)86 b(=)21
b([\(x,xs,b\))f(|)i(_)43 b(<-)21 b(symbol)g("data")688 1820
y(,)h(x)43 b(<-)21 b(constructor)688 1874 y(,)h(xs)f(<-)g(many)g(variable)688
1928 y(,)h(_)43 b(<-)21 b(symbol)g("=")688 1981 y(,)h(b)43
b(<-)21 b(condecl)g(`sepby1`)f(symbol)g("|"])165 2089 y(constructor)g(=)h
(token)g([\(x:xs\))f(|)i(x)43 b(<-)22 b(upper)775 2143 y(,)g(xs)f(<-)h(many)f
(alphanum])165 2251 y(variable)86 b(=)21 b(identifier)f(["data"])165
2359 y(condecl)108 b(=)21 b([\(x,ts\))f(|)i(x)43 b(<-)22 b(constructor)644
2413 y(,)g(ts)f(<-)h(many)f(type2])100 2491 y Fq(There)f(are)g(a)f(couple)g
(of)g(p)q(oin)o(ts)g(w)o(orth)h(noting)e(ab)q(out)h(this)h(parser.)g(Firstly)
m(,)e(all)g(lexical)100 2545 y(issues)d(\(white-space)h(and)f(commen)o(ts,)e
(the)i(o\013side)g(rule,)g(and)f(k)o(eyw)o(ords\))h(are)h(handled)e(b)o(y)100
2599 y(com)o(binators.)9 b(And)j(secondly)m(,)f(since)h Ff(constructor)d
Fq(is)i(a)g(parser)i(for)e(a)g(complete)f(tok)o(en,)h(the)100
2653 y Ff(token)h Fq(com)o(binator)g(is)i(applied)g(within)f(its)h
(de\014nition.)p eop
%%Page: 37 37
37 36 bop 565 178 a Fi(Monadic)15 b(Parser)g(Combinators)451
b Fq(37)141 278 y(Within)13 b(the)h(parser,)h(t)o(yp)q(es)g(will)d(b)q(e)j
(represen)o(ted)h(as)e(follo)o(ws:)165 358 y Ff(data)21 b(Type)65
b(=)21 b(Arrow)g(Type)g(Type)64 b(--)22 b(function)427 412
y(|)f(Apply)g(Type)g(Type)64 b(--)22 b(application)427 466
y(|)f(Var)g(String)173 b(--)22 b(variable)427 520 y(|)f(Con)g(String)173
b(--)22 b(constructor)427 574 y(|)f(Tuple)g([Type])129 b(--)22
b(tuple)427 628 y(|)f(List)g(Type)195 b(--)22 b(list)100 709
y Fq(A)14 b(parser)h Ff(type0)20 b(::)i(Parser)e(Type)13 b
Fq(for)h(t)o(yp)q(es)h(can)f(no)o(w)f(b)q(e)i(de\014ned)g(b)o(y)165
789 y Ff(type0)152 b(=)21 b(type1)g(`chainr1`)f([Arrow)g(|)i(_)g(<-)f(symbol)
f("->"])165 843 y(type1)152 b(=)21 b(type2)g(`chainl1`)f([Apply])165
897 y(type2)152 b(=)21 b(var)g(+++)g(con)h(+++)f(list)g(+++)g(tuple)165
1005 y(var)196 b(=)21 b([Var)g(x)h(|)f(x)h(<-)f(variable])165
1113 y(con)196 b(=)21 b([Con)g(x)h(|)f(x)h(<-)f(constructor])165
1221 y(list)174 b(=)21 b([List)g(x)g(|)h(x)g(<-)f(bracket)841
1275 y(\(symbol)f("["\))841 1329 y(type0)841 1383 y(\(symbol)g("]"\)])165
1491 y(tuple)152 b(=)21 b([f)g(ts)h(|)f(ts)h(<-)f(bracket)841
1545 y(\(symbol)f("\("\))841 1598 y(\(type0)g(`sepby`)g(symbol)h(","\))841
1652 y(\(symbol)f("\)"\)])470 1706 y(where)h(f)g([t])h(=)f(t)601
1760 y(f)g(ts)44 b(=)21 b(Tuple)g(ts)100 1841 y Fq(Note)15
b(ho)o(w)g Ff(chainr1)e Fq(and)i Ff(chainl1)e Fq(are)j(used)g(to)f(handle)g
(parsing)f(of)h(function-t)o(yp)q(es)g(and)100 1895 y(application.)c(Note)j
(also)f(that)h(\(as)g(in)f(Gofer\))g(building)f(a)h(singleton)g(tuple)h
Ff(\(t\))f Fq(of)g(a)g(t)o(yp)q(e)h Ff(t)100 1949 y Fq(is)f(not)h(p)q
(ossible,)g(since)h Ff(\(t\))e Fq(is)g(treated)j(as)e(a)f(paren)o(thesised)j
(expression.)735 2083 y Fl(References)100 2155 y Fk(Aho,)f(A.,)f(Sethi,)i
(R.,)f(&)g(Ullman,)h(J.)f(\(1986\).)24 b Fj(Compilers)15 b(|)h(principles,)d
(te)n(chniques)f(and)j(to)n(ols)p Fk(.)141 2201 y(Addison-W)m(esley)m(.)100
2255 y(Burge,)e(W.H.)f(\(1975\).)18 b Fj(R)n(e)n(cursive)11
b(pr)n(o)n(gr)n(amming)i(te)n(chnique)o(s)p Fk(.)h(Addison-W)m(esley)m(.)100
2309 y(F)m(okk)o(er,)j(Jero)q(en.)h(1995)g(\(Ma)o(y\).)31 b(F)m(unctional)20
b(parsers.)32 b Fj(L)n(e)n(ctur)n(e)16 b(notes)h(of)g(the)g(Baastad)f(Spring)
141 2354 y(scho)n(ol)c(on)h(functional)d(pr)n(o)n(gr)n(amming)p
Fk(.)100 2408 y(Gill,)20 b(Andy)m(,)g(&)e(Marlo)o(w,)i(Simon.)g(1995)g
(\(Jan.\).)35 b Fj(Happy:)17 b(the)h(p)n(arser)h(gener)n(ator)e(for)i(Haskel)
r(l)p Fk(.)141 2454 y(Univ)o(ersit)o(y)c(of)e(Glasgo)o(w.)100
2507 y(Hughes,)18 b(John.)h(\(1989\).)33 b(Wh)o(y)19 b(functional)h
(programming)g(matters.)33 b Fj(The)18 b(c)n(omputer)f(journal)p
Fk(,)141 2553 y Fb(32)p Fk(\(2\),)c(98{107.)100 2607 y(Hutton,)h(Graham.)h
(\(1992\).)23 b(Higher-order)16 b(functions)g(for)e(parsing.)24
b Fj(Journal)13 b(of)i(functional)d(pr)n(o-)141 2653 y(gr)n(amming)p
Fk(,)g Fb(2)p Fk(\(3\),)g(323{343.)p eop
%%Page: 38 38
38 37 bop 100 178 a Fq(38)430 b Fi(Gr)n(aham)15 b(Hutton)g(and)h(Erik)e
(Meijer)100 278 y Fk(Jones,)f(Mark)g(P)m(.)f(\(1994\).)18 b
Fj(Gofer)12 b(2.30a)g(r)n(ele)n(ase)g(notes)p Fk(.)j(Unpublished)h(man)o
(uscript.)100 332 y(Jones,)9 b(Mark)i(P)m(.)e(\(1995a\).)j(F)m(unctional)g
(programming)g(b)q(ey)o(ond)f(the)f(Hindley/Mil)q(ner)j(t)o(yp)q(e)d(system.)
141 378 y Fj(Pr)n(o)n(c.)j(le)n(ctur)n(e)f(notes)g(of)h(the)g(Baastad)e
(spring)i(scho)n(ol)e(on)i(functional)e(pr)n(o)n(gr)n(amming)p
Fk(.)100 432 y(Jones,)k(Mark)h(P)m(.)f(\(1995b\).)24 b Fj(The)16
b(Gofer)f(distribution)o Fk(.)21 b(Av)n(ailable)d(from)d(the)h(Univ)o(ersit)o
(y)h(of)e(Not-)141 477 y(tingham:)f Fa(http://www)o(.cs)o(.n)o(ott)o(.ac)o
(.u)o(k/D)o(ep)o(art)o(men)o(t/)o(Sta)o(ff)o(/mp)o(j/)o Fk(.)100
531 y(Jones,)e(Mark)h(P)m(.)f(\(1995c\).)k(A)c(system)h(of)f(constructor)i
(classes:)f(o)o(v)o(erloading)i(and)e(implicit)j(higher-)141
577 y(order)e(p)q(olymorphism.)19 b Fj(Journal)13 b(of)g(functional)d(pr)n(o)
n(gr)n(amming)p Fk(,)h Fb(5)p Fk(\(1\),)i(1{35.)100 631 y(Jones,)8
b(Simon)i(P)o(eyton,)g(&)e(Launc)o(h)o(bury)m(,)i(John.)f(\(1994\).)h
Fj(State)e(in)i(Haskel)r(l)p Fk(.)d(Univ)o(ersit)o(y)k(of)d(Glasgo)o(w.)100
685 y(Landin,)18 b(P)o(eter.)e(\(1966\).)30 b(The)16 b(next)i(700)f
(programming)i(languages.)31 b Fj(Communic)n(ations)14 b(of)j(the)141
731 y(A)o(CM)p Fk(,)c Fb(9)p Fk(\(3\).)100 785 y(Mogensen,)f(T)m(orb)q(en.)g
(\(1993\).)j Fj(R)n(atatosk:)10 b(a)i(p)n(arser)f(gener)n(ator)g(and)g(sc)n
(anner)f(gener)n(ator)h(for)h(Gofer)p Fk(.)141 830 y(Univ)o(ersit)o(y)j(of)e
(Cop)q(enhagen)h(\(DIKU\).)100 884 y(Moggi,)g(Eugenio.)h(\(1989\).)j
(Computation)d(lam)o(b)q(da-calculus)i(and)d(monads.)k Fj(Pr)n(o)n(c.)c(IEEE)
f(symp)n(o-)141 930 y(sium)j(on)f(lo)n(gic)f(in)i(c)n(omputer)e(scienc)n(e)p
Fk(.)22 b(A)15 b(extended)i(v)o(ersion)g(of)e(the)g(pap)q(er)i(is)f(a)o(v)n
(ailable)i(as)e(a)141 976 y(tec)o(hnical)f(rep)q(ort)f(from)e(the)i(Univ)o
(ersit)o(y)g(of)f(Edin)o(burgh.)100 1029 y(R\177)-19 b(ojemo,)12
b(Niklas.)j(\(1995\).)i Fj(Garb)n(age)11 b(c)n(ol)r(le)n(ction)g(and)h
(memory)i(e\016ciency)d(in)i(lazy)f(functional)e(lan-)141 1075
y(guages)p Fk(.)15 b(Ph.D.)e(thesis,)g(Chalmers)h(Univ)o(ersit)o(y)h(of)e(T)m
(ec)o(hnology)m(.)100 1129 y(Spiv)o(ey)m(,)d(Mik)o(e.)h(\(1990\).)h(A)d
(functional)j(theory)e(of)f(exceptions.)14 b Fj(Scienc)n(e)8
b(of)i(c)n(omputer)f(pr)n(o)n(gr)n(amming)p Fk(,)141 1175 y
Fb(14)p Fk(,)k(25{42.)100 1229 y(W)m(adler,)h(Philip.)i(\(1985\).)j(Ho)o(w)13
b(to)g(replace)i(failure)g(b)o(y)f(a)g(list)g(of)g(successes.)19
b Fj(Pr)n(o)n(c.)14 b(c)n(onfer)n(enc)n(e)d(on)141 1274 y(functional)f(pr)n
(o)n(gr)n(amming)j(and)f(c)n(omputer)g(ar)n(chite)n(ctur)n(e)p
Fk(.)i(Springer{V)m(erlag.)100 1328 y(W)m(adler,)19 b(Philip.)h(\(1990\).)32
b(Comprehending)21 b(monads.)33 b Fj(Pr)n(o)n(c.)17 b(A)o(CM)i(c)n(onfer)n
(enc)n(e)c(on)j(Lisp)f(and)141 1374 y(functional)10 b(pr)n(o)n(gr)n(amming)p
Fk(.)100 1428 y(W)m(adler,)19 b(Philip.)i(\(1992a\).)35 b(The)19
b(essence)g(of)f(functional)j(programming.)36 b Fj(Pr)n(o)n(c.)18
b(principles)f(of)141 1474 y(pr)n(o)n(gr)n(amming)12 b(languages)p
Fk(.)100 1528 y(W)m(adler,)i(Philip.)h(\(1992b\).)k(Monads)14
b(for)f(functional)i(programming.)20 b(Bro)o(y)m(,)13 b(Manfred)h(\(ed\),)f
Fj(Pr)n(o)n(c.)141 1573 y(Marktob)n(er)n(dorf)f(Summer)h(scho)n(ol)f(on)h(pr)
n(o)n(gr)n(am)g(design)e(c)n(alculi)p Fk(.)k(Springer{V)m(erlag.)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
