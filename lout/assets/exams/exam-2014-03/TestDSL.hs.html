<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-03/TestDSL.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>TestDSL</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>DSL</font>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font> <font color=Blue>-- only used for testing</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Testing code: not part of the exam.</font>
  
<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>C</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> sized arbC
  
arbC <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Gen</font> <font color=Green>C</font>  
arbC <font color=Magenta>0</font> <font color="#808080">=</font> elements <font color="#808080">[</font>false<font color="#808080">,</font> true<font color="#808080">]</font>
arbC n <font color="#808080">=</font> frequency <font color="#808080">[</font> <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> fmap inv   <font color="#808080">(</font>arbC <font color="#808080">(</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
                   <font color="#808080">,</font> <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> fmap delay <font color="#808080">(</font>arbC <font color="#808080">(</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
                   <font color="#808080">,</font> <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> fmap ands  <font color="#808080">(</font>arbListC n<font color="#808080">)</font><font color="#808080">)</font>
                   <font color="#808080">,</font> <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> fmap ors   <font color="#808080">(</font>arbListC n<font color="#808080">)</font><font color="#808080">)</font>
                   <font color="#808080">]</font>
  
arbListC <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Gen</font> <font color="#808080">[</font><font color=Green>C</font><font color="#808080">]</font>
arbListC n <font color="#808080">=</font> <u><font color="#804000">do</font></u> len <font color="#808080">&lt;-</font> choose <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> n <font color="#800080">`div`</font> <font color=Magenta>2</font><font color="#808080">)</font>
                <u><font color="#804000">let</font></u> m <font color="#808080">=</font> n <font color="#800080">`div`</font> len
                vectorOf len  <font color="#808080">(</font>arbC m<font color="#808080">)</font>

test <font color="#808080">=</font> take <font color=Magenta>5</font> <font color="#800080">$</font> run toggle

<font color=Blue>-- limit the list length to keep the running time down</font>
q f <font color="#808080">=</font> quickCheck <font color="#808080">(</font>forAll <font color="#808080">(</font>choose <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font><font color=Magenta>100</font><font color="#808080">)</font><font color="#808080">)</font> f<font color="#808080">)</font>

main <font color="#808080">=</font> <u><font color="#804000">do</font></u> q prop_inv
          quickCheck prop_delay0
          q prop_delay
          q prop_toggle
          q prop_true
</pre>
</body>
</html>