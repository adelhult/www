<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-08/DSL/Deep.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GADTs #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Deep</font> <font color="#808080">(</font><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Deep</font><font color="#808080">,</font> <u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Common</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Common</font>
<font color=Blue>{-
  Describe what a \emph{deep} implementation could look like. Give a
  type definition and describe (in words or code) what each of your primitive
  operations, and your run function, would do.
-}</font>


<u><font color="#804000">data</font></u> <font color=Green>Deep</font> <u><font color="#804000">where</font></u>
  <font color=Green>Text</font>   <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <font color=Green>Above</font>  <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <font color=Green>Beside</font> <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <font color=Green>Frame</font>  <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <font color=Blue>-- not in exam question</font>
  <font color=Green>Line</font>   <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <font color=Green>Empty</font>  <font color="#808080">::</font> <font color=Green>Art</font>
  <font color=Green>Space</font>  <font color="#808080">::</font> <font color=Green>ArtSize</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Eq</font><font color="#808080">,</font> <font color=Green>Show</font><font color="#808080">)</font>
  
text <font color="#808080">=</font> <font color=Green>Text</font><font color="#808080">;</font> frame <font color="#808080">=</font> <font color=Green>Frame</font><font color="#808080">;</font> above <font color="#808080">=</font> <font color=Green>Above</font><font color="#808080">;</font> beside  <font color="#808080">=</font> <font color=Green>Beside</font>
line <font color="#808080">=</font> <font color=Green>Line</font><font color="#808080">;</font> empty <font color="#808080">=</font> <font color=Green>Empty</font><font color="#808080">;</font> space <font color="#808080">=</font> <font color=Green>Space</font>

<u><font color="#804000">type</font></u> <font color=Green>Art</font> <font color="#808080">=</font> <font color=Green>Deep</font>

<font color=Blue>-- Run function:</font>
run <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Sem</font>
run <font color="#808080">(</font><font color=Green>Text</font>   s d<font color="#808080">)</font> <font color="#808080">=</font> textSem s d
run <font color="#808080">(</font><font color=Green>Above</font>  a b<font color="#808080">)</font> <font color="#808080">=</font> aboveSem   <font color="#808080">(</font>run a<font color="#808080">)</font> <font color="#808080">(</font>run b<font color="#808080">)</font>
run <font color="#808080">(</font><font color=Green>Beside</font> a b<font color="#808080">)</font> <font color="#808080">=</font> besideSem  <font color="#808080">(</font>run a<font color="#808080">)</font> <font color="#808080">(</font>run b<font color="#808080">)</font>
run <font color="#808080">(</font><font color=Green>Frame</font> a<font color="#808080">)</font>    <font color="#808080">=</font> frameSem   <font color="#808080">(</font>run a<font color="#808080">)</font>
run <font color="#808080">(</font><font color=Green>Line</font> n d<font color="#808080">)</font>   <font color="#808080">=</font> lineSem n d
run  <font color=Green>Empty</font>       <font color="#808080">=</font> emptySem
run <font color="#808080">(</font><font color=Green>Space</font> size<font color="#808080">)</font> <font color="#808080">=</font> spaceSem size
</pre>
</body>
</html>