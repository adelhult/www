<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-08/DSL/API.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>API</font> <u><font color="#804000">where</font></u>
<font color=Blue>-- DSL: design embedded domain specific languages</font>
<font color=Blue>--     DSL.Concepts: (abstract) syntax, semantics, ...</font>
<font color=Blue>--     DSL.Implement: implement EDSLs in Haskell (as combinator libraries) </font>

<font color=Blue>-- DSL: design an embedded domain specific language</font>
<font color=Blue>{-

This assignment is about design and implementation of an embedded
language for ``ASCII art''. The language should be compositional, that
is, enable building complex images by combining simpler images. 
Here is one example of what the language should be able to express (but
you need not implement the rendering).

+-+   +--------+
|1|   |+---+   |
|7|   ||hi!|   |
|3|   |+---+   |
|8|   |        |
+-+   |+------+|
      ||Patrik||
      |+------+|
      +--------+

Typical components are: horizontal text, vertical text, framed boxes,
relative placement (above, beside, etc.).

-}</font>
<font color=Blue>-- --------------------------------------------------------------</font>
<font color=Blue>{-
  Design an API for the above embedded language. This should consist
  of: suitable names of types, names and type of operations for
  constructing, combining and ``running''. For each operation,
  describe briefly what it is supposed to do.  Keep the role of each
  operation as simple as possible but add enough combinators to allow
  describing the picture above. (Note that this part does not ask for
  any implementation code, only names and type signatures.)

  Implement the example above in terms of your API.
-}</font>

example <font color="#808080">::</font> <font color=Green>Art</font>
example <font color="#808080">=</font> b1 <font color="#800080">+</font> space <font color="#800080">+</font> frame <font color="#808080">(</font>b2 <font color="#800080">/</font> space <font color="#800080">/</font> b3<font color="#808080">)</font>
  <u><font color="#804000">where</font></u>
    b1 <font color="#808080">=</font> frame <font color="#808080">(</font>vertical <font color="#808080">(</font>show <font color=Magenta>1738</font><font color="#808080">)</font><font color="#808080">)</font> 
    b2 <font color="#808080">=</font> frame <font color="#808080">(</font>horizontal <font color=Magenta>"hi!"</font><font color="#808080">)</font>
    b3 <font color="#808080">=</font> frame <font color="#808080">(</font>horizontal <font color=Magenta>"Patrik"</font><font color="#808080">)</font>
    space <font color="#808080">=</font> horizontal <font color=Magenta>"   "</font>
    <font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font> <font color="#808080">=</font> beside
    <font color="#808080">(</font><font color="#800080">/</font><font color="#808080">)</font> <font color="#808080">=</font> above

<u><font color="#804000">data</font></u> <font color=Green>Art</font> <font color="#808080">=</font> <font color=Green>Dummy</font> <font color=Blue>-- for the first part</font>
  <u><font color="#804000">deriving</font></u> <font color=Green>Eq</font>
<u><font color="#804000">data</font></u> <font color=Green>Dir</font> <font color="#808080">=</font> <font color=Green>Hori</font> <font color="#808080">|</font> <font color=Green>Vert</font>
frame <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
text <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
beside <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
above  <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>

vertical    <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
horizontal  <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>

<font color=Blue>-- Some run functions:</font>
<font color=Blue>-- render the ASCII Art as a String</font>
render <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> 
<font color=Blue>-- compute size</font>
size <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Int</font><font color="#808080">,</font> <font color=Green>Int</font><font color="#808080">)</font>

<font color=Blue>-- Just for type checking</font>
frame   <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
text    <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
beside  <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
above   <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
render  <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
size    <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>

<font color=Blue>-- --------------------------------------------------------------</font>
<font color=Blue>{-
  Which of the operations in your API are primitive and which are
  derived? Give definitions of the derived operations in terms of the
  primitive operations.

-}</font>

<font color=Blue>----------------</font>
<font color=Blue>-- Derived operations</font>
vertical    <font color="#808080">=</font> text <font color=Green>Vert</font>
horizontal  <font color="#808080">=</font> text <font color=Green>Hori</font>

<font color=Blue>-- Some possible derived operations:</font>
box   <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
box d s <font color="#808080">=</font> frame <font color="#808080">(</font>text d s<font color="#808080">)</font>

combine <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
combine <font color=Green>Hori</font> <font color="#808080">=</font> beside
combine <font color=Green>Vert</font> <font color="#808080">=</font> above

</pre>
</body>
</html>