<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20110823/Spec.hs</title>
</head>
<body>
<pre><font color=Blue>{-
--------------------------------------------------------------
-- Problem 1a
Formulate QuickCheck properties and generators to test the correctness
of a sorting function |mysort :: [Weekday] -&gt; [Weekday]|.
-}</font>

<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>
<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>List</font><font color="#808080">(</font><font color="#808080">(</font><font color="#800080">\\</font><font color="#808080">)</font><font color="#808080">,</font> sort<font color="#808080">)</font>

ordered <font color="#808080">::</font> <font color=Green>Ord</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
ordered <font color="#808080">(</font>x<b><font color="#800080">:</font></b>y<b><font color="#800080">:</font></b>ys<font color="#808080">)</font>  <font color="#808080">=</font>  x <font color="#800080">&lt;=</font> y <font color="#800080">&amp;&amp;</font> ordered <font color="#808080">(</font>y<b><font color="#800080">:</font></b>ys<font color="#808080">)</font>
ordered <u><font color="#804000">_</font></u>         <font color="#808080">=</font>  <font color=Green>True</font> <font color=Blue>-- shorter lists are always ordered</font>

bagEq <font color="#808080">::</font> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font> 
bagEq xs ys <font color="#808080">=</font> null <font color="#808080">(</font>xs <font color="#800080">\\</font> ys<font color="#808080">)</font> <font color="#800080">&amp;&amp;</font> null <font color="#808080">(</font>ys <font color="#800080">\\</font> xs<font color="#808080">)</font>

prop_mysort_correct <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>Weekday</font><font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_mysort_correct xs <font color="#808080">=</font> ordered ys <font color="#800080">&amp;&amp;</font> bagEq xs ys
  <u><font color="#804000">where</font></u> ys <font color="#808080">=</font> mysort xs

<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>Weekday</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> elements <font color="#808080">[</font><font color=Green>Mon</font> <font color="#808080">..</font> <font color=Green>Sun</font><font color="#808080">]</font>

<font color=Blue>-- Part of the problem formulation + some testing code:</font>

<u><font color="#804000">data</font></u> <font color=Green>Weekday</font> <font color="#808080">=</font> <font color=Green>Mon</font> <font color="#808080">|</font> <font color=Green>Tue</font> <font color="#808080">|</font> <font color=Green>Wed</font> <font color="#808080">|</font> <font color=Green>Thu</font> <font color="#808080">|</font> <font color=Green>Fri</font> <font color="#808080">|</font> <font color=Green>Sat</font> <font color="#808080">|</font> <font color=Green>Sun</font> 
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Eq</font><font color="#808080">,</font> <font color=Green>Ord</font><font color="#808080">,</font> <font color=Green>Show</font><font color="#808080">,</font> <font color=Green>Enum</font><font color="#808080">)</font>

mysort' xs <font color="#808080">=</font> <font color="#808080">(</font><u><font color="#804000">if</font></u> length xs <font color="#800080">==</font> <font color=Magenta>14</font> <u><font color="#804000">then</font></u> reverse <u><font color="#804000">else</font></u> id<font color="#808080">)</font> <font color="#808080">(</font>sort xs<font color="#808080">)</font>
mysort xs <font color="#808080">=</font> sort xs

main <font color="#808080">=</font> quickCheck prop_mysort_correct

<font color=Blue>{-
-- --------------------------------------------------------------  
-- Problem 1b  

Pick any |x|.
  
Proof by induction on the list |ys| for the predicate

  P ys = length (insert x ys) === 1 + length ys

Base case |P []|:

     length (insert x [])
==  {- Def. |ins.0| -}
     length [x]
==  {- Def. |len.0| -}
     1 + length []

Case |P (y:ys)|:

Induction hypothesis |P ys| is 
  |length (insert x ys) === 1 + length ys|.

subcase |x &lt;= y|:

     length (insert x (y:ys))
==  {- Def. |ins.1a| -}
     length (x : y : ys)
==  {- Def. |len.1| -}
     1 + length (y:ys) 

subcase |x &gt; y|:

     length (insert x (y:ys))
==  {- Def. |ins.1b| -}
     length (y : insert x ys)
==  {- Def. |len.1| -}
     1 + length (insert x ys) 
==  {- Induction hypothesis -}
     1 + (1 + length ys)
==  {- Def. |len.1| -}
     1 + length (y:ys)

-}</font>
</pre>
</body>
</html>