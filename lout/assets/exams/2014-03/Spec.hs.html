<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-03/Spec.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Spec</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Types</font>

<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font> hiding <font color="#808080">(</font><font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font><font color="#808080">,</font>return<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>Monoid</font>

<font color=Blue>-- a) </font>
<font color=Blue>--   fmap return  :: Monad2 m =&gt; m a          -&gt; m (m a)</font>
<font color=Blue>--   join         :: Monad2 m =&gt; m (m (m a))  -&gt; m (m a)</font>

units <font color="#808080">::</font> <font color=Green>Monad2</font> m <font color="#808080">=&gt;</font> <font color="#808080">[</font>m a <font color="#808080">-&gt;</font> m a<font color="#808080">]</font>
units <font color="#808080">=</font> <font color="#808080">[</font> join <font color="#800080">.</font> return
        <font color="#808080">,</font> id
        <font color="#808080">,</font> join <font color="#800080">.</font> <font color="#808080">(</font>fmap return <font color="#808080">::</font> <font color=Green>Monad2</font> m <font color="#808080">=&gt;</font> m a <font color="#808080">-&gt;</font> m <font color="#808080">(</font>m a<font color="#808080">)</font><font color="#808080">)</font>
        <font color="#808080">]</font>

assoc <font color="#808080">::</font> <font color=Green>Monad2</font> m <font color="#808080">=&gt;</font> <font color="#808080">[</font>m <font color="#808080">(</font>m <font color="#808080">(</font>m a<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> m a<font color="#808080">]</font>
assoc <font color="#808080">=</font> <font color="#808080">[</font> join <font color="#800080">.</font> fmap join 
        <font color="#808080">,</font> join <font color="#800080">.</font> <font color="#808080">(</font>join <font color="#808080">::</font> <font color=Green>Monad2</font> m <font color="#808080">=&gt;</font> m <font color="#808080">(</font>m <font color="#808080">(</font>m a<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> m <font color="#808080">(</font>m a<font color="#808080">)</font><font color="#808080">)</font>
        <font color="#808080">]</font>


<font color=Blue>-- b)</font>

z <font color="#808080">::</font> <font color=Green>Monoid</font> w <font color="#808080">=&gt;</font> w
z <font color="#808080">=</font> mempty

<u><font color="#804000">instance</font></u> <font color=Green>Monoid</font> w <font color="#808080">=&gt;</font> <font color=Green>Monad2</font> <font color="#808080">(</font><font color=Green>(,)</font> w<font color="#808080">)</font> <u><font color="#804000">where</font></u>
    return a           <font color="#808080">=</font> <font color="#808080">(</font>z        <font color="#808080">,</font> a<font color="#808080">)</font>
    join <font color="#808080">(</font>w<font color="#808080">,</font> <font color="#808080">(</font>w'<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>  <font color="#808080">=</font> <font color="#808080">(</font>w <font color="#800080">&lt;&gt;</font> w'  <font color="#808080">,</font> a<font color="#808080">)</font>

assocProof <font color="#808080">::</font> <font color=Green>Monoid</font> w <font color="#808080">=&gt;</font> <font color="#808080">(</font>w<font color="#808080">,</font> <font color="#808080">(</font>w<font color="#808080">,</font> <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font><font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">]</font>
assocProof <font color="#808080">(</font>w1<font color="#808080">,</font> <font color="#808080">(</font>w2<font color="#808080">,</font> <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=</font> 
    <font color="#808080">[</font> <font color="#808080">(</font>join <font color="#800080">.</font> fmap join<font color="#808080">)</font> <font color="#808080">(</font>w1<font color="#808080">,</font> <font color="#808080">(</font>w2<font color="#808080">,</font> <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |(.)|</font>
      join   <font color="#808080">(</font>fmap join  <font color="#808080">(</font>w1<font color="#808080">,</font> <font color="#808080">(</font>w2<font color="#808080">,</font> <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |fmap|</font>
      join <font color="#808080">(</font>w1<font color="#808080">,</font>    join       <font color="#808080">(</font>w2<font color="#808080">,</font> <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      join <font color="#808080">(</font>w1<font color="#808080">,</font>               <font color="#808080">(</font>w2 <font color="#800080">&lt;&gt;</font> w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      <font color="#808080">(</font>w1 <font color="#800080">&lt;&gt;</font> <font color="#808080">(</font>w2 <font color="#800080">&lt;&gt;</font> w3<font color="#808080">)</font><font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Monoid law (assoc. |(&lt;&gt;)|)</font>
      <font color="#808080">(</font><font color="#808080">(</font>w1 <font color="#800080">&lt;&gt;</font> w2<font color="#808080">)</font> <font color="#800080">&lt;&gt;</font> w3<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      join <font color="#808080">(</font>w1 <font color="#800080">&lt;&gt;</font> w2<font color="#808080">,</font>              <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      join <font color="#808080">(</font>join    <font color="#808080">(</font>w1<font color="#808080">,</font> <font color="#808080">(</font>w2<font color="#808080">,</font>      <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |(.)|</font>
      <font color="#808080">(</font>join <font color="#800080">.</font> join<font color="#808080">)</font> <font color="#808080">(</font>w1<font color="#808080">,</font> <font color="#808080">(</font>w2<font color="#808080">,</font>      <font color="#808080">(</font>w3<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">]</font>

unitProof <font color="#808080">::</font> <font color=Green>Monoid</font> w <font color="#808080">=&gt;</font> <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font><font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">]</font>
unitProof <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font> <font color="#808080">=</font> 
    <font color="#808080">[</font> <font color="#808080">(</font>join <font color="#800080">.</font> return<font color="#808080">)</font> <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |(.)|</font>
      join <font color="#808080">(</font>return <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |return|</font>
      join <font color="#808080">(</font>z<font color="#808080">,</font> <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      <font color="#808080">(</font>z <font color="#800080">&lt;&gt;</font> w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Monoid law</font>
      <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |id|. Left part of the law done.</font>
      id <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |id|. Right part proof starting.</font>
      <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Monoid law</font>
      <font color="#808080">(</font>w <font color="#800080">&lt;&gt;</font> z<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |join|</font>
      join <font color="#808080">(</font>w<font color="#808080">,</font> <font color="#808080">(</font>z<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |return|</font>
      join <font color="#808080">(</font>w<font color="#808080">,</font> return a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |fmap|</font>
      join <font color="#808080">(</font>fmap return <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
    <font color="#808080">,</font> <font color=Blue>-- Def. |(.)|</font>
      <font color="#808080">(</font>join <font color="#800080">.</font> fmap return<font color="#808080">)</font> <font color="#808080">(</font>w<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">]</font>
</pre>
</body>
</html>