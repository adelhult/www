<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-03/Types.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Types</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font> hiding <font color="#808080">(</font><font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font><font color="#808080">,</font>return<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>Monoid</font>


<u><font color="#804000">class</font></u> <font color=Green>Monad1</font> m <u><font color="#804000">where</font></u>
    return1  <font color="#808080">::</font> a <font color="#808080">-&gt;</font> m a
    bind1    <font color="#808080">::</font> m a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> m b<font color="#808080">)</font> <font color="#808080">-&gt;</font> m b

<u><font color="#804000">class</font></u> <font color=Green>Functor</font> m <font color="#808080">=&gt;</font> <font color=Green>Monad2</font> m <u><font color="#804000">where</font></u>
    return <font color="#808080">::</font> a <font color="#808080">-&gt;</font> m a
    join   <font color="#808080">::</font> m <font color="#808080">(</font>m a<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a

<font color=Blue>-- a)</font>

bind2 <font color="#808080">::</font> <font color=Green>Monad2</font> m <font color="#808080">=&gt;</font> m a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> m b<font color="#808080">)</font> <font color="#808080">-&gt;</font> m b
bind2 m f <font color="#808080">=</font> join <font color="#808080">(</font>fmap f m<font color="#808080">)</font>

<font color=Blue>-- b)</font>

join1 <font color="#808080">::</font> <font color=Green>Monad1</font> m <font color="#808080">=&gt;</font> m <font color="#808080">(</font>m a<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a
join1 mm <font color="#808080">=</font> bind1 mm id

<font color=Blue>-- c)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Monad2</font> <font color=Green>Maybe</font> <u><font color="#804000">where</font></u>
    return <font color="#808080">=</font> <font color=Green>Just</font>
    join <font color="#808080">=</font> joinMaybe
           
joinMaybe <font color="#808080">::</font> <font color=Green>Maybe</font> <font color="#808080">(</font><font color=Green>Maybe</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Maybe</font> a           
joinMaybe <font color="#808080">(</font><font color=Green>Just</font> <font color="#808080">(</font><font color=Green>Just</font> x<font color="#808080">)</font><font color="#808080">)</font>  <font color="#808080">=</font> <font color=Green>Just</font> x
joinMaybe <u><font color="#804000">_</font></u>                <font color="#808080">=</font> <font color=Green>Nothing</font>

<font color=Blue>-- d)</font>

<u><font color="#804000">newtype</font></u> <font color=Green>State</font> s a <font color="#808080">=</font> <font color=Green>State</font> <font color="#808080">{</font> runState <font color="#808080">::</font> s <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">,</font>s<font color="#808080">)</font> <font color="#808080">}</font>

<u><font color="#804000">instance</font></u> <font color=Green>Functor</font> <font color="#808080">(</font><font color=Green>State</font> s<font color="#808080">)</font> <u><font color="#804000">where</font></u>
    fmap <font color="#808080">=</font> fmapState 

fmapState <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>State</font> s a <font color="#808080">-&gt;</font> <font color=Green>State</font> s b
fmapState f <font color="#808080">(</font><font color=Green>State</font> m<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>State</font> <font color="#800080">$</font> <font color="#808080">\</font> s <font color="#808080">-&gt;</font> <u><font color="#804000">let</font></u>  <font color="#808080">(</font>a<font color="#808080">,</font>    s'<font color="#808080">)</font> <font color="#808080">=</font> m s 
                                       <u><font color="#804000">in</font></u>   <font color="#808080">(</font>f a<font color="#808080">,</font>  s'<font color="#808080">)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Monad2</font> <font color="#808080">(</font><font color=Green>State</font> s<font color="#808080">)</font> <u><font color="#804000">where</font></u>
    return  <font color="#808080">=</font> returnState
    join    <font color="#808080">=</font> joinState

returnState <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>State</font> s a
returnState a  <font color="#808080">=</font> <font color=Green>State</font> <font color="#800080">$</font> <font color="#808080">\</font> s <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">,</font> s<font color="#808080">)</font>

joinState <font color="#808080">::</font> <font color=Green>State</font> s <font color="#808080">(</font><font color=Green>State</font> s a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>State</font> s a
joinState <font color="#808080">(</font><font color=Green>State</font> mm<font color="#808080">)</font>   <font color="#808080">=</font> <font color=Green>State</font> <font color="#800080">$</font> <font color="#808080">\</font> s <font color="#808080">-&gt;</font>
    <u><font color="#804000">let</font></u> <font color="#808080">(</font>m<font color="#808080">,</font> s'<font color="#808080">)</font>  <font color="#808080">=</font> mm s
    <u><font color="#804000">in</font></u>  runState m s'

<font color=Blue>--  in  runState m s  -- planted bug</font>
</pre>
</body>
</html>