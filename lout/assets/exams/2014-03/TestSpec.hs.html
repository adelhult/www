<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-03/TestSpec.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GeneralizedNewtypeDeriving #-}</font>
<font color=Blue>{-# LANGUAGE StandaloneDeriving #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>TestSpec</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Types</font>
<u><font color="#804000">import</font></u> <font color=Green>Spec</font>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font><font color="#800080">.</font><font color=Green>Property</font> <u><font color="#804000">as</font></u> <font color=Green>QC</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font><font color="#800080">.</font><font color=Green>Arbitrary</font> <u><font color="#804000">as</font></u> <font color=Green>QC</font>

<u><font color="#804000">deriving</font></u> <u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>CoArbitrary</font> s<font color="#808080">,</font> <font color=Green>Arbitrary</font> s<font color="#808080">,</font> <font color=Green>Arbitrary</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> 
                  <font color=Green>Arbitrary</font> <font color="#808080">(</font><font color=Green>State</font> s a<font color="#808080">)</font>


<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Testing code below - not asked for on the exam</font>

<font color=Blue>-- Straw-man proofs in Haskell (just a list of supposedly equal expr.)</font>
<u><font color="#804000">newtype</font></u> <font color=Green>AllEq</font> a <font color="#808080">=</font> <font color=Green>AllEq</font> <font color="#808080">[</font>a<font color="#808080">]</font> 
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Arbitrary</font><font color="#808080">)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color=Green>Testable</font> <font color="#808080">(</font><font color=Green>AllEq</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  property <font color="#808080">=</font> propertyAllEq 
                          
propertyAllEq <font color="#808080">::</font> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color=Green>AllEq</font> a <font color="#808080">-&gt;</font> <font color=Green>Property</font>
propertyAllEq <font color="#808080">(</font><font color=Green>AllEq</font> xs<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>QC</font><font color="#800080">.</font>property <font color="#800080">$</font> <font color=Green>QC</font><font color="#800080">.</font>liftBool <font color="#800080">$</font> allEq xs
    
allEq <font color=Green>[]</font>      <font color="#808080">=</font>  <font color=Green>True</font>
allEq <font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs<font color="#808080">)</font>  <font color="#808080">=</font>  all <font color="#808080">(</font>x<font color="#800080">==</font><font color="#808080">)</font> xs

runUnits s <font color="#808080">(</font><font color=Green>Blind</font> ma<font color="#808080">)</font> <font color="#808080">=</font> allEq <font color="#800080">$</font> map <font color="#808080">(</font><font color="#808080">\</font>f <font color="#808080">-&gt;</font> runState <font color="#808080">(</font>f <font color="#808080">(</font>ma <font color="#808080">::</font> <font color=Green>State</font> <font color=Green>Int</font> <font color=Green>Bool</font><font color="#808080">)</font><font color="#808080">)</font> 
                                                    <font color="#808080">(</font>s <font color="#808080">::</font> <font color=Green>Int</font><font color="#808080">)</font><font color="#808080">)</font> 
                                    units

unitProof'  <font color="#808080">::</font> <font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font> <font color=Green>Bool</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>AllEq</font> <font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font> <font color=Green>Bool</font><font color="#808080">)</font>
unitProof' <font color="#808080">=</font> <font color=Green>AllEq</font> <font color="#800080">.</font> unitProof

assocProof' <font color="#808080">::</font> <font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font><font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font><font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font><font color=Green>Bool</font><font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>AllEq</font> <font color="#808080">(</font><font color="#808080">[</font><font color=Green>Int</font><font color="#808080">]</font><font color="#808080">,</font><font color=Green>Bool</font><font color="#808080">)</font>
assocProof' <font color="#808080">=</font> <font color=Green>AllEq</font> <font color="#800080">.</font> assocProof

main <font color="#808080">=</font> <u><font color="#804000">do</font></u> quickCheck unitProof'
          quickCheck assocProof'
          quickCheck runUnits

</pre>
</body>
</html>