<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20130316/Spec.hs</title>
</head>
<body>
<pre><u><font color="#804000">import</font></u> <font color=Green>Prelude</font> hiding <font color="#808080">(</font><font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font><font color="#808080">,</font> head<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>List</font>
<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>List</font><font color="#808080">(</font><font color="#808080">(</font><font color="#800080">\\</font><font color="#808080">)</font><font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>

<font color=Blue>{- Task 1 (a): Imagine you should test an implementation of a function
|sort :: Ord a =&gt; [a] -&gt; [a]|. Implement a QuickCheck property which
checks that the result is ordered and a permutation of the input.  -}</font>

<font color=Blue>-- | Bad sort - just for testing</font>
sort <font color="#808080">::</font> <font color=Green>Ord</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
sort xs <font color="#808080">|</font> length xs <font color="#800080">==</font> <font color=Magenta>10</font>  <font color="#808080">=</font> xs
        <font color="#808080">|</font> otherwise        <font color="#808080">=</font> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>List</font><font color="#800080">.</font>sort xs

prop_sort_correct <font color="#808080">::</font> <font color=Green>Ord</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_sort_correct xs <font color="#808080">=</font> ordered ys <font color="#800080">&amp;&amp;</font> bagEq xs ys
  <u><font color="#804000">where</font></u> ys <font color="#808080">=</font> sort xs
        
ordered <font color="#808080">::</font> <font color=Green>Ord</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
ordered <font color="#808080">(</font>x<b><font color="#800080">:</font></b>y<b><font color="#800080">:</font></b>ys<font color="#808080">)</font> <font color="#808080">=</font> x <font color="#800080">&lt;=</font> y <font color="#800080">&amp;&amp;</font> ordered <font color="#808080">(</font>y<b><font color="#800080">:</font></b>ys<font color="#808080">)</font>
ordered <u><font color="#804000">_</font></u> <font color="#808080">=</font> <font color=Green>True</font>

bagEq <font color="#808080">::</font> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
bagEq xs ys <font color="#808080">=</font> null <font color="#808080">(</font>xs <font color="#800080">\\</font> ys<font color="#808080">)</font> <font color="#800080">&amp;&amp;</font> null <font color="#808080">(</font>ys <font color="#800080">\\</font> xs<font color="#808080">)</font>

test <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_sort_correct <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>

<font color=Blue>{- Task 1 (b): Explain what ``pure'' (referentially transparent) means
in a functional programming context and how it relates to equational
reasoning.
----

The value of a pure expression only depends on its free variables, not
on any state or interaction with the outside world. A pure functional
language is one where all expressions are pure. Equational reasoning
is very difficult (or impossible) for impure languages. Haskell is a
pure functional language. See also lecture 6:

"Referential transparency
* ``Equals can be substituted for equals''
* In other words: if an expression has a value in a context, we can
  replace it with any other expression that has the same value in the
  context without affecting the meaning of the program."

-}</font>

<font color=Blue>{- Task 1 (c): Even though list concatenation is associative, that is
|lhs == (as++bs)++cs == as++(bs++cs) == rhs|, it may still be good for
performance to transform |lhs| to |rhs|. Explain why by expanding
|head lhs| and |head rhs|. You may assume that only case distinctions
(pattern matching) takes time and that |as| contains at least one
element. -}</font>

<font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font> <font color="#808080">::</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
xs <font color="#800080">++</font> ys <font color="#808080">=</font> <u><font color="#804000">case</font></u> xs <u><font color="#804000">of</font></u>
  <font color=Green>[]</font>       <font color="#808080">-&gt;</font> ys                 <font color=Blue>-- ++.1</font>
  <font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs'<font color="#808080">)</font>  <font color="#808080">-&gt;</font> x <b><font color="#800080">:</font></b> <font color="#808080">(</font>xs' <font color="#800080">++</font> ys<font color="#808080">)</font>    <font color=Blue>-- ++.2</font>

head <font color=Green>[]</font>     <font color="#808080">=</font> error <font color=Magenta>"head []"</font>        <font color=Blue>-- head.1</font>
head <font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs<font color="#808080">)</font> <font color="#808080">=</font> x                      <font color=Blue>-- head.2</font>

expand_lhs x xs ys zs <font color="#808080">=</font> 
  <font color="#808080">[</font> head <font color="#800080">$</font> <font color="#808080">(</font><font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs<font color="#808080">)</font><font color="#800080">++</font>ys<font color="#808080">)</font><font color="#800080">++</font>zs
  <font color="#808080">,</font> <font color=Blue>-- ++.2: first step</font>
    head <font color="#800080">$</font> <font color="#808080">(</font>x<b><font color="#800080">:</font></b><font color="#808080">(</font>xs<font color="#800080">++</font>ys<font color="#808080">)</font><font color="#808080">)</font><font color="#800080">++</font>zs
  <font color="#808080">,</font> <font color=Blue>-- ++.2: second step</font>
    head <font color="#800080">$</font> x<b><font color="#800080">:</font></b><font color="#808080">(</font><font color="#808080">(</font>xs<font color="#800080">++</font>ys<font color="#808080">)</font><font color="#800080">++</font>zs<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- head.2</font>
    x
  <font color="#808080">]</font>

expand_rhs x xs ys zs <font color="#808080">=</font> 
  <font color="#808080">[</font> head <font color="#800080">$</font> <font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs<font color="#808080">)</font><font color="#800080">++</font><font color="#808080">(</font>ys<font color="#800080">++</font>zs<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- ++.2: only step</font>
    head <font color="#800080">$</font> x<b><font color="#800080">:</font></b><font color="#808080">(</font>xs<font color="#800080">++</font><font color="#808080">(</font>ys<font color="#800080">++</font>zs<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- head.2</font>
    x
  <font color="#808080">]</font>

<font color=Blue>{- As we can see expand_lhs takes two time steps while expand_rhs only
 takes one time step. -}</font>
</pre>
</body>
</html>