<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem2/Proof.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem2</font><font color="#800080">.</font><font color=Green>Proof</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Problem2</font><font color="#800080">.</font><font color=Green>Prod</font>

<font color=Blue>-- I present the proof "in Haskell" just to be able to check the types</font>
<font color=Blue>-- of the steps - this is not required.</font>

<u><font color="#804000">type</font></u> <font color=Green>EqProof</font> <font color="#808080">=</font> <font color=Green>[]</font>
<font color=Blue>-- Poor man's equality proofs - a list of (supposedly) equal</font>
<font color=Blue>-- expression "proving" the equality of the first and the last</font>
<font color=Blue>-- expression by a series of motivated steps</font>

<font color=Blue>----------------</font>
proof_LeftId <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>EqProof</font> <font color="#808080">(</font><font color=Green>Prod</font> m n b<font color="#808080">)</font>
proof_LeftId a f <font color="#808080">=</font>
  <font color="#808080">[</font> return a <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- def. of return</font>
    <font color=Green>Prod</font> <font color="#808080">(</font>return a<font color="#808080">,</font> return a<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- def. of (&gt;&gt;=)</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> return a <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font>
         <font color="#808080">,</font> return a <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font> <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- LeftId law for m and for n</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font> a
         <font color="#808080">,</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font> a <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- def. of composition</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> fstP <font color="#808080">(</font>f a<font color="#808080">)</font>
         <font color="#808080">,</font> sndP <font color="#808080">(</font>f a<font color="#808080">)</font> <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- SurjectivePairing</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> unProd <font color="#808080">(</font>f a<font color="#808080">)</font> <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- Inverses</font>
    f a
  <font color="#808080">]</font>

<font color=Blue>----------------</font>
proof_RightId <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Prod</font> m n a <font color="#808080">-&gt;</font> <font color=Green>EqProof</font> <font color="#808080">(</font><font color=Green>Prod</font> m n a<font color="#808080">)</font>
proof_RightId mx <font color="#808080">=</font>
  <font color="#808080">[</font> mx <font color="#800080">&gt;&gt;=</font> return
  <font color="#808080">,</font> <font color=Blue>-- inverses</font>
    <font color=Green>Prod</font> <font color="#808080">(</font>unProd mx<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> return
  <font color="#808080">,</font> <font color=Blue>-- surjectivePairing</font>
    <font color=Green>Prod</font> <font color="#808080">(</font>fstP mx<font color="#808080">,</font> sndP mx<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> return
  <font color="#808080">,</font> <font color=Blue>-- def. of (&gt;&gt;=), return</font>
<font color=Blue>{- -- commented out due to ambiguous type variables
    Prod ( fstP mx &gt;&gt;= (fstP . returnProd)
         , sndP mx &gt;&gt;= (sndP . returnProd) )
  , -- fstP_return and sndP_return
-}</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> return
         <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> return <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- RightId law for m and for n</font>
    <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx
         <font color="#808080">,</font> sndP mx <font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- surjectivePairing</font>
    <font color=Green>Prod</font> <font color="#808080">(</font>unProd mx<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>-- Inverses</font>
    mx
  <font color="#808080">]</font>

<font color=Blue>{-
-- commented out due to ambiguous type variables

fstP_return x =
  [ (fstP . returnProd) x
  , -- def. of (.)
    fst (unProd (returnProd x))
  , -- def. of returnProd
    fst (unProd (Prod (return x, return x)))
  , -- Inverses
    fst (return x, return x)
  , -- def. of fst
    return x
  ]

sndP_return :: (Monad n) =&gt; a -&gt; n a
sndP_return x =
  [ (sndP . returnProd) x
  , -- as in fstP_return
    return x
  ]
-}</font>

<font color=Blue>-- ----------------------------------------------------------------</font>
proof_Assoc <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Prod</font> m n c <font color="#808080">-&gt;</font> <font color="#808080">(</font>c <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>b <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>EqProof</font> <font color="#808080">(</font><font color=Green>Prod</font> m n a<font color="#808080">)</font>
proof_Assoc mx f g  <font color="#808080">=</font>
 <font color="#808080">[</font> <font color="#808080">(</font>mx <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> g
 <font color="#808080">,</font> <font color=Blue>-- Inverses, surjectivePairing</font>
   <font color="#808080">(</font><font color=Green>Prod</font> <font color="#808080">(</font>fstP mx<font color="#808080">,</font> sndP mx<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> g
 <font color="#808080">,</font> <font color=Blue>-- Def. of (&gt;&gt;=)</font>
   <font color="#808080">(</font><font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font>
         <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font> <font color="#808080">)</font> <font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> g
 <font color="#808080">,</font> <font color=Blue>-- Def. of (&gt;&gt;=)</font>
   <font color=Green>Prod</font> <font color="#808080">(</font> <font color="#808080">(</font>fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
        <font color="#808080">,</font> <font color="#808080">(</font>sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> g<font color="#808080">)</font><font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Assoc. law for the underlying monads m and n</font>
   <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font> x <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
        <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>y <font color="#808080">-&gt;</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font> y <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Def. of (.)</font>
   <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> fstP <font color="#808080">(</font>f x<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
        <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>y <font color="#808080">-&gt;</font> sndP <font color="#808080">(</font>f y<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- fstP_distributes and sndP_distributes</font>
   <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> fstP <font color="#808080">(</font>f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
        <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>y <font color="#808080">-&gt;</font> sndP <font color="#808080">(</font>f y <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font> <font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Def. of (.) + alpha renaming</font>
   <font color=Green>Prod</font> <font color="#808080">(</font> fstP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font><font color="#808080">)</font>
        <font color="#808080">,</font> sndP mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- def. of (&gt;&gt;=)</font>
   <font color=Green>Prod</font> <font color="#808080">(</font>fstP mx<font color="#808080">,</font> sndP mx<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- def. of return</font>
   <font color=Green>Prod</font> <font color="#808080">(</font>fstP mx<font color="#808080">,</font> sndP mx<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- expand mx</font>
   mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
 <font color="#808080">]</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Not part of the exam question</font>

fstP_distributes <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font>
   <font color="#808080">(</font>c <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>b <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n a<font color="#808080">)</font> <font color="#808080">-&gt;</font> c <font color="#808080">-&gt;</font> <font color=Green>EqProof</font> <font color="#808080">(</font>m a<font color="#808080">)</font>
fstP_distributes f g x <font color="#808080">=</font>
 <font color="#808080">[</font> fstP <font color="#808080">(</font>f x<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Def. of fstP</font>
   fst <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Def. of fst</font>
   fst <font color="#808080">(</font> fst <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
       <font color="#808080">,</font> snd <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- Inverses</font>
   fst <font color="#808080">(</font>unProd <font color="#808080">(</font><font color=Green>Prod</font> <font color="#808080">(</font> fst <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> g<font color="#808080">)</font>
                     <font color="#808080">,</font> snd <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- def. of (&gt;&gt;=), fstP</font>
   fstP <font color="#808080">(</font><font color=Green>Prod</font> <font color="#808080">(</font>fst <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">,</font> snd <font color="#808080">(</font>unProd <font color="#808080">(</font>f x<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
 <font color="#808080">,</font> <font color=Blue>-- expand (f x)</font>
   fstP <font color="#808080">(</font>f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font>
 <font color="#808080">]</font>

<font color=Blue>-- sndP_distributes is similar</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Just some type checking of the laws</font>

prop_LeftId  <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>m a <font color="#808080">-&gt;</font> m a <font color="#808080">-&gt;</font> t<font color="#808080">)</font> <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> <font color="#808080">(</font>b <font color="#808080">-&gt;</font> m a<font color="#808080">)</font> <font color="#808080">-&gt;</font> t
prop_RightId <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>m a <font color="#808080">-&gt;</font> m a <font color="#808080">-&gt;</font> t<font color="#808080">)</font> <font color="#808080">-&gt;</font> m a <font color="#808080">-&gt;</font> t
prop_Assoc   <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>m a <font color="#808080">-&gt;</font> m a <font color="#808080">-&gt;</font> t<font color="#808080">)</font> <font color="#808080">-&gt;</font> m c <font color="#808080">-&gt;</font> <font color="#808080">(</font>c <font color="#808080">-&gt;</font> m b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>b <font color="#808080">-&gt;</font> m a<font color="#808080">)</font> <font color="#808080">-&gt;</font> t

prop_LeftId  <font color="#808080">(</font><font color="#800080">~=</font><font color="#808080">)</font> a f     <font color="#808080">=</font>  <font color="#808080">(</font> return a <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x<font color="#808080">)</font><font color="#808080">)</font>  <font color="#800080">~=</font>  <font color="#808080">(</font> f a                       <font color="#808080">)</font>
prop_RightId <font color="#808080">(</font><font color="#800080">~=</font><font color="#808080">)</font> mx      <font color="#808080">=</font>  <font color="#808080">(</font> mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> return x<font color="#808080">)</font> <font color="#808080">)</font>  <font color="#800080">~=</font>  <font color="#808080">(</font> mx                        <font color="#808080">)</font>
prop_Assoc   <font color="#808080">(</font><font color="#800080">~=</font><font color="#808080">)</font> mx f g  <font color="#808080">=</font>  <font color="#808080">(</font> <font color="#808080">(</font>mx <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#800080">&gt;&gt;=</font> g        <font color="#808080">)</font>  <font color="#800080">~=</font>  <font color="#808080">(</font>  mx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font> <font color="#808080">)</font>
</pre>
</body>
</html>