<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem2/NonLaws.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem2</font><font color="#800080">.</font><font color=Green>NonLaws</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Control</font><font color="#800080">.</font><font color=Green>Exception</font> <u><font color="#804000">as</font></u> <font color=Green>CE</font>

<font color=Blue>-- Surjective pairing does not hold, examples are p1 and p2</font>
p1<font color="#808080">,</font> p2 <font color="#808080">::</font> <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font>
p1 <font color="#808080">=</font> undefined
p2 <font color="#808080">=</font> <font color="#808080">(</font>fst p1<font color="#808080">,</font> snd p1<font color="#808080">)</font>
<font color=Blue>-- They can be distinguished using seq (or pattern matching)</font>

<font color=Blue>-- Eta-expansion does not hold, examples are f1 and f2</font>
f1<font color="#808080">,</font> f2 <font color="#808080">::</font> a<font color="#808080">-&gt;</font>b
f1 <font color="#808080">=</font> undefined
f2 <font color="#808080">=</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> f1 x
<font color=Blue>-- They can be distinguished (only) using seq</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- The rest is not part of the exam question, but shows how to make the Haskell</font>
<font color=Blue>--   compiler tell the difference</font>

test1 x <font color="#808080">=</font> <font color=Green>CE</font><font color="#800080">.</font>catch <font color="#808080">(</font>x <font color="#800080">`seq`</font> return <font color=Green>False</font><font color="#808080">)</font> <font color="#800080">$</font> return <font color="#800080">.</font> constTrue
  <u><font color="#804000">where</font></u> constTrue <font color="#808080">::</font> <font color=Green>SomeException</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
        constTrue <u><font color="#804000">_</font></u> <font color="#808080">=</font> <font color=Green>True</font>

test2 x y <font color="#808080">=</font> <u><font color="#804000">do</font></u> x_bot <font color="#808080">&lt;-</font> test1 x
               y_bot <font color="#808080">&lt;-</font> test1 y
               print <font color="#808080">(</font>x_bot <font color="#800080">==</font> y_bot<font color="#808080">)</font>


main <font color="#808080">=</font> <u><font color="#804000">do</font></u> putStr <font color=Magenta>"Surjective pairing is "</font><font color="#808080">;</font> test2 p1 p2
          putStr <font color=Magenta>"Eta expansion is      "</font><font color="#808080">;</font> test2 f1 f2

<font color=Blue>-- If the program would say True, that would not be a proof (it has to</font>
<font color=Blue>-- hold for all values) but if it says False that is definite.</font>
</pre>
</body>
</html>