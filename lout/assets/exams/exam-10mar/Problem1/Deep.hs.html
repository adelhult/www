<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem1/Deep.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GADTs #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Deep</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font> <u><font color="#804000">as</font></u> <font color=Green>P</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font><font color="#808080">(</font><font color=Green>Int</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color=Blue>-</font><font color="#808080">)</font><font color="#808080">,</font>max<font color="#808080">,</font>min<font color="#808080">,</font><font color="#808080">(</font><font color="#800080">&lt;</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">&lt;=</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">==</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">&amp;&amp;</font><font color="#808080">)</font><font color="#808080">,</font><font color=Green>Bool</font><font color="#808080">,</font><font color=Green>Show</font><font color="#808080">,</font><font color=Green>String</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">!!</font><font color="#808080">)</font><font color="#808080">,</font> otherwise<font color="#808080">,</font> div<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Shallow</font> <u><font color="#804000">as</font></u> <font color=Green>V</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Shallow_Instances</font> <font color=Green>()</font>
<font color=Blue>----------------</font>
<font color=Blue>-- Problem 1(c)</font>

<u><font color="#804000">type</font></u> <font color=Green>Ix</font> <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Int</font>
<u><font color="#804000">type</font></u> <font color=Green>Length</font> <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Int</font>
<u><font color="#804000">type</font></u> <font color=Green>Vector</font> <font color="#808080">=</font> <font color=Green>D</font>

<u><font color="#804000">data</font></u> <font color=Green>D</font> a <u><font color="#804000">where</font></u>
  <font color=Green>FromList</font> <font color="#808080">::</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>D</font> a
  <font color=Green>FromV</font>    <font color="#808080">::</font> <font color=Green>V</font><font color="#800080">.</font><font color=Green>V</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a
  <font color="#808080">(</font><b><font color="#800080">:++</font></b><font color="#808080">)</font>    <font color="#808080">::</font> <font color=Green>D</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a

<font color=Blue>-- primitive</font>
<font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font>      <font color="#808080">::</font>  <font color=Green>D</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a
<font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font><b><font color="#800080">:++</font></b><font color="#808080">)</font>

length    <font color="#808080">::</font>  <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color=Green>Length</font>
length <font color="#808080">(</font>xs <b><font color="#800080">:++</font></b> ys<font color="#808080">)</font>    <font color="#808080">=</font>  length xs <font color="#800080">+</font> length ys
length <font color="#808080">(</font><font color=Green>FromList</font> xs<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>P</font><font color="#800080">.</font>length xs
length <font color="#808080">(</font><font color=Green>FromV</font> v<font color="#808080">)</font>      <font color="#808080">=</font>  <font color=Green>V</font><font color="#800080">.</font>length v

drop      <font color="#808080">::</font>  <font color=Green>Ix</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a
drop i <font color="#808080">(</font>xs <b><font color="#800080">:++</font></b> ys<font color="#808080">)</font> <font color="#808080">|</font> i <font color="#800080">&lt;=</font> l     <font color="#808080">=</font>  drop i xs <b><font color="#800080">:++</font></b> ys
                   <font color="#808080">|</font> otherwise  <font color="#808080">=</font>  drop <font color="#808080">(</font>i<font color=Blue>-</font>l<font color="#808080">)</font> ys
  <u><font color="#804000">where</font></u> l <font color="#808080">=</font> length xs
drop i <font color="#808080">(</font><font color=Green>FromList</font> xs<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>FromList</font> <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>drop i xs<font color="#808080">)</font>
drop i <font color="#808080">(</font><font color=Green>FromV</font> v<font color="#808080">)</font>      <font color="#808080">=</font>  <font color=Green>FromV</font> <font color="#808080">(</font><font color=Green>V</font><font color="#800080">.</font>drop i v<font color="#808080">)</font>

take      <font color="#808080">::</font>  <font color=Green>Ix</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a
take i <font color="#808080">(</font>xs <b><font color="#800080">:++</font></b> ys<font color="#808080">)</font> <font color="#808080">|</font> i <font color="#800080">&lt;=</font> l     <font color="#808080">=</font>  take i xs
                   <font color="#808080">|</font> otherwise  <font color="#808080">=</font>  xs <b><font color="#800080">:++</font></b> take <font color="#808080">(</font>i<font color=Blue>-</font>l<font color="#808080">)</font> ys
  <u><font color="#804000">where</font></u> l <font color="#808080">=</font> length xs
take i <font color="#808080">(</font><font color=Green>FromList</font> xs<font color="#808080">)</font>            <font color="#808080">=</font>  <font color=Green>FromList</font> <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>take i xs<font color="#808080">)</font>
take i <font color="#808080">(</font><font color=Green>FromV</font> v<font color="#808080">)</font>                <font color="#808080">=</font>  <font color=Green>FromV</font> <font color="#808080">(</font><font color=Green>V</font><font color="#800080">.</font>take i v<font color="#808080">)</font>

<font color=Blue>-- Derived operations:</font>

splitAt   <font color="#808080">::</font>  <font color=Green>Ix</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Vector</font> a<font color="#808080">,</font> <font color=Green>Vector</font> a<font color="#808080">)</font>
splitAt i v <font color="#808080">=</font> <font color="#808080">(</font>take i v<font color="#808080">,</font> drop i v<font color="#808080">)</font>

<font color=Blue>-- --------------------------------------------------------------</font>
<font color=Blue>-- For completeness (not asked for in exam question):</font>

fromFun   <font color="#808080">::</font>  <font color=Green>Length</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Ix</font> <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a
fromFun l f <font color="#808080">=</font> <font color=Green>FromV</font> <font color="#808080">(</font><font color=Green>V</font><font color="#800080">.</font><font color=Green>V</font> l f<font color="#808080">)</font>

fromList  <font color="#808080">::</font>  <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a
fromList <font color="#808080">=</font> <font color=Green>FromList</font>

index     <font color="#808080">::</font>  <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color=Green>Ix</font> <font color="#808080">-&gt;</font> a
index <font color="#808080">(</font>xs <b><font color="#800080">:++</font></b> ys<font color="#808080">)</font> i <font color="#808080">|</font> i<font color="#800080">&lt;</font>l        <font color="#808080">=</font>  index xs i
                    <font color="#808080">|</font> otherwise  <font color="#808080">=</font>  index ys <font color="#808080">(</font>i<font color=Blue>-</font>l<font color="#808080">)</font>
  <u><font color="#804000">where</font></u> l <font color="#808080">=</font> length xs
index <font color="#808080">(</font><font color=Green>FromList</font> xs<font color="#808080">)</font> i            <font color="#808080">=</font> xs <font color=Green>P</font><font color="#800080">.!!</font> i
index <font color="#808080">(</font><font color=Green>FromV</font> v<font color="#808080">)</font> i                <font color="#808080">=</font> <font color=Green>V</font><font color="#800080">.</font>index v i

head      <font color="#808080">::</font>  <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> a
head xs <font color="#808080">=</font> index xs <font color=Magenta>0</font>

tail      <font color="#808080">::</font>  <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color=Green>Vector</font> a
tail <font color="#808080">=</font> drop <font color=Magenta>1</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Not part of the exam question, but needed in pratice</font>
toList <font color="#808080">::</font> <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
toList <font color="#808080">(</font><font color=Green>FromList</font> xs<font color="#808080">)</font>  <font color="#808080">=</font>  xs
toList <font color="#808080">(</font><font color=Green>FromV</font> v<font color="#808080">)</font>      <font color="#808080">=</font>  <font color=Green>V</font><font color="#800080">.</font>toList v
toList <font color="#808080">(</font>v <b><font color="#800080">:++</font></b> w<font color="#808080">)</font>      <font color="#808080">=</font>  toList v <font color=Green>P</font><font color="#800080">.++</font> toList w


</pre>
</body>
</html>