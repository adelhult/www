<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem1/Generator.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Generator</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font> <u><font color="#804000">as</font></u> <font color=Green>P</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Shallow</font> <u><font color="#804000">as</font></u> <font color=Green>V</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font> <u><font color="#804000">as</font></u> <font color=Green>Q</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Control</font><font color="#800080">.</font><font color=Green>Monad</font> <u><font color="#804000">as</font></u> <font color=Green>CM</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Deep_Instances</font> <font color=Green>()</font>
<u><font color="#804000">import</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Deep</font>
<u><font color="#804000">import</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Laws</font>

<u><font color="#804000">instance</font></u> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Arbitrary</font> a <font color="#808080">=&gt;</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Arbitrary</font> <font color="#808080">(</font><font color=Green>D</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> <font color=Green>Q</font><font color="#800080">.</font>sized arbitraryD

arbitraryD <font color="#808080">::</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Arbitrary</font> a <font color="#808080">=&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Gen</font> <font color="#808080">(</font><font color=Green>D</font> a<font color="#808080">)</font>
arbitraryD n <font color="#808080">|</font> n <font color="#800080">&lt;=</font> <font color=Magenta>1</font>     <font color="#808080">=</font>  <font color=Green>Q</font><font color="#800080">.</font>oneof <font color="#808080">[</font> <font color=Green>CM</font><font color="#800080">.</font>liftM single1 <font color=Green>Q</font><font color="#800080">.</font>arbitrary
                                     <font color="#808080">,</font> <font color=Green>CM</font><font color="#800080">.</font>liftM single2 <font color=Green>Q</font><font color="#800080">.</font>arbitrary <font color="#808080">]</font>
             <font color="#808080">|</font> otherwise  <font color="#808080">=</font>  <u><font color="#804000">do</font></u> left <font color="#808080">&lt;-</font> <font color=Green>Q</font><font color="#800080">.</font>choose <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">)</font>
                                <font color=Green>CM</font><font color="#800080">.</font>liftM2 <font color="#808080">(</font><b><font color="#800080">:++</font></b><font color="#808080">)</font> <font color="#808080">(</font>arbitraryD left<font color="#808080">)</font> <font color="#808080">(</font>arbitraryD <font color="#808080">(</font>n<font color=Blue>-</font>left<font color="#808080">)</font><font color="#808080">)</font>

single1 <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a
single1 a <font color="#808080">=</font> <font color=Green>FromList</font> <font color="#808080">[</font>a<font color="#808080">]</font>

single2 <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>D</font> a
single2 a <font color="#808080">=</font> <font color=Green>FromV</font> <font color="#808080">(</font><font color=Green>V</font><font color="#800080">.</font><font color=Green>V</font> <font color=Magenta>1</font> <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>const a<font color="#808080">)</font><font color="#808080">)</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Not part of the exam question: run some tests</font>
q <font color="#808080">::</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Testable</font> p <font color="#808080">=&gt;</font> p <font color="#808080">-&gt;</font> <font color=Green>IO</font> <font color=Green>()</font>
q <font color="#808080">=</font> <font color=Green>Q</font><font color="#800080">.</font>quickCheck

main <font color="#808080">=</font> <u><font color="#804000">do</font></u> q <font color="#808080">(</font>prop_law1 <font color="#808080">::</font> <font color="#808080">[</font><font color=Green>()</font><font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
          q <font color="#808080">(</font>prop_law2 <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
          q <font color="#808080">(</font>prop_law3 <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Property</font><font color="#808080">)</font>
          q <font color="#808080">(</font>prop_law4 <font color="#808080">::</font> <font color=Green>Vector</font> <font color=Green>()</font> <font color="#808080">-&gt;</font> <font color=Green>Vector</font> <font color=Green>()</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
          q <font color="#808080">(</font>prop_law5 <font color="#808080">::</font> <font color=Green>Vector</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Q</font><font color="#800080">.</font><font color=Green>Property</font><font color="#808080">)</font>
</pre>
</body>
</html>