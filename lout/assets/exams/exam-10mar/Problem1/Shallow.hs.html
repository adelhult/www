<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem1/Shallow.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Shallow</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font> <u><font color="#804000">as</font></u> <font color=Green>P</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font> <font color="#808080">(</font><font color="#808080">(</font><font color="#800080">!!</font><font color="#808080">)</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font><font color="#808080">,</font> <font color="#808080">(</font><font color=Blue>-</font><font color="#808080">)</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">&lt;</font><font color="#808080">)</font><font color="#808080">,</font> max<font color="#808080">,</font> min<font color="#808080">)</font>

<font color=Blue>----------------</font>
<font color=Blue>-- Problem 1(b)</font>

<u><font color="#804000">type</font></u> <font color=Green>Ix</font> <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Int</font>
<u><font color="#804000">type</font></u> <font color=Green>Length</font> <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Int</font>
<u><font color="#804000">type</font></u> <font color=Green>Vector</font> <font color="#808080">=</font> <font color=Green>V</font>
<u><font color="#804000">data</font></u> <font color=Green>V</font> a <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">{</font> length <font color="#808080">::</font> <font color=Green>Length</font><font color="#808080">,</font> index  <font color="#808080">::</font> <font color=Green>Ix</font> <font color="#808080">-&gt;</font> a <font color="#808080">}</font>

fromList xs <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>length xs<font color="#808080">)</font> <font color="#808080">(</font>xs <font color="#800080">!!</font><font color="#808080">)</font>
fromFun <font color="#808080">=</font> <font color=Green>V</font>
take n <font color="#808080">(</font><font color=Green>V</font> l ixf<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>min n l<font color="#808080">)</font> ixf
drop n <font color="#808080">(</font><font color=Green>V</font> l ixf<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>max <font color=Magenta>0</font> <font color="#808080">(</font>l<font color=Blue>-</font>n<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font><font color="#808080">\</font>x <font color="#808080">-&gt;</font> ixf <font color="#808080">(</font>x<font color="#800080">+</font>n<font color="#808080">)</font><font color="#808080">)</font>
splitAt n vec <font color="#808080">=</font> <font color="#808080">(</font>take n vec<font color="#808080">,</font> drop n vec<font color="#808080">)</font>
head v <font color="#808080">=</font> index v <font color=Magenta>0</font>
last vec <font color="#808080">=</font> index vec <font color="#808080">(</font>length vec <font color=Blue>-</font> <font color=Magenta>1</font><font color="#808080">)</font>
tail <font color="#808080">=</font> drop <font color=Magenta>1</font>
init vec <font color="#808080">=</font> take <font color="#808080">(</font>length vec <font color=Blue>-</font> <font color=Magenta>1</font><font color="#808080">)</font> vec
<font color=Green>V</font> l1 f1 <font color="#800080">++</font> <font color=Green>V</font> l2 f2 <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>l1<font color="#800080">+</font>l2<font color="#808080">)</font> <font color="#808080">(</font><font color="#808080">\</font>i<font color="#808080">-&gt;</font><u><font color="#804000">if</font></u> i <font color="#800080">&lt;</font> l1 <u><font color="#804000">then</font></u> f1 i <u><font color="#804000">else</font></u> f2 <font color="#808080">(</font>i<font color=Blue>-</font>l1<font color="#808080">)</font><font color="#808080">)</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Not part of the exam question, but needed in pratice</font>
toList <font color="#808080">::</font> <font color=Green>Vector</font> a <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
toList <font color="#808080">(</font><font color=Green>V</font> n f<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font>map f <font color="#808080">[</font><font color=Magenta>0</font><font color="#808080">..</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">]</font>
</pre>
</body>
</html>