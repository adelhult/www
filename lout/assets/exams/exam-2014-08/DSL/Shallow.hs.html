<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-08/DSL/Shallow.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Shallow</font> <font color="#808080">(</font><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Shallow</font><font color="#808080">,</font> <u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Common</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Common</font>

<font color=Blue>{-
  Describe what a \emph{shallow} implementation could look like. Give
  a type definition and describe (in words or code) what each of your
  primitive operations, and your run function, would do.
-}</font>

<u><font color="#804000">type</font></u> <font color=Green>Shallow</font> <font color="#808080">=</font> <font color=Green>Sem</font>
<u><font color="#804000">newtype</font></u> <font color=Green>Art</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">{</font>run <font color="#808080">::</font> <font color=Green>Shallow</font><font color="#808080">}</font>
  <u><font color="#804000">deriving</font></u> <font color="#808080">(</font><font color=Green>Show</font><font color="#808080">,</font> <font color=Green>Eq</font><font color="#808080">)</font>

frame <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
frame <font color="#808080">(</font><font color=Green>Art</font> a<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font>frameSem a<font color="#808080">)</font>

above<font color="#808080">,</font> beside <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
above  <font color="#808080">(</font><font color=Green>Art</font> a<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Art</font> b<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font>aboveSem a b<font color="#808080">)</font>
beside <font color="#808080">(</font><font color=Green>Art</font> a<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Art</font> b<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font>besideSem a b<font color="#808080">)</font>

text <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
text d s <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font>textSem d s<font color="#808080">)</font>

empty  <font color="#808080">::</font> <font color=Green>Art</font>
empty <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font><font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font> <font color=Magenta>0</font><font color="#808080">)</font><font color="#808080">,</font> <font color=Green>[]</font><font color="#808080">)</font>

space <font color="#808080">::</font> <font color=Green>ArtSize</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
space s <font color="#808080">=</font> <font color=Green>Art</font> <font color="#808080">(</font>spaceSem s<font color="#808080">)</font>




<font color=Blue>-- ----------------------------------------------------------------</font>
<font color=Blue>-- Not in the exam question</font>
line   <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
line n <font color=Green>Hori</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#800080">$</font> embed <font color="#808080">[</font>replicate n <font color=Magenta>'-'</font><font color="#808080">]</font>
line n <font color=Green>Vert</font> <font color="#808080">=</font> <font color=Green>Art</font> <font color="#800080">$</font> embed <font color="#808080">(</font>replicate n <font color=Magenta>"|"</font><font color="#808080">)</font>

</pre>
</body>
</html>