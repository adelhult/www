<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-08/DSL/Derived.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Derived</font> <font color="#808080">(</font><u><font color="#804000">module</font></u> <font color=Green>DSLImpl</font><font color="#808080">,</font> <u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Derived</font><font color="#808080">)</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Shallow</font> <u><font color="#804000">as</font></u> <font color=Green>DSLImpl</font>
<font color=Blue>-- import DSL.Deep as DSLImpl</font>


<font color=Blue>-- Some possible derived operations:</font>
box   <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
box d s <font color="#808080">=</font> frame <font color="#808080">(</font>text d s<font color="#808080">)</font>

combine <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
combine <font color=Green>Hori</font> <font color="#808080">=</font> beside
combine <font color=Green>Vert</font> <font color="#808080">=</font> above

vertical    <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
vertical    <font color="#808080">=</font> text <font color=Green>Vert</font>
horizontal  <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
horizontal  <font color="#808080">=</font> text <font color=Green>Hori</font>


aboveL <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
aboveL a n b <font color="#808080">=</font> <font color="#808080">(</font>a <font color="#800080">`above`</font> line n <font color=Green>Vert</font><font color="#808080">)</font> <font color="#800080">`above`</font> b

aboveS <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
aboveS a n b <font color="#808080">=</font> <font color="#808080">(</font>a <font color="#800080">`above`</font> space <font color="#808080">(</font>n<font color="#808080">,</font> <font color=Magenta>1</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">`above`</font> b

besideL <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
besideL a n b <font color="#808080">=</font> <font color="#808080">(</font>a <font color="#800080">`beside`</font> line n <font color=Green>Hori</font><font color="#808080">)</font> <font color="#800080">`beside`</font> b

besideS <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font>
besideS a n b <font color="#808080">=</font> <font color="#808080">(</font>a <font color="#800080">`beside`</font> space <font color="#808080">(</font><font color=Magenta>1</font><font color="#808080">,</font> n<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">`beside`</font> b


<font color=Blue>----------------</font>
<font color=Blue>-- Derived run functions:</font>

render <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>ArtStrs</font>
size   <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>ArtSize</font>

render  <font color="#808080">=</font> snd <font color="#800080">.</font> run
size    <font color="#808080">=</font> fst <font color="#800080">.</font> run
</pre>
</body>
</html>