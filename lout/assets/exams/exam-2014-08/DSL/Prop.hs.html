<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2014-08/DSL/Prop.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Prop</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Derived</font>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>
<u><font color="#804000">import</font></u> <font color=Green>Control</font><font color="#800080">.</font><font color=Green>Applicative</font> hiding <font color="#808080">(</font>empty<font color="#808080">)</font>

<font color=Blue>{-
  What properties (or laws) do your functions have? Mention at least
  three non-trivial such ways in which your functions interact.
-}</font>

<font color=Blue>-- This should perhaps only be for Strings without newlines</font>
prop_text <font color="#808080">::</font> <font color=Green>Dir</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_text d xs ys <font color="#808080">=</font> combine d <font color="#808080">(</font>text d xs<font color="#808080">)</font> <font color="#808080">(</font>text d ys<font color="#808080">)</font> <font color="#800080">=^=</font> text d <font color="#808080">(</font>xs<font color="#800080">++</font>ys<font color="#808080">)</font>

<font color="#808080">(</font><font color="#800080">=^=</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
x <font color="#800080">=^=</font> y <font color="#808080">=</font> run x <font color="#800080">==</font> run y

assoc <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>a<font color="#808080">-&gt;</font>a<font color="#808080">)</font> <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
assoc <font color="#808080">(</font><font color="#800080">==</font><font color="#808080">)</font> <font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font> a b c <font color="#808080">=</font> <font color="#808080">(</font><font color="#808080">(</font>a <font color="#800080">+</font> b<font color="#808080">)</font> <font color="#800080">+</font> c<font color="#808080">)</font> <font color="#800080">==</font> <font color="#808080">(</font>a <font color="#800080">+</font> <font color="#808080">(</font>b <font color="#800080">+</font> c<font color="#808080">)</font><font color="#808080">)</font>

prop_assoc_beside <font color="#808080">=</font> assoc <font color="#808080">(</font><font color="#800080">=^=</font><font color="#808080">)</font> beside
prop_assoc_above  <font color="#808080">=</font> assoc <font color="#808080">(</font><font color="#800080">=^=</font><font color="#808080">)</font> above

main <font color="#808080">=</font> <u><font color="#804000">do</font></u> quickCheck prop_text
          quickCheck prop_assoc_above
          quickCheck prop_assoc_beside
          s example


example <font color="#808080">::</font> <font color=Green>Art</font>
example <font color="#808080">=</font> b1 <font color="#800080">+</font> space <font color="#800080">+</font> frame <font color="#808080">(</font>b2 <font color="#800080">/</font> space <font color="#800080">/</font> b3<font color="#808080">)</font>
  <u><font color="#804000">where</font></u>
    b1 <font color="#808080">=</font> frame <font color="#808080">(</font>vertical <font color="#808080">(</font>show <font color=Magenta>1738</font><font color="#808080">)</font><font color="#808080">)</font> 
    b2 <font color="#808080">=</font> frame <font color="#808080">(</font>horizontal <font color=Magenta>"hi!"</font><font color="#808080">)</font>
    b3 <font color="#808080">=</font> frame <font color="#808080">(</font>horizontal <font color=Magenta>"Patrik"</font><font color="#808080">)</font>
    space <font color="#808080">=</font> horizontal <font color=Magenta>"   "</font>
    <font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font> <font color="#808080">=</font> beside
    <font color="#808080">(</font><font color="#800080">/</font><font color="#808080">)</font> <font color="#808080">=</font> above

<font color=Blue>----------------</font>
<font color=Blue>-- Testing code below: not asked for in the exam:</font>

s <font color="#808080">::</font> <font color=Green>Art</font> <font color="#808080">-&gt;</font> <font color=Green>IO</font> <font color=Green>()</font>
s <font color="#808080">=</font> putStr <font color="#800080">.</font> unlines <font color="#800080">.</font> render

<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>Dir</font> <u><font color="#804000">where</font></u> 
  arbitrary <font color="#808080">=</font> elements <font color="#808080">[</font><font color=Green>Hori</font><font color="#808080">,</font> <font color=Green>Vert</font><font color="#808080">]</font>


<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>Art</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> sized arbArt

<font color=Blue>-- derived operations: only using the API</font>
arbArt n <font color="#808080">|</font> n <font color="#800080">&lt;=</font> <font color=Magenta>1</font>     <font color="#808080">=</font> oneof <font color="#808080">[</font> text <font color="#800080">&lt;$&gt;</font> arbitrary <font color="#800080">&lt;*&gt;</font> arbStr<font color="#808080">,</font> return empty<font color="#808080">,</font> space <font color="#800080">&lt;$&gt;</font> arbSize<font color="#808080">]</font>
         <font color="#808080">|</font> otherwise  <font color="#808080">=</font> oneof <font color="#808080">[</font> above <font color="#800080">&lt;$&gt;</font> arbArt n' <font color="#800080">&lt;*&gt;</font> arbArt n'
                              <font color="#808080">,</font> beside<font color="#800080">&lt;$&gt;</font> arbArt n' <font color="#800080">&lt;*&gt;</font> arbArt n'
                              <font color="#808080">,</font> frame <font color="#800080">&lt;$&gt;</font> arbArt <font color="#808080">(</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">)</font>
                              <font color="#808080">]</font>
  <u><font color="#804000">where</font></u> n' <font color="#808080">=</font> n <font color="#800080">`div`</font> <font color=Magenta>2</font>

arbStr <font color="#808080">=</font> arbitrary 
<font color=Blue>-- vectorOf 3 (choose ('a','z')) -- for readability when debuging</font>

arbSize <font color="#808080">=</font> <u><font color="#804000">do</font></u> a <font color="#808080">&lt;-</font> choose <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font><font color=Magenta>15</font><font color="#808080">)</font>
             b <font color="#808080">&lt;-</font> choose <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font><font color=Magenta>20</font><font color="#808080">)</font>
             return <font color="#808080">(</font>a<font color="#808080">,</font> b<font color="#808080">)</font>


<font color=Blue>{-
  -- not in exam question
  Line   :: Int -&gt; Dir -&gt; Art
-}</font>
</pre>
</body>
</html>