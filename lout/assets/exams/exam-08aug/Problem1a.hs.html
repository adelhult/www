<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-08aug/Problem1a.hs</title>
</head>
<body>
<pre>
<u><font color="#804000">module</font></u> <font color=Green>Problem1a</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">class</font></u> <font color=Green>Monad</font> m <font color="#808080">=&gt;</font> <font color=Green>GameMonad</font> m <u><font color="#804000">where</font></u>
  extraLife  <font color="#808080">::</font> m <font color=Green>()</font>
  getLives   <font color="#808080">::</font> m <font color=Green>Int</font>
  checkPoint <font color="#808080">::</font> m a <font color="#808080">-&gt;</font> m a
  die        <font color="#808080">::</font> m a

<u><font color="#804000">newtype</font></u> <font color=Green>Game</font> a <font color="#808080">=</font> <font color=Green>Game</font> <font color="#808080">{</font> unGame <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Result</font> a <font color="#808080">}</font>

<u><font color="#804000">type</font></u> <font color=Green>Result</font> a <font color="#808080">=</font> <font color=Green>Either</font> <font color=Green>Int</font> <font color="#808080">(</font>a<font color="#808080">,</font> <font color=Green>Int</font><font color="#808080">)</font>
<font color=Blue>-- Alternative definitions:</font>
<font color=Blue>-- type Result a = (Maybe a, Int)</font>
<font color=Blue>-- data Result a = GameOver | Died Int | Survived a Int</font>

<u><font color="#804000">instance</font></u> <font color=Green>Monad</font> <font color=Green>Game</font> <u><font color="#804000">where</font></u>
  return x <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <font color=Green>Right</font> <font color="#808080">(</font>x<font color="#808080">,</font> n<font color="#808080">)</font>
  m <font color="#800080">&gt;&gt;=</font> f  <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <u><font color="#804000">case</font></u> unGame m n <u><font color="#804000">of</font></u>
    <font color=Green>Left</font> n       <font color="#808080">-&gt;</font> <font color=Green>Left</font> n
    <font color=Green>Right</font> <font color="#808080">(</font>x<font color="#808080">,</font> n<font color="#808080">)</font> <font color="#808080">-&gt;</font> unGame <font color="#808080">(</font>f x<font color="#808080">)</font> n

<u><font color="#804000">instance</font></u> <font color=Green>GameMonad</font> <font color=Green>Game</font> <u><font color="#804000">where</font></u>
  extraLife    <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <font color=Green>Right</font> <font color="#808080">(</font><font color=Green>()</font><font color="#808080">,</font> n <font color="#800080">+</font> <font color=Magenta>1</font><font color="#808080">)</font>
  getLives     <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <font color=Green>Right</font> <font color="#808080">(</font>n<font color="#808080">,</font> n<font color="#808080">)</font>
  die          <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <font color=Green>Left</font> <font color="#808080">(</font>n <font color=Blue>-</font> <font color=Magenta>1</font><font color="#808080">)</font>
  checkPoint m <font color="#808080">=</font> <font color=Green>Game</font> <font color="#800080">$</font> <font color="#808080">\</font>n <font color="#808080">-&gt;</font> <u><font color="#804000">case</font></u> unGame m n <u><font color="#804000">of</font></u>
    <font color=Green>Left</font> n <font color="#808080">|</font> n <font color="#800080">&gt;</font> <font color=Magenta>0</font>     <font color="#808080">-&gt;</font> unGame <font color="#808080">(</font>checkPoint m<font color="#808080">)</font> n
           <font color="#808080">|</font> otherwise <font color="#808080">-&gt;</font> <font color=Green>Left</font> <font color=Magenta>0</font>
    <font color=Green>Right</font> <font color="#808080">(</font>x<font color="#808080">,</font> n<font color="#808080">)</font>       <font color="#808080">-&gt;</font> <font color=Green>Right</font> <font color="#808080">(</font>x<font color="#808080">,</font> n<font color="#808080">)</font>

runGame <font color="#808080">::</font> <font color=Green>Game</font> a <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Maybe</font> <font color="#808080">(</font>a<font color="#808080">,</font> <font color=Green>Int</font><font color="#808080">)</font>
runGame m n <font color="#808080">=</font> <u><font color="#804000">case</font></u> unGame m n <u><font color="#804000">of</font></u>
  <font color=Green>Left</font> <u><font color="#804000">_</font></u>  <font color="#808080">-&gt;</font> <font color=Green>Nothing</font>
  <font color=Green>Right</font> r <font color="#808080">-&gt;</font> <font color=Green>Just</font> r

</pre>
</body>
</html>