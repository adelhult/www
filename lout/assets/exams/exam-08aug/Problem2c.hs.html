<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-08aug/Problem2c.hs</title>
</head>
<body>
<pre>
<u><font color="#804000">module</font></u> <font color=Green>Problem2c</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>List</font>

<u><font color="#804000">data</font></u> <font color=Green>Doc</font> <font color="#808080">=</font> <font color=Green>Doc</font> <b><font color="#800080">:$$</font></b> <font color=Green>Doc</font>
         <font color="#808080">|</font> <font color=Green>Doc</font> <b><font color="#800080">:&lt;&gt;</font></b> <font color=Green>Doc</font>
         <font color="#808080">|</font> <font color=Green>Empty</font>
         <font color="#808080">|</font> <font color=Green>Text</font> <font color=Green>String</font>
  <u><font color="#804000">deriving</font></u> <font color=Green>Show</font>

<font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
<font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font><b><font color="#800080">:$$</font></b><font color="#808080">)</font>

empty <font color="#808080">::</font> <font color=Green>Doc</font>
empty <font color="#808080">=</font> <font color=Green>Empty</font>

<font color="#808080">(</font><font color="#800080">&lt;&gt;</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
<font color="#808080">(</font><font color="#800080">&lt;&gt;</font><font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font><b><font color="#800080">:&lt;&gt;</font></b><font color="#808080">)</font>

text <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
text <font color="#808080">=</font> <font color=Green>Text</font>

<font color=Blue>-- Derived combinators</font>
indent <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
indent n x <font color="#808080">=</font> text <font color="#808080">(</font>replicate n <font color=Magenta>' '</font><font color="#808080">)</font> <font color="#800080">&lt;&gt;</font> x

<font color="#808080">(</font><font color="#800080">&lt;+&gt;</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
x <font color="#800080">&lt;+&gt;</font> y <font color="#808080">=</font> x <font color="#800080">&lt;&gt;</font> indent <font color=Magenta>1</font> y

<font color=Blue>-- Run function</font>
render <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>String</font>
render <font color="#808080">=</font> unlines <font color="#800080">.</font> toLines

toLines <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font><font color=Green>String</font><font color="#808080">]</font>
toLines <font color="#808080">(</font>x <b><font color="#800080">:$$</font></b> y<font color="#808080">)</font> <font color="#808080">=</font> toLines x <font color="#800080">++</font> toLines y
toLines <font color=Green>Empty</font>     <font color="#808080">=</font> <font color=Green>[]</font>
toLines <font color="#808080">(</font><font color=Green>Text</font> s<font color="#808080">)</font>  <font color="#808080">=</font> <font color="#808080">[</font>s<font color="#808080">]</font>
toLines <font color="#808080">(</font>x <b><font color="#800080">:&lt;&gt;</font></b> y<font color="#808080">)</font> <font color="#808080">=</font> toLines x <font color="#800080">`hcat`</font> toLines y
  <u><font color="#804000">where</font></u>
    <font color=Blue>-- Same as the shallow implementation of (&lt;&gt;)</font>
    hcat <font color=Green>[]</font>       ys       <font color="#808080">=</font> ys
    hcat xs       <font color=Green>[]</font>       <font color="#808080">=</font> xs
    hcat <font color="#808080">[</font>x<font color="#808080">]</font>      <font color="#808080">(</font>y <b><font color="#800080">:</font></b> ys<font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font>x <font color="#800080">++</font> y<font color="#808080">)</font> <b><font color="#800080">:</font></b> map <font color="#808080">(</font>replicate <font color="#808080">(</font>length x<font color="#808080">)</font> <font color=Magenta>' '</font> <font color="#800080">++</font><font color="#808080">)</font> ys
    hcat <font color="#808080">(</font>x <b><font color="#800080">:</font></b> xs<font color="#808080">)</font> ys       <font color="#808080">=</font> x <b><font color="#800080">:</font></b> hcat xs ys

</pre>
</body>
</html>