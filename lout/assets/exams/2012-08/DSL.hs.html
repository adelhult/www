<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20120828/DSL.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE StandaloneDeriving #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>DSL</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>
<u><font color="#804000">import</font></u> <font color=Green>Control</font><font color="#800080">.</font><font color=Green>Monad</font><font color="#808080">(</font>liftM2<font color="#808080">)</font>

<u><font color="#804000">import</font></u> <font color=Green>Matrix</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Deep</font>     <u><font color="#804000">as</font></u> <font color=Green>D</font>   <font color=Blue>-- Exam question 1 a</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>DSL</font><font color="#800080">.</font><font color=Green>Shallow</font>  <u><font color="#804000">as</font></u> <font color=Green>S</font>   <font color=Blue>-- Exam question 1 b</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Below is only testing code - the exam solutions are in the imported modules.</font>

<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>D</font><font color="#800080">.</font><font color=Green>Shape</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> oneof 
    <font color="#808080">[</font> return <font color=Green>D</font><font color="#800080">.</font>empty                                                       
    <font color="#808080">,</font> return <font color=Green>D</font><font color="#800080">.</font>disc                                                    
    <font color="#808080">,</font> return <font color=Green>D</font><font color="#800080">.</font>square                                                  
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>translate   arbitrary  arbitrary                               
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>scale       arbitrary  arbitrary                               
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>rotate      arbitrary  arbitrary                               
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>union       arbitrary  arbitrary                               
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>intersect   arbitrary  arbitrary                           
    <font color="#808080">,</font> liftM2 <font color=Green>D</font><font color="#800080">.</font>difference  arbitrary  arbitrary          
    <font color="#808080">]</font>
    
<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> <font color=Green>Vec</font> <u><font color="#804000">where</font></u>    
  arbitrary <font color="#808080">=</font> liftM2 vec arbitrary arbitrary

<u><font color="#804000">deriving</font></u> <u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Show</font> <font color=Green>D</font><font color="#800080">.</font><font color=Green>Shape</font><font color="#808080">)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Show</font> <font color=Green>Vec</font> <u><font color="#804000">where</font></u>
  show v <font color="#808080">=</font> <font color=Magenta>"V "</font><font color="#800080">++</font> show <font color="#808080">(</font>vecX v<font color="#808080">)</font> <font color="#800080">++</font> <font color=Magenta>" "</font> <font color="#800080">++</font> show <font color="#808080">(</font>vecY v<font color="#808080">)</font>

copy <font color="#808080">::</font> <font color=Green>D</font><font color="#800080">.</font><font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>S</font><font color="#800080">.</font><font color=Green>Shape</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Empty</font><font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>empty
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Disc</font><font color="#808080">)</font>   <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>disc      
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Square</font><font color="#808080">)</font> <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>square    
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Translate</font>   v  s<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>translate     v  <font color="#808080">(</font>copy s<font color="#808080">)</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Scale</font>       v  s<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>scale         v  <font color="#808080">(</font>copy s<font color="#808080">)</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Rotate</font>      a  s<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>rotate        a  <font color="#808080">(</font>copy s<font color="#808080">)</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Union</font>       x  y<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>union         <font color="#808080">(</font>copy x<font color="#808080">)</font>  <font color="#808080">(</font>copy y<font color="#808080">)</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Intersect</font>   x  y<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>intersect     <font color="#808080">(</font>copy x<font color="#808080">)</font>  <font color="#808080">(</font>copy y<font color="#808080">)</font>
copy <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font><font color=Green>Difference</font>  x  y<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>S</font><font color="#800080">.</font>difference    <font color="#808080">(</font>copy x<font color="#808080">)</font>  <font color="#808080">(</font>copy y<font color="#808080">)</font>

prop_faithful <font color="#808080">::</font> <font color=Green>D</font><font color="#800080">.</font><font color=Green>Shape</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_faithful d p  <font color="#808080">=</font>  p <font color="#800080">`</font><font color=Green>D</font><font color="#800080">.</font>inside<font color="#800080">`</font> d  <font color="#800080">==</font>  p <font color="#800080">`</font><font color=Green>S</font><font color="#800080">.</font>inside<font color="#800080">`</font> s
  <u><font color="#804000">where</font></u> s <font color="#808080">=</font> copy d
        
main <font color="#808080">=</font> quickCheck prop_faithful
</pre>
</body>
</html>