<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20120828/Matrix.hs</title>
</head>
<body>
<pre>
<u><font color="#804000">module</font></u> <font color=Green>Matrix</font>
  <font color="#808080">(</font> <font color=Green>Matrix</font><font color="#808080">,</font> <font color=Green>Vec</font><font color="#808080">,</font> <font color=Green>Point</font><font color="#808080">,</font> <font color=Green>Angle</font>
  <font color="#808080">,</font> vecX<font color="#808080">,</font> vecY<font color="#808080">,</font> ptX<font color="#808080">,</font> ptY
  <font color="#808080">,</font> matrix<font color="#808080">,</font> point<font color="#808080">,</font> vec
  <font color="#808080">,</font> cross<font color="#808080">,</font> mul<font color="#808080">,</font> inv<font color="#808080">,</font> sub<font color="#808080">,</font> divide<font color="#808080">,</font> rot
  <font color="#808080">)</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">type</font></u> <font color=Green>Angle</font>  <font color="#808080">=</font> <font color=Green>Double</font>
<u><font color="#804000">data</font></u> <font color=Green>Vec</font>    <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">{</font> vecX<font color="#808080">,</font> vecY <font color="#808080">::</font> <font color=Green>Double</font> <font color="#808080">}</font>
<u><font color="#804000">type</font></u> <font color=Green>Point</font>  <font color="#808080">=</font> <font color=Green>Vec</font>
<u><font color="#804000">data</font></u> <font color=Green>Matrix</font> <font color="#808080">=</font> <font color=Green>M</font> <font color=Green>Vec</font> <font color=Green>Vec</font>

<font color=Blue>-- | Matrix creation</font>
matrix <font color="#808080">::</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Matrix</font>
matrix a b c d <font color="#808080">=</font> <font color=Green>M</font> <font color="#808080">(</font><font color=Green>V</font> a b<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>V</font> c d<font color="#808080">)</font>

<font color=Blue>-- | Vector creation</font>
vec <font color="#808080">::</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font>
vec <font color="#808080">=</font> <font color=Green>V</font>

<font color=Blue>-- | Point creation.</font>
point <font color="#808080">::</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font>
point <font color="#808080">=</font> vec

<font color=Blue>-- | Cross product</font>
cross <font color="#808080">::</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font>
cross <font color="#808080">(</font><font color=Green>V</font> a b<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>V</font> c d<font color="#808080">)</font> <font color="#808080">=</font> a <font color="#800080">*</font> c <font color="#800080">+</font> b <font color="#800080">*</font> d

<font color=Blue>-- | Matrix multiplication</font>
mul <font color="#808080">::</font> <font color=Green>Matrix</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font>
mul <font color="#808080">(</font><font color=Green>M</font> c1 c2<font color="#808080">)</font> v <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>cross c1 v<font color="#808080">)</font> <font color="#808080">(</font>cross c2 v<font color="#808080">)</font>

<font color=Blue>-- | Matrix inversion</font>
inv <font color="#808080">::</font> <font color=Green>Matrix</font> <font color="#808080">-&gt;</font> <font color=Green>Matrix</font>
inv <font color="#808080">(</font><font color=Green>M</font> <font color="#808080">(</font><font color=Green>V</font> a b<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>V</font> c d<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=</font> matrix <font color="#808080">(</font>d <font color="#800080">/</font> k<font color="#808080">)</font> <font color="#808080">(</font><font color=Blue>-</font>b <font color="#800080">/</font> k<font color="#808080">)</font> <font color="#808080">(</font><font color=Blue>-</font>c <font color="#800080">/</font> k<font color="#808080">)</font> <font color="#808080">(</font>a <font color="#800080">/</font> k<font color="#808080">)</font>
  <u><font color="#804000">where</font></u> k <font color="#808080">=</font> a <font color="#800080">*</font> d <font color=Blue>-</font> b <font color="#800080">*</font> c

<font color=Blue>-- | Subtraction</font>
sub <font color="#808080">::</font> <font color=Green>Point</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font>
sub <font color="#808080">(</font><font color=Green>V</font> x y<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>V</font> dx dy<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>x <font color=Blue>-</font> dx<font color="#808080">)</font> <font color="#808080">(</font>y <font color=Blue>-</font> dy<font color="#808080">)</font>

<font color=Blue>-- | Division (unscale;-)</font>
divide <font color="#808080">::</font> <font color=Green>Point</font> <font color="#808080">-&gt;</font> <font color=Green>Vec</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font>
divide <font color="#808080">(</font><font color=Green>V</font> x y<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>V</font> sx sy<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>V</font> <font color="#808080">(</font>x <font color="#800080">/</font> sx<font color="#808080">)</font> <font color="#808080">(</font>y <font color="#800080">/</font> sy<font color="#808080">)</font>

rot <font color="#808080">::</font> <font color=Green>Angle</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font> <font color="#808080">-&gt;</font> <font color=Green>Point</font>
rot a p <font color="#808080">=</font> <font color=Green>V</font> newx newy
  <u><font color="#804000">where</font></u> newx <font color="#808080">=</font> cross <font color="#808080">(</font><font color=Green>V</font> <font color="#808080">(</font>cos  a<font color="#808080">)</font> <font color="#808080">(</font>sin a<font color="#808080">)</font><font color="#808080">)</font> p
        newy <font color="#808080">=</font> cross <font color="#808080">(</font><font color=Green>V</font> <font color="#808080">(</font><font color=Blue>-</font>sin a<font color="#808080">)</font> <font color="#808080">(</font>cos a<font color="#808080">)</font><font color="#808080">)</font> p

<font color=Blue>-- inv (matrix (cos a) (-sin a) (sin a) (cos a))</font>
<font color=Blue>--   == matrix (cos a) (sin a) (-sin a) (cos a)</font>

<font color=Blue>-- Run functions</font>

ptX<font color="#808080">,</font> ptY <font color="#808080">::</font> <font color=Green>Point</font> <font color="#808080">-&gt;</font> <font color=Green>Double</font>
ptX <font color="#808080">=</font> vecX
ptY <font color="#808080">=</font> vecY

</pre>
</body>
</html>