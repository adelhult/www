<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20120828/Spec.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Spec</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- a) </font>
<font color=Blue>{-
-- These are already in Control.Monad.Instances
instance Functor (Either e)  where  fmap = fmapE
instance Functor ((,) e)     where  fmap = fmapP
instance Functor ((-&gt;) e)    where  fmap = fmapF
-}</font>
  
fmapE <font color="#808080">::</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Either</font> e a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Either</font> e b<font color="#808080">)</font>
fmapE f  <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font>   <font color="#808080">=</font>  <font color=Green>Left</font> e
fmapE f  <font color="#808080">(</font><font color=Green>Right</font> a<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>Right</font> <font color="#808080">(</font>f a<font color="#808080">)</font>
  
fmapP <font color="#808080">::</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>e<font color="#808080">,</font> b<font color="#808080">)</font>  
fmapP f  <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font>     <font color="#808080">=</font>  <font color="#808080">(</font>e<font color="#808080">,</font> f a<font color="#808080">)</font>
  
fmapF <font color="#808080">::</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>e<font color="#808080">-&gt;</font>a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>e<font color="#808080">-&gt;</font>b<font color="#808080">)</font>
fmapF f  g          <font color="#808080">=</font>  f <font color="#800080">.</font> g

<font color=Blue>{-
-- Monads?

(Either e) is the Error monad
((,) e)    is the Writer monad if e is a monoid (less well-known)
((-&gt;) e)   is the Reader monad

-}</font>

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- b)</font>


<font color=Blue>-- --------------</font>

<font color=Blue>-- Functor laws (here as QuickCheck properties)</font>
fmapId <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Functor</font> f<font color="#808080">,</font> <font color=Green>Eq</font> <font color="#808080">(</font>f a<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">=&gt;</font> f a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
fmapId        <font color="#808080">=</font>  fmap id <font color="#800080">===</font> id
fmapComp f g  <font color="#808080">=</font>  <font color="#808080">(</font>fmap f<font color="#808080">)</font> <font color="#800080">.</font> <font color="#808080">(</font>fmap g<font color="#808080">)</font>  <font color="#800080">===</font>  fmap <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font>

<u><font color="#804000">infix</font></u> <font color=Magenta>4</font> <font color="#800080">===</font>
<font color="#808080">(</font><font color="#800080">===</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color="#808080">(</font>t <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>t <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> t <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
<font color="#808080">(</font>f <font color="#800080">===</font> g<font color="#808080">)</font> x  <font color="#808080">=</font>  f x <font color="#800080">==</font> g x

<font color=Blue>-- Prove the Functor laws</font>

<font color=Blue>-- fmapId</font>

fmapId_E x <font color="#808080">=</font> 
    <font color="#808080">[</font> fmapE id x
    <font color="#808080">,</font> <u><font color="#804000">case</font></u> x <u><font color="#804000">of</font></u>
        <font color=Green>Left</font> e  <font color="#808080">-&gt;</font> <font color=Green>Left</font> e
        <font color=Green>Right</font> a <font color="#808080">-&gt;</font> <font color=Green>Right</font> <font color="#808080">(</font>id a<font color="#808080">)</font>
    <font color="#808080">,</font> <u><font color="#804000">case</font></u> x <u><font color="#804000">of</font></u>
        <font color=Green>Left</font> e  <font color="#808080">-&gt;</font> <font color=Green>Left</font> e
        <font color=Green>Right</font> a <font color="#808080">-&gt;</font> <font color=Green>Right</font> a    
    <font color="#808080">,</font> x
    <font color="#808080">]</font>

fmapId_P <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font> <font color="#808080">=</font> 
    <font color="#808080">[</font> fmapP id <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color="#808080">(</font>e<font color="#808080">,</font> id a<font color="#808080">)</font>
    <font color="#808080">,</font> <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font>
    <font color="#808080">]</font>
    
fmapId_F f <font color="#808080">=</font>    
  <font color="#808080">[</font> fmapF id f
  <font color="#808080">,</font> id <font color="#800080">.</font> f
  <font color="#808080">,</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> id <font color="#808080">(</font>f x<font color="#808080">)</font>
  <font color="#808080">,</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x
  <font color="#808080">]</font>          
  
<font color=Blue>----------------</font>
<font color=Blue>-- fmapComp</font>

fmapComp_E f g <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font> <font color="#808080">=</font>  
  <font color="#808080">[</font> <font color="#808080">(</font><font color="#808080">(</font>fmapE f<font color="#808080">)</font> <font color="#800080">.</font> <font color="#808080">(</font>fmapE g<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font>
  <font color="#808080">,</font> fmapE f <font color="#808080">(</font>fmapE g <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> fmapE f <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>Left</font> e
  <font color="#808080">,</font> fmapE <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Left</font> e<font color="#808080">)</font>
  <font color="#808080">]</font> 
fmapComp_E f g <font color="#808080">(</font><font color=Green>Right</font> a<font color="#808080">)</font> <font color="#808080">=</font>  
  <font color="#808080">[</font> <font color="#808080">(</font><font color="#808080">(</font>fmapE f<font color="#808080">)</font> <font color="#800080">.</font> <font color="#808080">(</font>fmapE g<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Right</font> a<font color="#808080">)</font>
  <font color="#808080">,</font> fmapE f <font color="#808080">(</font>fmapE g <font color="#808080">(</font><font color=Green>Right</font> a<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> fmapE f <font color="#808080">(</font><font color=Green>Right</font> <font color="#808080">(</font>g a<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>Right</font> <font color="#808080">(</font>f <font color="#808080">(</font>g a<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>Right</font> <font color="#808080">(</font><font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> a<font color="#808080">)</font>
  <font color="#808080">,</font> fmapE <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>Right</font> a<font color="#808080">)</font>
  <font color="#808080">]</font>

fmapComp_P f g <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font> <font color="#808080">=</font>
  <font color="#808080">[</font> <font color="#808080">(</font><font color="#808080">(</font>fmapP f<font color="#808080">)</font> <font color="#800080">.</font> <font color="#808080">(</font>fmapP g<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font>
  <font color="#808080">,</font> fmapP f <font color="#808080">(</font>fmapP g <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> fmapP f <font color="#808080">(</font>e<font color="#808080">,</font> g a<font color="#808080">)</font>
  <font color="#808080">,</font> <font color="#808080">(</font>e<font color="#808080">,</font> f <font color="#808080">(</font>g a<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color="#808080">(</font>e<font color="#808080">,</font> <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> a<font color="#808080">)</font>
  <font color="#808080">,</font> fmapP <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#808080">(</font>e<font color="#808080">,</font> a<font color="#808080">)</font>
  <font color="#808080">]</font>
  
fmapComp_F f g h <font color="#808080">=</font>
  <font color="#808080">[</font> <font color="#808080">(</font><font color="#808080">(</font>fmapF f<font color="#808080">)</font> <font color="#800080">.</font> <font color="#808080">(</font>fmapF g<font color="#808080">)</font><font color="#808080">)</font> h
  <font color="#808080">,</font> fmapF f <font color="#808080">(</font>fmapF g h<font color="#808080">)</font>
  <font color="#808080">,</font> fmapF f <font color="#808080">(</font>g <font color="#800080">.</font> h<font color="#808080">)</font>
  <font color="#808080">,</font> f <font color="#800080">.</font> <font color="#808080">(</font>g <font color="#800080">.</font> h<font color="#808080">)</font>
  <font color="#808080">,</font> <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#800080">.</font> h
  <font color="#808080">,</font> fmapF <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> h
  <font color="#808080">]</font>


<font color=Blue>----------------</font>
<font color=Blue>-- Some testing code (just started) - not part of the exam question.</font>

allEq <font color="#808080">::</font> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
allEq <font color=Green>[]</font>      <font color="#808080">=</font>  <font color=Green>True</font>
allEq <font color="#808080">(</font>x<b><font color="#800080">:</font></b>xs<font color="#808080">)</font>  <font color="#808080">=</font>  all <font color="#808080">(</font>x<font color="#800080">==</font><font color="#808080">)</font> xs

p_E f g x <font color="#808080">=</font> allEq <font color="#808080">(</font>fmapComp_E f g x<font color="#808080">)</font>

</pre>
</body>
</html>