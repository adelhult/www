<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-08aug/Problem2b.hs</title>
</head>
<body>
<pre>
<u><font color="#804000">module</font></u> <font color=Green>Problem2b</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">type</font></u> <font color=Green>Doc</font> <font color="#808080">=</font> <font color="#808080">[</font><font color=Green>String</font><font color="#808080">]</font>

<font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
<font color="#808080">(</font><font color="#800080">$$</font><font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font>

<font color="#808080">(</font><font color="#800080">&lt;&gt;</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
<font color=Green>[]</font>  <font color="#800080">&lt;&gt;</font> ys       <font color="#808080">=</font> ys
xs  <font color="#800080">&lt;&gt;</font> <font color=Green>[]</font>       <font color="#808080">=</font> xs
<font color="#808080">[</font>x<font color="#808080">]</font> <font color="#800080">&lt;&gt;</font> <font color="#808080">(</font>y <b><font color="#800080">:</font></b> ys<font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font>x <font color="#800080">++</font> y<font color="#808080">)</font> <b><font color="#800080">:</font></b> map <font color="#808080">(</font>replicate <font color="#808080">(</font>length x<font color="#808080">)</font> <font color=Magenta>' '</font> <font color="#800080">++</font><font color="#808080">)</font> ys
<font color="#808080">(</font>x <b><font color="#800080">:</font></b> xs<font color="#808080">)</font> <font color="#800080">&lt;&gt;</font> ys  <font color="#808080">=</font> x <b><font color="#800080">:</font></b> <font color="#808080">(</font>xs <font color="#800080">&lt;&gt;</font> ys<font color="#808080">)</font>

text <font color="#808080">::</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
text s <font color="#808080">=</font> <font color="#808080">[</font>s<font color="#808080">]</font>

render <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>String</font>
render xs <font color="#808080">=</font> unlines xs

empty <font color="#808080">::</font> <font color=Green>Doc</font>
empty <font color="#808080">=</font> <font color=Green>[]</font>

<font color=Blue>-- Answer to problem 2a:</font>

<font color=Blue>-- indent can be defined in terms of (&lt;&gt;) and text</font>
indent <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
indent n xs <font color="#808080">=</font> text <font color="#808080">(</font>replicate n <font color=Magenta>' '</font><font color="#808080">)</font> <font color="#800080">&lt;&gt;</font> xs

<font color=Blue>-- (&lt;+&gt;) can be defined in terms of (&lt;&gt;) and indent.</font>
<font color="#808080">(</font><font color="#800080">&lt;+&gt;</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font> <font color="#808080">-&gt;</font> <font color=Green>Doc</font>
xs <font color="#800080">&lt;+&gt;</font> ys <font color="#808080">=</font> xs <font color="#800080">&lt;&gt;</font> indent <font color=Magenta>1</font> ys

<font color=Blue>-- Alternatively (inlining the definition of indent)</font>
<font color=Blue>-- xs &lt;+&gt; ys = xs &lt;&gt; text " " &lt;&gt; ys</font>

<font color=Blue>-- Note that empty and text "" are different:</font>
true1 <font color="#808080">=</font> render <font color="#808080">(</font>text <font color=Magenta>"A"</font> <font color="#800080">$$</font> empty   <font color="#800080">$$</font> text <font color=Magenta>"B"</font><font color="#808080">)</font> <font color="#800080">==</font> <font color=Magenta>"A\nB\n"</font>
true2 <font color="#808080">=</font> render <font color="#808080">(</font>text <font color=Magenta>"A"</font> <font color="#800080">$$</font> text <font color=Magenta>""</font> <font color="#800080">$$</font> text <font color=Magenta>"B"</font><font color="#808080">)</font> <font color="#800080">==</font> <font color=Magenta>"A\n\nB\n"</font>

</pre>
</body>
</html>