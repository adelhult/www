<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-2013-08/Spec.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Spec</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font> hiding <font color="#808080">(</font>return<font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">&gt;&gt;</font><font color="#808080">)</font><font color="#808080">)</font>

<font color=Blue>-- Part of the exam question:</font>
<u><font color="#804000">data</font></u> <font color=Green>P</font> s a

symbol  <font color="#808080">::</font>  <font color=Green>P</font> s s
pfail   <font color="#808080">::</font>  <font color=Green>P</font> s a
<font color="#808080">(</font><font color="#800080">+++</font><font color="#808080">)</font>   <font color="#808080">::</font>  <font color=Green>P</font> s a <font color="#808080">-&gt;</font> <font color=Green>P</font> s a <font color="#808080">-&gt;</font> <font color=Green>P</font> s a
return  <font color="#808080">::</font>  a <font color="#808080">-&gt;</font> <font color=Green>P</font> s a
<font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font>   <font color="#808080">::</font>  <font color=Green>P</font> s a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> <font color=Green>P</font> s b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>P</font> s b
<u><font color="#804000">type</font></u> <font color=Green>Bag</font> <font color="#808080">=</font> <font color=Green>[]</font>
<font color="#808080">(</font><font color="#800080">\/</font><font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font>
<u><font color="#804000">type</font></u> <font color=Green>Sem</font> s a <font color="#808080">=</font> <font color="#808080">[</font>s<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>Bag</font> <font color="#808080">(</font>a<font color="#808080">,</font> <font color="#808080">[</font>s<font color="#808080">]</font><font color="#808080">)</font>
sem <font color="#808080">::</font> <font color=Green>P</font> s a <font color="#808080">-&gt;</font> <font color=Green>Sem</font> s a
symbol   <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
pfail    <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
<font color="#808080">(</font><font color="#800080">+++</font><font color="#808080">)</font>    <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
return   <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
<font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font>    <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>
sem      <font color="#808080">=</font> error <font color=Magenta>"TBD"</font>

a <font color="#800080">&gt;&gt;</font> b <font color="#808080">=</font> a <font color="#800080">&gt;&gt;=</font> const b

<font color=Blue>-- Start of answers:</font>

<font color=Blue>-- a) the value is [('h', ")")]</font>

<u><font color="#804000">type</font></u> <font color=Green>ProofSteps</font> <font color="#808080">=</font> <font color=Green>[]</font> <font color=Blue>-- Poor man's proofs (only type checked)</font>
proofSteps <font color="#808080">::</font> <font color=Green>ProofSteps</font> <font color="#808080">(</font><font color=Green>Bag</font> <font color="#808080">(</font><font color=Green>Char</font><font color="#808080">,</font> <font color=Green>String</font><font color="#808080">)</font><font color="#808080">)</font>
proofSteps <font color="#808080">=</font> 
  <font color="#808080">[</font> sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;</font> symbol<font color="#808080">)</font> <font color=Magenta>"(h)"</font>
  <font color="#808080">,</font> <font color=Blue>-- def. of |&gt;&gt;|</font>
    sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> const symbol<font color="#808080">)</font> <font color=Magenta>"(h)"</font>
  <font color="#808080">,</font> <font color=Blue>-- Lemma1 + beta reduction</font>
    sem symbol <font color=Magenta>"h)"</font>
  <font color="#808080">,</font> <font color=Blue>-- sem.sym.1</font>
    <font color="#808080">[</font><font color="#808080">(</font><font color=Magenta>'h'</font><font color="#808080">,</font> <font color=Magenta>")"</font><font color="#808080">)</font><font color="#808080">]</font>
  <font color="#808080">]</font>
    
    
<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>{-
Lemma1: sem (symbol &gt;&gt;= f) (s:ss)  =  sem (f s) ss

Lemma2: sem (symbol &gt;&gt;= f) []      =  []
-}</font>


stepsEmpty <font color="#808080">::</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> <font color=Green>P</font> s a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> <font color=Green>P</font> s a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>ProofSteps</font> <font color="#808080">[</font><font color="#808080">(</font>a<font color="#808080">,</font> <font color="#808080">[</font>s<font color="#808080">]</font><font color="#808080">)</font><font color="#808080">]</font>
stepsEmpty f g <font color="#808080">=</font> 
  <font color="#808080">[</font> sem <font color="#808080">(</font><font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#800080">+++</font> <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font><font color="#808080">)</font> <font color=Green>[]</font>
  <font color="#808080">,</font> <font color=Blue>--  Spec. of sem (p +++ q)</font>
    sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color=Green>[]</font>  <font color="#800080">\/</font>  sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font> <font color=Green>[]</font>
  <font color="#808080">,</font> <font color=Blue>--  Lemma2 twice</font>
    <font color=Green>[]</font>  <font color="#800080">\/</font>  <font color=Green>[]</font>
  <font color="#808080">,</font> <font color=Blue>--  bag laws</font>
    <font color=Green>[]</font>
  <font color="#808080">,</font> <font color=Blue>--  Lemma2 "backwards"</font>
    sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> <font color="#808080">\</font>s <font color="#808080">-&gt;</font> f s <font color="#800080">+++</font> g s<font color="#808080">)</font> <font color=Green>[]</font>
  <font color="#808080">]</font>

stepsCons <font color="#808080">::</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> <font color=Green>P</font> s a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>s <font color="#808080">-&gt;</font> <font color=Green>P</font> s a<font color="#808080">)</font> <font color="#808080">-&gt;</font> s <font color="#808080">-&gt;</font> <font color="#808080">[</font>s<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>ProofSteps</font> <font color="#808080">[</font><font color="#808080">(</font>a<font color="#808080">,</font> <font color="#808080">[</font>s<font color="#808080">]</font><font color="#808080">)</font><font color="#808080">]</font>
stepsCons f g s ss <font color="#808080">=</font> 
  <font color="#808080">[</font> sem <font color="#808080">(</font><font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#800080">+++</font> <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font>s<b><font color="#800080">:</font></b>ss<font color="#808080">)</font>         
  <font color="#808080">,</font> <font color=Blue>--  sem.+++</font>
    sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> f<font color="#808080">)</font> <font color="#808080">(</font>s<b><font color="#800080">:</font></b>ss<font color="#808080">)</font>  <font color="#800080">\/</font>  sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> g<font color="#808080">)</font> <font color="#808080">(</font>s<b><font color="#800080">:</font></b>ss<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Blue>--  Lemma1 twice</font>
    sem <font color="#808080">(</font>f s<font color="#808080">)</font> ss  <font color="#800080">\/</font>  sem <font color="#808080">(</font>g s<font color="#808080">)</font> ss                            
  <font color="#808080">,</font> <font color=Blue>--  Spec. of sem (p +++ q) "backwards" }</font>
    sem <font color="#808080">(</font>f s <font color="#800080">+++</font> g s<font color="#808080">)</font> ss                                   
  <font color="#808080">,</font> <font color=Blue>--  Eta expansion</font>
    sem <font color="#808080">(</font><font color="#808080">(</font><font color="#808080">\</font>s <font color="#808080">-&gt;</font> f s <font color="#800080">+++</font> g s<font color="#808080">)</font> s<font color="#808080">)</font> ss                                   
  <font color="#808080">,</font> <font color=Blue>--  Lemma 1 "backwards"</font>
    sem <font color="#808080">(</font>symbol <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font><font color="#808080">\</font>s <font color="#808080">-&gt;</font> f s <font color="#800080">+++</font> g s<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">(</font>s<b><font color="#800080">:</font></b>ss<font color="#808080">)</font>
  <font color="#808080">]</font>
</pre>
</body>
</html>