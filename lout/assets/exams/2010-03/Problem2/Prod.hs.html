<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem2/Prod.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem2</font><font color="#800080">.</font><font color=Green>Prod</font> <u><font color="#804000">where</font></u>

<u><font color="#804000">newtype</font></u> <font color=Green>Prod</font> m n a <font color="#808080">=</font> <font color=Green>Prod</font> <font color="#808080">{</font>unProd <font color="#808080">::</font> <font color="#808080">(</font>m a<font color="#808080">,</font> n a<font color="#808080">)</font><font color="#808080">}</font>

fstP <font color="#808080">::</font> <font color=Green>Prod</font> m n a <font color="#808080">-&gt;</font> m a
fstP <font color="#808080">=</font> fst <font color="#800080">.</font> unProd
sndP <font color="#808080">::</font> <font color=Green>Prod</font> m n a <font color="#808080">-&gt;</font> n a
sndP <font color="#808080">=</font> snd <font color="#800080">.</font> unProd

<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Monad</font> <font color="#808080">(</font><font color=Green>Prod</font> m n<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  return  <font color="#808080">=</font>  returnProd
  <font color="#808080">(</font><font color="#800080">&gt;&gt;=</font><font color="#808080">)</font>   <font color="#808080">=</font>  bindProd
  fail    <font color="#808080">=</font>  failProd

returnProd <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n a
returnProd   x  <font color="#808080">=</font>  <font color=Green>Prod</font> <font color="#808080">(</font>return x<font color="#808080">,</font> return x<font color="#808080">)</font>

bindProd <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font>
  <font color=Green>Prod</font> m n a <font color="#808080">-&gt;</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n b
bindProd mnx f  <font color="#808080">=</font>  <font color=Green>Prod</font> <font color="#808080">(</font> fstP mnx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>fstP <font color="#800080">.</font> f<font color="#808080">)</font>
                        <font color="#808080">,</font> sndP mnx <font color="#800080">&gt;&gt;=</font> <font color="#808080">(</font>sndP <font color="#800080">.</font> f<font color="#808080">)</font> <font color="#808080">)</font>
failProd <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monad</font> m<font color="#808080">,</font> <font color=Green>Monad</font> n<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>String</font> <font color="#808080">-&gt;</font> <font color=Green>Prod</font> m n a
failProd s <font color="#808080">=</font> <font color=Green>Prod</font> <font color="#808080">(</font>fail s<font color="#808080">,</font> fail s<font color="#808080">)</font>
</pre>
</body>
</html>