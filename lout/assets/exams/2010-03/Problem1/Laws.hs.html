<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem1/Laws.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Laws</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Problem1</font><font color="#800080">.</font><font color=Green>Deep</font> <u><font color="#804000">as</font></u> <font color=Green>D</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font> <u><font color="#804000">as</font></u> <font color=Green>P</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font> <font color="#808080">(</font><font color="#808080">(</font><font color="#800080">==</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color=Blue>-</font><font color="#808080">)</font><font color="#808080">,</font><font color="#808080">(</font><font color="#800080">$</font><font color="#808080">)</font><font color="#808080">,</font>id<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font> <u><font color="#804000">as</font></u> <font color=Green>Q</font>

prop_law1 xs  <font color="#808080">=</font> <font color=Green>D</font><font color="#800080">.</font>length <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font>fromList xs<font color="#808080">)</font> <font color="#800080">==</font> <font color=Green>P</font><font color="#800080">.</font>length xs
prop_law2 x   <font color="#808080">=</font> <font color=Green>D</font><font color="#800080">.</font>head <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font>fromList <font color="#808080">[</font>x<font color="#808080">]</font><font color="#808080">)</font> <font color="#800080">==</font> x
prop_law3 n   <font color="#808080">=</font> <font color=Green>Q</font><font color="#800080">.</font>forAll <font color="#808080">(</font><font color=Green>Q</font><font color="#800080">.</font>choose <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font>n<font color=Blue>-</font><font color=Magenta>1</font><font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">$</font> <font color="#808080">\</font>i <font color="#808080">-&gt;</font>
                <font color=Green>D</font><font color="#800080">.</font>index <font color="#808080">(</font><font color=Green>D</font><font color="#800080">.</font>fromFun n id<font color="#808080">)</font> i <font color="#800080">==</font> i
<font color=Blue>-- ...</font>

<font color=Blue>-- For most interesting laws an equality check is needed for vectors</font>
<font color=Blue>--  import Problem1.Deep_Instances</font>
prop_law4 v w <font color="#808080">=</font> <font color=Green>D</font><font color="#800080">.</font>length <font color="#808080">(</font>v  <font color=Green>D</font><font color="#800080">.++</font>  w<font color="#808080">)</font> <font color="#800080">==</font> <font color=Green>D</font><font color="#800080">.</font>length v   <font color="#800080">+</font>   <font color=Green>D</font><font color="#800080">.</font>length w
prop_law5 v <font color="#808080">=</font> <font color=Green>Q</font><font color="#800080">.</font>forAll <font color="#808080">(</font><font color=Green>Q</font><font color="#800080">.</font>choose <font color="#808080">(</font><font color=Magenta>0</font><font color="#808080">,</font>n<font color="#808080">)</font><font color="#808080">)</font> <font color="#800080">$</font> <font color="#808080">\</font>i <font color="#808080">-&gt;</font>
              <font color=Green>D</font><font color="#800080">.</font>take n v   <font color=Green>D</font><font color="#800080">.++</font>  <font color=Green>D</font><font color="#800080">.</font>drop n v   <font color="#800080">==</font>   v
  <u><font color="#804000">where</font></u> n <font color="#808080">=</font> <font color=Green>D</font><font color="#800080">.</font>length v
</pre>
</body>
</html>