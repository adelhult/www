<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-10mar/Problem3/GenericType.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem3</font><font color="#800080">.</font><font color=Green>GenericType</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <font color=Green>Problem2</font><font color="#800080">.</font><font color=Green>Prod</font> <font color="#808080">(</font><font color=Green>Prod</font><font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Problem3</font><font color="#800080">.</font><font color=Green>QuestionCode</font> <font color="#808080">(</font><font color=Green>Eval1</font><font color="#808080">,</font> <font color=Green>Eval2</font><font color="#808080">,</font> <font color=Green>Store</font><font color="#808080">,</font> test1<font color="#808080">)</font>

<font color=Blue>-- The call of check forces test to have type Test State</font>
<font color=Blue>--   because it must unify with (Test a) and with (m State)</font>

<font color=Blue>-- The more general type of test1</font>
<font color=Blue>-- 1. makes test1 reusable in different contexts</font>
<font color=Blue>-- 2. works as documentation of the features used (MonadError and MonadState)</font>

<font color=Blue>----------------</font>
<font color=Blue>-- Not part of the exam question - examples of reuse of test1</font>
test1_Eval1 <font color="#808080">=</font> test1 <font color="#808080">::</font> <font color=Green>Eval1</font> <font color=Green>Store</font>
test1_Eval2 <font color="#808080">=</font> test1 <font color="#808080">::</font> <font color=Green>Eval2</font> <font color=Green>Store</font>
test1_Prod  <font color="#808080">=</font> test1 <font color="#808080">::</font> <font color=Green>Prod</font> <font color=Green>Eval1</font> <font color=Green>Eval2</font> <font color=Green>Store</font>
</pre>
</body>
</html>