<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20120307/Types.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GADTs, TypeFamilies #-}</font>
<u><font color="#804000">module</font></u> <font color=Green>Types</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">data</font></u> <font color=Green>Zero</font>
<u><font color="#804000">data</font></u> <font color=Green>Suc</font> n

<u><font color="#804000">data</font></u> <font color=Green>Vec</font> a n <u><font color="#804000">where</font></u>
  <font color=Green>Nil</font>   <font color="#808080">::</font> <font color=Green>Vec</font> a <font color=Green>Zero</font>
  <font color=Green>Cons</font>  <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>Vec</font> a n <font color="#808080">-&gt;</font> <font color=Green>Vec</font> a <font color="#808080">(</font><font color=Green>Suc</font> n<font color="#808080">)</font>

<u><font color="#804000">type</font></u> family    <font color=Green>Add</font>  m        n  <font color="#808080">::</font> <font color="#800080">*</font>
<u><font color="#804000">type</font></u> <u><font color="#804000">instance</font></u>  <font color=Green>Add</font>  <font color=Green>Zero</font>     n  <font color="#808080">=</font>  n     
<u><font color="#804000">type</font></u> <u><font color="#804000">instance</font></u>  <font color=Green>Add</font>  <font color="#808080">(</font><font color=Green>Suc</font> m<font color="#808080">)</font>  n  <font color="#808080">=</font>  <font color=Green>Suc</font> <font color="#808080">(</font><font color=Green>Add</font> m n<font color="#808080">)</font>

<font color=Blue>{- Task (a): Give the signature and implementation of |(++)| for
vector concatenation and explain why it type checks.  -}</font>

<font color="#808080">(</font><font color="#800080">+++</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Vec</font> a m <font color="#808080">-&gt;</font> <font color=Green>Vec</font> a n <font color="#808080">-&gt;</font> <font color=Green>Vec</font> a <font color="#808080">(</font><font color=Green>Add</font> m n<font color="#808080">)</font>
<font color=Green>Nil</font>        <font color="#800080">+++</font>  ys  <font color="#808080">=</font>  ys
<font color=Green>Cons</font> x xs  <font color="#800080">+++</font>  ys  <font color="#808080">=</font>  <font color=Green>Cons</font> x <font color="#808080">(</font>xs <font color="#800080">+++</font> ys<font color="#808080">)</font>
<font color=Blue>-- Nil :: Vec a Zero</font>
<font color=Blue>-- return type = Vec a (Add Zero n) = Vec a n = the type of ys</font>
<font color=Blue>-- Cons x xs :: Vec a (Suc m)</font>
<font color=Blue>-- return type = Vec a (Add (Suc m) n) = Vec a (Suc (Add m n)) = type of the RHS</font>

<font color=Blue>{- Would it still type check with the alternative definition of
type-level addition below?  Why/why not?  
-}</font>

<u><font color="#804000">type</font></u> family    <font color=Green>Add'</font>  m  n        <font color="#808080">::</font> <font color="#800080">*</font>
<u><font color="#804000">type</font></u> <u><font color="#804000">instance</font></u>  <font color=Green>Add'</font>  m  <font color=Green>Zero</font>     <font color="#808080">=</font>  m     
<u><font color="#804000">type</font></u> <u><font color="#804000">instance</font></u>  <font color=Green>Add'</font>  m  <font color="#808080">(</font><font color=Green>Suc</font> n<font color="#808080">)</font>  <font color="#808080">=</font>  <font color=Green>Suc</font> <font color="#808080">(</font><font color=Green>Add'</font> m n<font color="#808080">)</font>

<font color=Blue>{- No, it would not type check. The case split in the function
definition must match the case split in the type family, otherwise the
type unification will fail. It is possible to work around it using a
family for type equality and a coerce function. -}</font>

<font color=Blue>-- Task (b): Implement a GADT |Fin n| for unary numbers below |n| and</font>
<font color=Blue>-- a lookup function |(!) :: Vec a n -&gt; Fin n -&gt; a|.</font>

<u><font color="#804000">data</font></u> <font color=Green>Fin</font> n <u><font color="#804000">where</font></u>
  <font color=Green>Fzero</font> <font color="#808080">::</font> <font color=Green>Fin</font> <font color="#808080">(</font><font color=Green>Suc</font> n<font color="#808080">)</font>
  <font color=Green>Fsuc</font>  <font color="#808080">::</font> <font color=Green>Fin</font> n <font color="#808080">-&gt;</font> <font color=Green>Fin</font> <font color="#808080">(</font><font color=Green>Suc</font> n<font color="#808080">)</font>
  
<font color="#808080">(</font><font color="#800080">!</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>Vec</font> a n <font color="#808080">-&gt;</font> <font color="#808080">(</font><font color=Green>Fin</font> n <font color="#808080">-&gt;</font> a<font color="#808080">)</font>
<font color=Green>Cons</font> x xs  <font color="#800080">!</font>  <font color=Green>Fzero</font>    <font color="#808080">=</font>  x
<font color=Green>Cons</font> x xs  <font color="#800080">!</font>  <font color="#808080">(</font><font color=Green>Fsuc</font> i<font color="#808080">)</font> <font color="#808080">=</font>  xs <font color="#800080">!</font> i

<font color=Blue>{- Task (c): Briefly explain the Curry-Howard correspondence for
``false'', ``true'', ``implies'', ``and'', ``or''.

----

  The Curry-Howard correspondence provides a "Logic" reading of types:
  
  Types             Logic
  p :: P            p is a proof of P

  empty type        False
  non-empty type    True
  P -&gt; Q            P implies Q
  (P, Q)            P and Q
  Either P Q        P or Q
  
-- Not asked for in the exam:
  (a :: A) -&gt; P     ∀a:A. P       -- dependent function type
  (a :: A, P)       ∃a:A. P       -- dependent pair type

-}</font>

<font color=Blue>-- ................</font>
<font color=Blue>-- Test code - not part of the exam</font>

v1 <font color="#808080">=</font> <font color=Green>Cons</font> <font color=Magenta>1</font> <font color="#808080">(</font><font color=Green>Cons</font> <font color=Magenta>7</font> <font color=Green>Nil</font><font color="#808080">)</font>
v2 <font color="#808080">=</font> <font color=Green>Cons</font> <font color=Magenta>3</font> <font color="#808080">(</font><font color=Green>Cons</font> <font color=Magenta>8</font> <font color=Green>Nil</font><font color="#808080">)</font>
long <font color="#808080">=</font> v1 <font color="#800080">+++</font> v2
two <font color="#808080">=</font> <font color=Green>Fsuc</font> <font color="#808080">(</font><font color=Green>Fsuc</font> <font color=Green>Fzero</font><font color="#808080">)</font>
  
main <font color="#808080">=</font> print <font color="#808080">(</font>long <font color="#800080">!</font> two <font color="#800080">==</font> <font color=Magenta>3</font><font color="#808080">)</font>
</pre>
</body>
</html>