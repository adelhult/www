<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-20110316/Problem1.hs</title>
</head>
<body>
<pre><u><font color="#804000">module</font></u> <font color=Green>Problem1</font> <u><font color="#804000">where</font></u>
<u><font color="#804000">import</font></u> <u><font color="#804000">qualified</font></u> <font color=Green>Prelude</font> <u><font color="#804000">as</font></u> <font color=Green>P</font>
<u><font color="#804000">import</font></u> <font color=Green>Prelude</font><font color="#808080">(</font><font color=Green>Functor</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">.</font><font color="#808080">)</font><font color="#808080">,</font> id<font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">++</font><font color="#808080">)</font><font color="#808080">,</font> <font color=Green>Eq</font><font color="#808080">,</font> <font color="#808080">(</font><font color="#800080">==</font><font color="#808080">)</font><font color="#808080">,</font> <font color=Green>Bool</font><font color="#808080">(</font><font color="#808080">..</font><font color="#808080">)</font><font color="#808080">,</font> 
               <font color=Green>Show</font><font color="#808080">,</font> showsPrec<font color="#808080">,</font> shows<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Data</font><font color="#800080">.</font><font color=Green>Monoid</font><font color="#808080">(</font><font color=Green>Monoid</font><font color="#808080">,</font> mempty<font color="#808080">,</font> mappend<font color="#808080">)</font>
<u><font color="#804000">import</font></u> <font color=Green>Test</font><font color="#800080">.</font><font color=Green>QuickCheck</font>

<font color=Blue>-- Problem 1a)</font>
<u><font color="#804000">newtype</font></u> <font color=Green>DList</font> a <font color="#808080">=</font> <font color=Green>DL</font> <font color="#808080">{</font> unDL <font color="#808080">::</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">}</font>

append <font color="#808080">::</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>DList</font> a
append <font color="#808080">(</font><font color=Green>DL</font> xs<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>DL</font> ys<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>DL</font> <font color="#808080">(</font>xs <font color="#800080">.</font> ys<font color="#808080">)</font>

cons <font color="#808080">::</font> a <font color="#808080">-&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>DList</font> a
cons x <font color="#808080">(</font><font color=Green>DL</font> xs<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>DL</font> <font color="#808080">(</font><font color="#808080">(</font>x<b><font color="#800080">:</font></b><font color="#808080">)</font> <font color="#800080">.</font> xs<font color="#808080">)</font>

empty <font color="#808080">::</font> <font color=Green>DList</font> a
empty <font color="#808080">=</font> <font color=Green>DL</font> id

foldr <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> b <font color="#808080">-&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> b
foldr f z xs <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font>foldr f z <font color="#808080">(</font>toList xs<font color="#808080">)</font>

fromList <font color="#808080">::</font> <font color="#808080">[</font>a<font color="#808080">]</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> a
fromList xs <font color="#808080">=</font> <font color=Green>DL</font> <font color="#808080">(</font>xs <font color="#800080">++</font><font color="#808080">)</font>

map <font color="#808080">::</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>DList</font> b
map f <font color="#808080">=</font> foldr <font color="#808080">(</font>cons <font color="#800080">.</font> f<font color="#808080">)</font> empty

toList <font color="#808080">::</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color="#808080">[</font>a<font color="#808080">]</font>
toList <font color="#808080">(</font><font color=Green>DL</font> xs<font color="#808080">)</font> <font color="#808080">=</font> xs <font color=Green>[]</font>
<font color=Blue>-- Alternatively: toList xs = unDL xs []</font>

<u><font color="#804000">instance</font></u> <font color=Green>Functor</font> <font color=Green>DList</font> <u><font color="#804000">where</font></u>
  fmap <font color="#808080">=</font> map

<u><font color="#804000">instance</font></u> <font color=Green>Monoid</font> <font color="#808080">(</font><font color=Green>DList</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  mempty <font color="#808080">=</font> empty
  mappend <font color="#808080">=</font> append

<u><font color="#804000">instance</font></u> <font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color=Green>Eq</font> <font color="#808080">(</font><font color=Green>DList</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  xs <font color="#800080">==</font> ys   <font color="#808080">=</font>   toList xs <font color="#800080">==</font> toList ys

<font color=Blue>----------------</font>
<font color=Blue>-- Problem 1b)</font>

<font color=Blue>{-
Functor laws:
       fmap id == id
  fmap (f . g) == fmap f . fmap g

Monoid laws:  
  mappend mempty m == m
  mappend m mempty == m
  mappend (mappend m_1 m_2) m_3 == mappend m_1 (mappend m_2 m_3)

-}</font>

<font color=Blue>-- Polymorphic properties:</font>
prop_fmap_id <font color="#808080">::</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Eq</font> a <font color="#808080">=&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_fmap_id xs  <font color="#808080">=</font>  map id xs <font color="#800080">==</font> id xs

prop_fmap_comp <font color="#808080">::</font> <font color=Green>Eq</font> c <font color="#808080">=&gt;</font> <font color="#808080">(</font>b<font color="#808080">-&gt;</font>c<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_fmap_comp f g <font color="#808080">=</font>  map <font color="#808080">(</font>f <font color="#800080">.</font> g<font color="#808080">)</font> <font color="#800080">===</font> map f <font color="#800080">.</font> map g

<u><font color="#804000">infix</font></u> <font color=Magenta>4</font> <font color="#800080">===</font>
<font color="#808080">(</font><font color="#800080">===</font><font color="#808080">)</font> <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Eq</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color="#808080">(</font>t <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color="#808080">(</font>t <font color="#808080">-&gt;</font> a<font color="#808080">)</font> <font color="#808080">-&gt;</font> t <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
f <font color="#800080">===</font> g <font color="#808080">=</font> <font color="#808080">\</font>x <font color="#808080">-&gt;</font> f x <font color="#800080">==</font> g x

prop_monoid_1 <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monoid</font> a<font color="#808080">,</font> <font color=Green>Eq</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_monoid_1 m <font color="#808080">=</font>  mappend mempty m <font color="#800080">==</font> m

prop_monoid_2 <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monoid</font> a<font color="#808080">,</font> <font color=Green>Eq</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_monoid_2 m <font color="#808080">=</font>  mappend m mempty <font color="#800080">==</font> m

prop_monoid_3 <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>Monoid</font> a<font color="#808080">,</font> <font color=Green>Eq</font> a<font color="#808080">)</font> <font color="#808080">=&gt;</font> a <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> a <font color="#808080">-&gt;</font> <font color=Green>Bool</font>
prop_monoid_3 m1 m2 m3 <font color="#808080">=</font>  mappend <font color="#808080">(</font>mappend m1 m2<font color="#808080">)</font> m3 <font color="#800080">==</font> mappend m1 <font color="#808080">(</font>mappend m2 m3<font color="#808080">)</font>

<font color=Blue>-- Monomorphic versions for quickCheck</font>
<u><font color="#804000">type</font></u> <font color=Green>B</font> <font color="#808080">=</font> <font color=Green>Bool</font> <font color=Blue>-- could be some other non-trivial type (not ())</font>

test_id   <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_fmap_id   <font color="#808080">::</font> <font color=Green>DList</font> <font color=Green>Bool</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
test_comp <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_fmap_comp <font color="#808080">::</font> <font color="#808080">(</font><font color=Green>B</font><font color="#808080">-&gt;</font><font color=Green>B</font><font color="#808080">)</font><font color="#808080">-&gt;</font><font color="#808080">(</font><font color=Green>B</font><font color="#808080">-&gt;</font><font color=Green>B</font><font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
test_mon1 <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_monoid_1  <font color="#808080">::</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
test_mon2 <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_monoid_2  <font color="#808080">::</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>
test_mon3 <font color="#808080">=</font> quickCheck <font color="#808080">(</font>prop_monoid_3  <font color="#808080">::</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>DList</font> <font color=Green>B</font> <font color="#808080">-&gt;</font> <font color=Green>Bool</font><font color="#808080">)</font>


<u><font color="#804000">instance</font></u> <font color=Green>Show</font> a <font color="#808080">=&gt;</font> <font color=Green>Show</font> <font color="#808080">(</font><font color=Green>DList</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u> <font color=Blue>-- not required on the exam</font>
  showsPrec p xs <font color="#808080">=</font> showsPrec p <font color="#808080">(</font>toList xs<font color="#808080">)</font>
    
<u><font color="#804000">instance</font></u> <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font><font color=Green>Bounded</font> a<font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font><font color=Green>Enum</font> a<font color="#808080">,</font> <font color=Green>Show</font> a<font color="#808080">,</font> <font color=Green>Show</font> b<font color="#808080">)</font> <font color="#808080">=&gt;</font> <font color=Green>Show</font> <font color="#808080">(</font>a<font color="#808080">-&gt;</font>b<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  showsPrec p f <font color="#808080">=</font> showsPrec p <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>map <font color="#808080">(</font><font color="#808080">\</font>x<font color="#808080">-&gt;</font> <font color="#808080">(</font>x<font color="#808080">,</font>f x<font color="#808080">)</font><font color="#808080">)</font> <font color="#808080">[</font><font color=Green>P</font><font color="#800080">.</font>minBound <font color="#808080">..</font> <font color=Green>P</font><font color="#800080">.</font>maxBound<font color="#808080">]</font><font color="#808080">)</font>

<u><font color="#804000">instance</font></u> <font color=Green>Arbitrary</font> a <font color="#808080">=&gt;</font> <font color=Green>Arbitrary</font> <font color="#808080">(</font><font color=Green>DList</font> a<font color="#808080">)</font> <u><font color="#804000">where</font></u>
  arbitrary <font color="#808080">=</font> <font color=Green>P</font><font color="#800080">.</font>fmap fromList arbitrary

main <font color="#808080">=</font> <u><font color="#804000">do</font></u> 
  test_id   
  test_comp 
  test_mon1 
  test_mon2
  test_mon3 

<font color=Blue>----------------------------------------------------------------</font>
<font color=Blue>-- Problem 1 extras: attempting to "prove" some properties by equality</font>
<font color=Blue>-- reasoning. Not part of the exam question and unfinished.</font>

functor_law_1 <font color="#808080">=</font>        
  <font color="#808080">[</font> map id
  <font color="#808080">,</font> foldr <font color="#808080">(</font>cons <font color="#800080">.</font> id<font color="#808080">)</font> empty
  <font color="#808080">,</font> foldr cons empty
  <font color="#808080">,</font> <font color=Blue>-- foldr_cons_empty_lemma</font>
    id
  <font color="#808080">]</font>

<font color=Blue>-- foldr cons empty xs == xs</font>
foldr_cons_empty_lemma_e <font color="#808080">=</font>
  <font color="#808080">[</font> foldr cons empty empty
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>toList empty<font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>toList <font color="#808080">(</font><font color=Green>DL</font> id<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>id <font color=Green>[]</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color=Green>[]</font>
  <font color="#808080">,</font> empty
  <font color="#808080">]</font>
foldr_cons_empty_lemma_c x xs <font color="#808080">=</font>
  <font color="#808080">[</font> foldr cons empty <font color="#808080">(</font>cons x xs<font color="#808080">)</font>
  <font color="#808080">,</font> foldr cons empty <font color="#808080">(</font><font color=Green>DL</font> <font color="#808080">(</font><font color="#808080">(</font>x<b><font color="#800080">:</font></b><font color="#808080">)</font> <font color="#800080">.</font> unDL xs<font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>toList <font color="#808080">(</font><font color=Green>DL</font> <font color="#808080">(</font><font color="#808080">(</font>x<b><font color="#800080">:</font></b><font color="#808080">)</font> <font color="#800080">.</font> unDL xs<font color="#808080">)</font><font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font><font color="#808080">(</font><font color="#808080">(</font>x<b><font color="#800080">:</font></b><font color="#808080">)</font> <font color="#800080">.</font> unDL xs<font color="#808080">)</font> <font color=Green>[]</font><font color="#808080">)</font>
  <font color="#808080">,</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>x <b><font color="#800080">:</font></b> unDL xs <font color=Green>[]</font><font color="#808080">)</font>
  <font color="#808080">,</font> cons x <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>unDL xs <font color=Green>[]</font><font color="#808080">)</font><font color="#808080">)</font>
  <font color="#808080">,</font> cons x <font color="#808080">(</font><font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>toList xs<font color="#808080">)</font><font color="#808080">)</font>
  <font color=Blue>-- lemma P.foldr cons empty (toList xs)</font>
  <font color="#808080">]</font>

<font color=Blue>-- P.foldr cons empty (toList xs) == xs</font>
lemma2 xs <font color="#808080">=</font> 
  <font color="#808080">[</font> <font color=Green>P</font><font color="#800080">.</font>foldr cons empty <font color="#808080">(</font>toList xs<font color="#808080">)</font>
  <font color="#808080">,</font> xs
  <font color="#808080">]</font>  

</pre>
</body>
</html>