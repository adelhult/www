<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-09mar/Problem4.hs</title>
</head>
<body>
<pre><font color=Blue>{-# LANGUAGE GADTs #-}</font>

<u><font color="#804000">module</font></u> <font color=Green>Problem4</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- a)</font>

<u><font color="#804000">data</font></u> <font color=Green>Expr</font> t <u><font color="#804000">where</font></u>
  <font color=Green>Lit</font>  <font color="#808080">::</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Expr</font> <font color=Green>Int</font>
  <font color=Green>Plus</font> <font color="#808080">::</font> <font color=Green>Expr</font> <font color="#808080">(</font><font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font> <font color="#808080">-&gt;</font> <font color=Green>Int</font><font color="#808080">)</font>
  <font color=Green>App</font>  <font color="#808080">::</font> <font color=Green>Expr</font> <font color="#808080">(</font>a <font color="#808080">-&gt;</font> b<font color="#808080">)</font> <font color="#808080">-&gt;</font> <font color=Green>Expr</font> a <font color="#808080">-&gt;</font> <font color=Green>Expr</font> b

<font color=Blue>-- b)</font>

eval <font color="#808080">::</font> <font color=Green>Expr</font> t <font color="#808080">-&gt;</font> t
eval <font color="#808080">(</font><font color=Green>Lit</font> n<font color="#808080">)</font>     <font color="#808080">=</font> n
eval <font color=Green>Plus</font>        <font color="#808080">=</font> <font color="#808080">(</font><font color="#800080">+</font><font color="#808080">)</font>
eval <font color="#808080">(</font><font color=Green>App</font> e1 e2<font color="#808080">)</font> <font color="#808080">=</font> <font color="#808080">(</font>eval e1<font color="#808080">)</font> <font color="#808080">(</font>eval e2<font color="#808080">)</font>

</pre>
</body>
</html>