<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>exam-09mar/Problem1.hs</title>
</head>
<body>
<pre>
<u><font color="#804000">module</font></u> <font color=Green>Problem1</font> <u><font color="#804000">where</font></u>

<font color=Blue>-- a)</font>

turn180  <font color="#808080">=</font> left <font color="#800080">&gt;&gt;&gt;</font> left
right    <font color="#808080">=</font> left <font color="#800080">&gt;&gt;&gt;</font> turn180
backward <font color="#808080">=</font> turn180 <font color="#800080">&gt;&gt;&gt;</font> forward <font color="#800080">&gt;&gt;&gt;</font> turn180

<font color=Blue>-- b)</font>

<font color=Green>Forward</font> s        <font color="#800080">&gt;&gt;&gt;</font> t <font color="#808080">=</font> <font color=Green>Forward</font> <font color="#808080">(</font>s <font color="#800080">&gt;&gt;&gt;</font> t<font color="#808080">)</font>
<font color=Green>TurnLeft</font> s       <font color="#800080">&gt;&gt;&gt;</font> t <font color="#808080">=</font> <font color=Green>TurnLeft</font> <font color="#808080">(</font>s <font color="#800080">&gt;&gt;&gt;</font> t<font color="#808080">)</font>
<font color=Green>IfObstructed</font> s t <font color="#800080">&gt;&gt;&gt;</font> u <font color="#808080">=</font> <font color=Green>IfObstructed</font> <font color="#808080">(</font>s <font color="#800080">&gt;&gt;&gt;</font> u<font color="#808080">)</font> <font color="#808080">(</font>t <font color="#800080">&gt;&gt;&gt;</font> u<font color="#808080">)</font>
<font color=Green>Idle</font>             <font color="#800080">&gt;&gt;&gt;</font> s <font color="#808080">=</font> s

<font color=Blue>-- c)</font>

<u><font color="#804000">newtype</font></u> <font color=Green>S</font> <font color="#808080">=</font> <font color=Green>S</font> <font color="#808080">{</font> unS <font color="#808080">::</font> <font color=Green>Maze</font> <font color="#808080">-&gt;</font> <font color=Green>Ant</font> <font color="#808080">-&gt;</font> <font color=Green>Ant</font> <font color="#808080">}</font>

forward <font color="#808080">::</font> <font color=Green>S</font>
forward <font color="#808080">=</font> <font color=Green>S</font> <font color="#800080">$</font> <font color="#808080">\</font>maze ant <font color="#808080">-&gt;</font>
  <u><font color="#804000">if</font></u>   obstructed maze ant
  <u><font color="#804000">then</font></u> ant
  <u><font color="#804000">else</font></u> moveAnt ant

ifObstructed <font color="#808080">::</font> <font color=Green>S</font> <font color="#808080">-&gt;</font> <font color=Green>S</font> <font color="#808080">-&gt;</font> <font color=Green>S</font>
ifObstructed <font color="#808080">(</font><font color=Green>S</font> s<font color="#808080">)</font> <font color="#808080">(</font><font color=Green>S</font> t<font color="#808080">)</font> <font color="#808080">=</font> <font color=Green>S</font> <font color="#800080">$</font> <font color="#808080">\</font>maze ant <font color="#808080">-&gt;</font>
  <u><font color="#804000">if</font></u>   obstructed maze ant
  <u><font color="#804000">then</font></u> s maze ant
  <u><font color="#804000">else</font></u> t maze ant

idle <font color="#808080">::</font> <font color=Green>S</font>
idle <font color="#808080">=</font> <font color=Green>S</font> <font color="#800080">$</font> <font color="#808080">\</font>maze ant <font color="#808080">-&gt;</font> ant

left <font color="#808080">::</font> <font color=Green>S</font>
left <font color="#808080">=</font> <font color=Green>S</font> <font color="#800080">$</font> <font color="#808080">\</font>maze ant <font color="#808080">-&gt;</font> leftAnt ant

<font color="#808080">(</font><font color="#800080">&gt;&gt;&gt;</font><font color="#808080">)</font> <font color="#808080">::</font> <font color=Green>S</font> <font color="#808080">-&gt;</font> <font color=Green>S</font> <font color="#808080">-&gt;</font> <font color=Green>S</font>
<font color=Green>S</font> s <font color="#800080">&gt;&gt;&gt;</font> <font color=Green>S</font> t <font color="#808080">=</font> <font color=Green>S</font> <font color="#800080">$</font> <font color="#808080">\</font>maze ant <font color="#808080">-&gt;</font> t maze <font color="#808080">(</font>s maze ant<font color="#808080">)</font>

navigate <font color="#808080">::</font> <font color=Green>Maze</font> <font color="#808080">-&gt;</font> <font color=Green>Ant</font> <font color="#808080">-&gt;</font> <font color=Green>S</font> <font color="#808080">-&gt;</font> <font color=Green>Ant</font>
navigate maze ant <font color="#808080">(</font><font color=Green>S</font> s<font color="#808080">)</font> <font color="#808080">=</font> s maze ant

</pre>
</body>
</html>